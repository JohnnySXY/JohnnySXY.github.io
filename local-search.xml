<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>SkyWalkingæç®€å…¥é—¨</title>
    <link href="/2023/04/24/SkyWalking%E6%9E%81%E7%AE%80%E5%85%A5%E9%97%A8/"/>
    <url>/2023/04/24/SkyWalking%E6%9E%81%E7%AE%80%E5%85%A5%E9%97%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="SkyWalking-æç®€å…¥é—¨"><a href="#SkyWalking-æç®€å…¥é—¨" class="headerlink" title="SkyWalking æç®€å…¥é—¨"></a>SkyWalking æç®€å…¥é—¨</h1><p>ä» 0 å¼€å§‹å…¥é—¨ SkyWalkingï¼Œæ­å»º SkyWalking æœåŠ¡ï¼Œå¹¶æ¥å…¥ Java é¡¹ç›®ä¸­å®ç°åˆ†å¸ƒå¼é“¾è·¯è¿½è¸ªã€‚</p><p>Tags | <a href="https://skywalking.apache.org/zh_tags/user-manual">User Manual</a></p><p>ç›®å½•ï¼š</p><ul><li><a href="https://skywalking.apache.org/zh/2020-04-19-skywalking-quick-start/#">1. æ¦‚è¿°</a></li><li><a href="https://skywalking.apache.org/zh/2020-04-19-skywalking-quick-start/#">2. æ­å»º SkyWalking å•æœºç¯å¢ƒ</a></li><li><a href="https://skywalking.apache.org/zh/2020-04-19-skywalking-quick-start/#">3. æ­å»º SkyWalking é›†ç¾¤ç¯å¢ƒ</a></li><li><a href="https://skywalking.apache.org/zh/2020-04-19-skywalking-quick-start/#">4. å‘Šè­¦</a></li><li><a href="https://skywalking.apache.org/zh/2020-04-19-skywalking-quick-start/#">5. æ³¨æ„äº‹é¡¹</a></li><li><a href="https://skywalking.apache.org/zh/2020-04-19-skywalking-quick-start/#">6. Spring Boot ä½¿ç”¨ç¤ºä¾‹</a></li><li><a href="https://skywalking.apache.org/zh/2020-04-19-skywalking-quick-start/#">6. Spring Cloud ä½¿ç”¨ç¤ºä¾‹</a></li></ul><blockquote><ul><li>ä½œè€…ï¼š<a href="https://github.com/YunaiV">èŠ‹é“æºç </a></li><li><a href="http://www.iocoder.cn/SkyWalking/install/?skywalkinng">åŸæ–‡åœ°å€</a></li></ul></blockquote><h1 id="1-æ¦‚è¿°"><a href="#1-æ¦‚è¿°" class="headerlink" title="1. æ¦‚è¿°"></a>1. æ¦‚è¿°</h1><h2 id="1-1-æ¦‚å¿µ"><a href="#1-1-æ¦‚å¿µ" class="headerlink" title="1.1 æ¦‚å¿µ"></a>1.1 æ¦‚å¿µ</h2><p>SkyWalking æ˜¯ä»€ä¹ˆï¼Ÿ</p><blockquote><p>FROM <a href="http://skywalking.apache.org/">http://skywalking.apache.org/</a></p><p>åˆ†å¸ƒå¼ç³»ç»Ÿçš„åº”ç”¨ç¨‹åºæ€§èƒ½ç›‘è§†å·¥å…·ï¼Œä¸“ä¸ºå¾®æœåŠ¡ã€äº‘åŸç”Ÿæ¶æ„å’ŒåŸºäºå®¹å™¨ï¼ˆDockerã€K8sã€Mesosï¼‰æ¶æ„è€Œè®¾è®¡ã€‚</p><p>æä¾›åˆ†å¸ƒå¼è¿½è¸ªã€æœåŠ¡ç½‘æ ¼é¥æµ‹åˆ†æã€åº¦é‡èšåˆå’Œå¯è§†åŒ–ä¸€ä½“åŒ–è§£å†³æ–¹æ¡ˆã€‚</p></blockquote><h2 id="1-2-åŠŸèƒ½åˆ—è¡¨"><a href="#1-2-åŠŸèƒ½åˆ—è¡¨" class="headerlink" title="1.2 åŠŸèƒ½åˆ—è¡¨"></a>1.2 åŠŸèƒ½åˆ—è¡¨</h2><p>SkyWalking æœ‰å“ªäº›åŠŸèƒ½ï¼Ÿ</p><blockquote><p>FROM <a href="http://skywalking.apache.org/">http://skywalking.apache.org/</a></p><ul><li>å¤šç§ç›‘æ§æ‰‹æ®µã€‚å¯ä»¥é€šè¿‡è¯­è¨€æ¢é’ˆå’Œ service mesh è·å¾—ç›‘æ§æ˜¯æ•°æ®ã€‚</li><li>å¤šä¸ªè¯­è¨€è‡ªåŠ¨æ¢é’ˆã€‚åŒ…æ‹¬ Javaï¼Œ.NET Core å’Œ Node.JSã€‚</li><li>è½»é‡é«˜æ•ˆã€‚æ— éœ€å¤§æ•°æ®å¹³å°ï¼Œå’Œå¤§é‡çš„æœåŠ¡å™¨èµ„æºã€‚</li><li>æ¨¡å—åŒ–ã€‚UIã€å­˜å‚¨ã€é›†ç¾¤ç®¡ç†éƒ½æœ‰å¤šç§æœºåˆ¶å¯é€‰ã€‚</li><li>æ”¯æŒå‘Šè­¦ã€‚</li><li>ä¼˜ç§€çš„å¯è§†åŒ–è§£å†³æ–¹æ¡ˆã€‚</li></ul></blockquote><h2 id="1-3-æ•´ä½“æ¶æ„"><a href="#1-3-æ•´ä½“æ¶æ„" class="headerlink" title="1.3 æ•´ä½“æ¶æ„"></a>1.3 æ•´ä½“æ¶æ„</h2><p>SkyWalking æ•´ä½“æ¶æ„å¦‚ä½•ï¼Ÿ</p><blockquote><p>FROM <a href="http://skywalking.apache.org/">http://skywalking.apache.org/</a></p><p><img src="https://skywalking.apache.org/zh/2020-04-19-skywalking-quick-start/0081Kckwly1gkl533fk5xj31pc0s8h04.jpg" alt="æ¶æ„å›¾"></p></blockquote><p>æ•´ä¸ªæ¶æ„ï¼Œåˆ†æˆä¸Šã€ä¸‹ã€å·¦ã€å³å››éƒ¨åˆ†ï¼š</p><blockquote><p>è€ƒè™‘åˆ°è®©æè¿°æ›´ç®€å•ï¼Œæˆ‘ä»¬èˆå¼ƒæ‰ Metric æŒ‡æ ‡ç›¸å…³ï¼Œè€Œç€é‡åœ¨ Tracing é“¾è·¯ç›¸å…³åŠŸèƒ½ã€‚</p></blockquote><ul><li>ä¸Šéƒ¨åˆ† <strong>Agent</strong> ï¼šè´Ÿè´£ä»åº”ç”¨ä¸­ï¼Œæ”¶é›†é“¾è·¯ä¿¡æ¯ï¼Œå‘é€ç»™ SkyWalking OAP æœåŠ¡å™¨ã€‚ç›®å‰æ”¯æŒ SkyWalkingã€Zikpinã€Jaeger ç­‰æä¾›çš„ Tracing æ•°æ®ä¿¡æ¯ã€‚è€Œæˆ‘ä»¬ç›®å‰é‡‡ç”¨çš„æ˜¯ï¼ŒSkyWalking Agent æ”¶é›† SkyWalking Tracing æ•°æ®ï¼Œä¼ é€’ç»™æœåŠ¡å™¨ã€‚</li><li>ä¸‹éƒ¨åˆ† <strong>SkyWalking OAP</strong> ï¼šè´Ÿè´£æ¥æ”¶ Agent å‘é€çš„ Tracing æ•°æ®ä¿¡æ¯ï¼Œç„¶åè¿›è¡Œåˆ†æ(Analysis Core) ï¼Œå­˜å‚¨åˆ°å¤–éƒ¨å­˜å‚¨å™¨( Storage )ï¼Œæœ€ç»ˆæä¾›æŸ¥è¯¢( Query )åŠŸèƒ½ã€‚</li><li>å³éƒ¨åˆ† <strong>Storage</strong> ï¼šTracing æ•°æ®å­˜å‚¨ã€‚ç›®å‰æ”¯æŒ ESã€MySQLã€Sharding Sphereã€TiDBã€H2 å¤šç§å­˜å‚¨å™¨ã€‚è€Œæˆ‘ä»¬ç›®å‰é‡‡ç”¨çš„æ˜¯ ES ï¼Œä¸»è¦è€ƒè™‘æ˜¯ SkyWalking å¼€å‘å›¢é˜Ÿè‡ªå·±çš„ç”Ÿäº§ç¯å¢ƒé‡‡ç”¨ ES ä¸ºä¸»ã€‚</li><li>å·¦éƒ¨åˆ† <strong>SkyWalking UI</strong> ï¼šè´Ÿè´£æä¾›æ§å°ï¼ŒæŸ¥çœ‹é“¾è·¯ç­‰ç­‰ã€‚</li></ul><h2 id="1-4-å®˜æ–¹æ–‡æ¡£"><a href="#1-4-å®˜æ–¹æ–‡æ¡£" class="headerlink" title="1.4 å®˜æ–¹æ–‡æ¡£"></a>1.4 å®˜æ–¹æ–‡æ¡£</h2><p>åœ¨ <a href="https://github.com/apache/skywalking/tree/master/docs">https://github.com/apache/skywalking/tree/master/docs</a> åœ°å€ä¸‹ï¼Œæä¾›äº† SkyWalking çš„<strong>è‹±æ–‡</strong>æ–‡æ¡£ã€‚</p><p>è€ƒè™‘åˆ°å¤§å¤šæ•°èƒ–å‹çš„è‹±è¯­æ°´å¹³å’Œè‰¿è‰¿ä¸ç›¸ä¼¯ä»²ï¼Œå†åŠ ä¸Šèƒ–å‹ä¸€å¼€å§‹å¯¹ SkyWalking æ¯”è¾ƒé™Œç”Ÿï¼Œæ‰€ä»¥æ¯”è¾ƒæ¨èå…ˆé˜…è¯» <a href="https://github.com/SkyAPM/document-cn-translation-of-skywalking">https://github.com/SkyAPM/document-cn-translation-of-skywalking</a> åœ°å€ï¼Œæä¾›äº† SkyWalking çš„<strong>ä¸­æ–‡</strong>æ–‡æ¡£ã€‚</p><p>è€ƒè™‘åˆ°èƒ–å‹ä½¿ç”¨ SkyWalking çš„ç›®çš„ï¼Œæ˜¯å®ç°<strong>åˆ†å¸ƒå¼é“¾è·¯è¿½è¸ª</strong>çš„åŠŸèƒ½ï¼Œæ‰€ä»¥æœ€å¥½å»äº†è§£ä¸‹ç›¸å…³çš„çŸ¥è¯†ã€‚è¿™é‡Œæ¨èé˜…è¯»ä¸¤ç¯‡æ–‡ç« ï¼š</p><ul><li><a href="https://github.com/opentracing-contrib/opentracing-specification-zh">ã€ŠOpenTracing å®˜æ–¹æ ‡å‡† â€”â€” ä¸­æ–‡ç‰ˆã€‹</a></li><li>Google è®ºæ–‡ <a href="http://www.iocoder.cn/Fight/Dapper-translation/?self">ã€ŠDapperï¼Œå¤§è§„æ¨¡åˆ†å¸ƒå¼ç³»ç»Ÿçš„è·Ÿè¸ªç³»ç»Ÿã€‹</a></li></ul><h1 id="2-æ­å»º-SkyWalking-å•æœºç¯å¢ƒ"><a href="#2-æ­å»º-SkyWalking-å•æœºç¯å¢ƒ" class="headerlink" title="2. æ­å»º SkyWalking å•æœºç¯å¢ƒ"></a>2. æ­å»º SkyWalking å•æœºç¯å¢ƒ</h1><p>è€ƒè™‘åˆ°è®©èƒ–å‹æ›´å¿«çš„å…¥é—¨ï¼Œæˆ‘ä»¬æ¥æ­å»ºä¸€ä¸ª SkyWalking <strong>å•æœº</strong>ç¯å¢ƒï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š</p><p><img src="https://skywalking.apache.org/zh/2020-04-19-skywalking-quick-start/0081Kckwly1gkl533oq0xj30ww0pomzt.jpg" alt="SkyWalking å•æœºç¯å¢ƒ"></p><ul><li>ç¬¬ä¸€æ­¥ï¼Œæ­å»ºä¸€ä¸ª Elasticsearch æœåŠ¡ã€‚</li><li>ç¬¬äºŒæ­¥ï¼Œä¸‹è½½ SkyWalking è½¯ä»¶åŒ…ã€‚</li><li>ç¬¬ä¸‰æ­¥ï¼Œæ­å»ºä¸€ä¸ª SkyWalking OAP æœåŠ¡ã€‚</li><li>ç¬¬å››æ­¥ï¼Œå¯åŠ¨ä¸€ä¸ª Spring Boot åº”ç”¨ï¼Œå¹¶é…ç½® SkyWalking Agentã€‚</li><li>ç¬¬äº”æ­¥ï¼Œæ­å»ºä¸€ä¸ª SkyWalking UI æœåŠ¡ã€‚</li></ul><p>ä»…ä»…äº”æ­¥ï¼ŒæŒ‰ç…§è‰¿è‰¿æ ‡é¢˜å…šçš„æ€§æ ¼ï¼Œåº”è¯¥ç»™æœ¬æ–‡å–ä¸ªã€Š10 åˆ†é’Ÿå¿«é€Ÿæ­å»º SkyWalking æœåŠ¡ã€‹æ ‡é¢˜æ‰å¯¹ï¼Œå“ˆå“ˆå“ˆã€‚</p><h2 id="2-1-Elasticsearch-æ­å»º"><a href="#2-1-Elasticsearch-æ­å»º" class="headerlink" title="2.1 Elasticsearch æ­å»º"></a>2.1 Elasticsearch æ­å»º</h2><blockquote><p>FROM <a href="https://www.elastic.co/cn/products/elasticsearch">https://www.elastic.co/cn/products/elasticsearch</a></p><p>Elasticsearch æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼ã€RESTful é£æ ¼çš„æœç´¢å’Œæ•°æ®åˆ†æå¼•æ“ï¼Œèƒ½å¤Ÿè§£å†³ä¸æ–­æ¶Œç°å‡ºçš„å„ç§ç”¨ä¾‹ã€‚ ä½œä¸º Elastic Stack çš„æ ¸å¿ƒï¼Œå®ƒé›†ä¸­å­˜å‚¨æ‚¨çš„æ•°æ®ï¼Œå¸®åŠ©æ‚¨å‘ç°æ„æ–™ä¹‹ä¸­ä»¥åŠæ„æ–™ä¹‹å¤–çš„æƒ…å†µã€‚</p></blockquote><p>å‚è€ƒ<a href="http://www.iocoder.cn/Elasticsearch/install/?self">ã€ŠElasticsearch æç®€å…¥é—¨ã€‹</a>çš„<a href="https://skywalking.apache.org/zh/2020-04-19-skywalking-quick-start/#">ã€Œ1. å•æœºéƒ¨ç½²ã€</a>å°èŠ‚ï¼Œæ­å»ºä¸€ä¸ª Elasticsearch å•æœºæœåŠ¡ã€‚</p><p>ä¸è¿‡è¦<strong>æ³¨æ„</strong>ï¼Œæœ¬æ–‡ä½¿ç”¨çš„æ˜¯ Elasticsearch <code>7.5.1</code> ç‰ˆæœ¬ã€‚å› ä¸º SkyWalking <a href="https://github.com/apache/skywalking/releases/tag/v6.6.0"><code>6.6.0</code></a> ç‰ˆæœ¬ï¼Œå¢åŠ äº†å¯¹ Elasticsearch 7.X ç‰ˆæœ¬çš„æ”¯æŒã€‚å½“ç„¶ï¼Œå¦‚æœèƒ–å‹ä½¿ç”¨ Elasticsearch 6.X ç‰ˆæœ¬ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚</p><h2 id="2-2-ä¸‹è½½-SkyWalking-è½¯ä»¶åŒ…"><a href="#2-2-ä¸‹è½½-SkyWalking-è½¯ä»¶åŒ…" class="headerlink" title="2.2 ä¸‹è½½ SkyWalking è½¯ä»¶åŒ…"></a>2.2 ä¸‹è½½ SkyWalking è½¯ä»¶åŒ…</h2><p>å¯¹äº SkyWalking çš„è½¯ä»¶åŒ…ï¼Œæœ‰ä¸¤ç§æ–¹å¼è·å–ï¼š</p><ul><li>æ‰‹åŠ¨ç¼–è¯‘</li><li>å®˜æ–¹åŒ…</li></ul><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å»ºè®®ä½¿ç”¨<strong>å®˜æ–¹åŒ…</strong>ã€‚æ‰‹åŠ¨ç¼–è¯‘ï¼Œæ›´å¤šæ˜¯å°é²œæˆ–è€…ç­‰ç€æ€¥ä¿®å¤çš„ BUG çš„ç‰ˆæœ¬ã€‚</p><h3 id="2-2-1-å®˜æ–¹åŒ…"><a href="#2-2-1-å®˜æ–¹åŒ…" class="headerlink" title="2.2.1 å®˜æ–¹åŒ…"></a>2.2.1 å®˜æ–¹åŒ…</h3><p>åœ¨ <a href="http://skywalking.apache.org/downloads/">http://skywalking.apache.org/downloads/</a> ä¸‹ï¼Œæˆ‘ä»¬ä¸‹è½½<strong>æ“ä½œç³»ç»Ÿ</strong>å¯¹åº”çš„å‘å¸ƒç‰ˆã€‚</p><p>è¿™é‡Œï¼Œæˆ‘ä»¬é€‰æ‹© <a href="https://www.apache.org/dyn/closer.cgi/skywalking/6.6.0/apache-skywalking-apm-es7-6.6.0.tar.gz">Binary Distribution for ElasticSearch 7 (Linux)</a> ç‰ˆæœ¬ï¼Œå› ä¸ºè‰¿è‰¿æ˜¯ Mac ç¯å¢ƒï¼Œå†åŠ ä¸Šæƒ³ä½¿ç”¨ Elasticsearch 7.X ç‰ˆæœ¬ä½œä¸ºå­˜å‚¨ã€‚å¦‚æœèƒ–å‹æƒ³ç”¨ Elasticsearch 6.X ç‰ˆæœ¬ä½œä¸ºå­˜å‚¨ï¼Œè®°å¾—ä¸‹è½½ <a href="https://www.apache.org/dyn/closer.cgi/skywalking/6.6.0/apache-skywalking-apm-6.6.0.tar.gz">Binary Distribution (Linux)</a> ç‰ˆæœ¬ã€‚</p><p><strong>â‘  ä¸‹è½½</strong>ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">åˆ›å»ºç›®å½•</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">mkdir</span> -p /Users/yunai/skywalking</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">cd</span> /Users/yunai/skywalking</span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">ä¸‹è½½</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">wget http://mirror.bit.edu.cn/apache/skywalking/6.6.0/apache-skywalking-apm-es7-6.6.0.tar.gz</span><br></code></pre></td></tr></table></figure><p><strong>â‘¡ è§£å‹</strong>ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">è§£å‹</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">tar -zxvf apache-skywalking-apm-es7-6.6.0.tar.gz</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">cd</span>  apache-skywalking-apm-bin-es7</span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">ls</span> -<span class="hljs-built_in">ls</span></span><br> 4 drwxr-xr-x 8 root root  4096 Sep  9 15:09 agent # SkyWalking Agent<br> 4 drwxr-xr-x 2 root root  4096 Sep  9 15:44 bin # æ‰§è¡Œè„šæœ¬<br> 4 drwxr-xr-x 2 root root  4096 Sep  9 15:44 config # SkyWalking OAP Server é…ç½®æ–‡ä»¶<br>32 -rwxr-xr-x 1 root root 28903 Sep  9 14:32 LICENSE<br> 4 drwxr-xr-x 3 root root  4096 Sep  9 15:44 licenses<br>32 -rwxr-xr-x 1 root root 31850 Sep  9 14:32 NOTICE<br>16 drwxr-xr-x 2 root root 16384 Sep  9 15:22 oap-libs # SkyWalking OAP Server<br> 4 -rw-r--r-- 1 root root  1978 Sep  9 14:32 README.txt<br> 4 drwxr-xr-x 2 root root  4096 Sep  9 15:44 webapp # SkyWalking UI<br></code></pre></td></tr></table></figure><h3 id="2-2-2-æ‰‹åŠ¨ç¼–è¯‘"><a href="#2-2-2-æ‰‹åŠ¨ç¼–è¯‘" class="headerlink" title="2.2.2 æ‰‹åŠ¨ç¼–è¯‘"></a>2.2.2 æ‰‹åŠ¨ç¼–è¯‘</h3><blockquote><p>å‹æƒ…æç¤ºï¼šå¦‚æœèƒ–å‹æ²¡æœ‰ç¼–è¯‘ SkyWalking æºç çš„è¯‰æ±‚ï¼Œå¯ä»¥è·³è¿‡æœ¬å°èŠ‚ã€‚</p></blockquote><p>å‚è€ƒ <a href="https://github.com/apache/skywalking/blob/v6.3.0/docs/en/guides/How-to-build.md">How to build project</a> æ–‡ç« ã€‚</p><p>éœ€è¦å‰ç½®å®‰è£…å¦‚ä¸‹ï¼š</p><ul><li>GIT</li><li>JDK 8+</li><li>Maven</li></ul><p><strong>â‘  å…‹éš†ä»£ç </strong>ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">git <span class="hljs-built_in">clone</span> https://github.com/apache/skywalking.git</span><br></code></pre></td></tr></table></figure><ul><li>å› ä¸ºç½‘ç»œé—®é¢˜ï¼Œå¯èƒ½å…‹éš†ä¼šæœ‰ç‚¹ä¹…ã€‚</li></ul><p><strong>â‘¡ åˆå§‹åŒ–å­æ¨¡å—</strong>ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">cd</span> skywalking</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">git submodule init</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">git submodule update</span><br></code></pre></td></tr></table></figure><p><strong>â‘¢ ç¼–è¯‘</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">./mvnw clean package -DskipTests</span><br></code></pre></td></tr></table></figure><ul><li>ç¼–è¯‘è¿‡ç¨‹ï¼Œå¦‚æœæœºå­æ¯”è¾ƒå·®ï¼ŒèŠ±è´¹æ—¶é—´ä¼šæ¯”è¾ƒä¹…ã€‚</li></ul><p><strong>â‘£ æŸ¥çœ‹ç¼–è¯‘ç»“æœ</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">cd</span> apm-dist <span class="hljs-comment"># ç¼–è¯‘ç»“æœç›®å½•</span></span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">cd</span> target</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">tar -zxvf apache-skywalking-apm-bin.tar.gz <span class="hljs-comment"># è§£å‹ Linux åŒ…</span></span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">cd</span> apache-skywalking-apm-bin</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">ls</span> -<span class="hljs-built_in">ls</span></span><br> 4 drwxr-xr-x 8 root root  4096 Sep  9 15:09 agent # SkyWalking Agent<br> 4 drwxr-xr-x 2 root root  4096 Sep  9 15:44 bin # æ‰§è¡Œè„šæœ¬<br> 4 drwxr-xr-x 2 root root  4096 Sep  9 15:44 config # SkyWalking OAP Server é…ç½®æ–‡ä»¶<br>32 -rwxr-xr-x 1 root root 28903 Sep  9 14:32 LICENSE<br> 4 drwxr-xr-x 3 root root  4096 Sep  9 15:44 licenses<br>32 -rwxr-xr-x 1 root root 31850 Sep  9 14:32 NOTICE<br>16 drwxr-xr-x 2 root root 16384 Sep  9 15:22 oap-libs # SkyWalking OAP Server<br> 4 -rw-r--r-- 1 root root  1978 Sep  9 14:32 README.txt<br> 4 drwxr-xr-x 2 root root  4096 Sep  9 15:44 webapp # SkyWalking UI<br></code></pre></td></tr></table></figure><h2 id="2-3-SkyWalking-OAP-æ­å»º"><a href="#2-3-SkyWalking-OAP-æ­å»º" class="headerlink" title="2.3 SkyWalking OAP æ­å»º"></a>2.3 SkyWalking OAP æ­å»º</h2><p><strong>â‘  ä¿®æ”¹ OAP é…ç½®æ–‡ä»¶</strong></p><blockquote><p>å‹æƒ…æç¤ºï¼šå¦‚æœé…ç½®æ–‡ä»¶ï¼Œé€‚åˆ SkyWalking 6.X ç‰ˆæœ¬ã€‚</p></blockquote><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs YAML"><span class="hljs-string">$</span> <span class="hljs-string">vi</span> <span class="hljs-string">config/application.yml</span><br><br><span class="hljs-attr">storage:</span><br>  <span class="hljs-attr">elasticsearch7:</span><br>    <span class="hljs-attr">nameSpace:</span> <span class="hljs-string">$&#123;SW_NAMESPACE:&quot;elasticsearch&quot;&#125;</span><br>    <span class="hljs-attr">clusterNodes:</span> <span class="hljs-string">$&#123;SW_STORAGE_ES_CLUSTER_NODES:localhost:9200&#125;</span><br>    <span class="hljs-attr">protocol:</span> <span class="hljs-string">$&#123;SW_STORAGE_ES_HTTP_PROTOCOL:&quot;http&quot;&#125;</span><br><span class="hljs-comment">#    trustStorePath: $&#123;SW_SW_STORAGE_ES_SSL_JKS_PATH:&quot;../es_keystore.jks&quot;&#125;</span><br><span class="hljs-comment">#    trustStorePass: $&#123;SW_SW_STORAGE_ES_SSL_JKS_PASS:&quot;&quot;&#125;</span><br>    <span class="hljs-attr">user:</span> <span class="hljs-string">$&#123;SW_ES_USER:&quot;&quot;&#125;</span><br>    <span class="hljs-attr">password:</span> <span class="hljs-string">$&#123;SW_ES_PASSWORD:&quot;&quot;&#125;</span><br>    <span class="hljs-attr">indexShardsNumber:</span> <span class="hljs-string">$&#123;SW_STORAGE_ES_INDEX_SHARDS_NUMBER:2&#125;</span><br>    <span class="hljs-attr">indexReplicasNumber:</span> <span class="hljs-string">$&#123;SW_STORAGE_ES_INDEX_REPLICAS_NUMBER:0&#125;</span><br>    <span class="hljs-comment"># Those data TTL settings will override the same settings in core module.</span><br>    <span class="hljs-attr">recordDataTTL:</span> <span class="hljs-string">$&#123;SW_STORAGE_ES_RECORD_DATA_TTL:7&#125;</span> <span class="hljs-comment"># Unit is day</span><br>    <span class="hljs-attr">otherMetricsDataTTL:</span> <span class="hljs-string">$&#123;SW_STORAGE_ES_OTHER_METRIC_DATA_TTL:45&#125;</span> <span class="hljs-comment"># Unit is day</span><br>    <span class="hljs-attr">monthMetricsDataTTL:</span> <span class="hljs-string">$&#123;SW_STORAGE_ES_MONTH_METRIC_DATA_TTL:18&#125;</span> <span class="hljs-comment"># Unit is month</span><br>    <span class="hljs-comment"># Batch process setting, refer to https://www.elastic.co/guide/en/elasticsearch/client/java-api/5.5/java-docs-bulk-processor.html</span><br>    <span class="hljs-attr">bulkActions:</span> <span class="hljs-string">$&#123;SW_STORAGE_ES_BULK_ACTIONS:1000&#125;</span> <span class="hljs-comment"># Execute the bulk every 1000 requests</span><br>    <span class="hljs-attr">flushInterval:</span> <span class="hljs-string">$&#123;SW_STORAGE_ES_FLUSH_INTERVAL:10&#125;</span> <span class="hljs-comment"># flush the bulk every 10 seconds whatever the number of requests</span><br>    <span class="hljs-attr">concurrentRequests:</span> <span class="hljs-string">$&#123;SW_STORAGE_ES_CONCURRENT_REQUESTS:2&#125;</span> <span class="hljs-comment"># the number of concurrent requests</span><br>    <span class="hljs-attr">resultWindowMaxSize:</span> <span class="hljs-string">$&#123;SW_STORAGE_ES_QUERY_MAX_WINDOW_SIZE:10000&#125;</span><br>    <span class="hljs-attr">metadataQueryMaxSize:</span> <span class="hljs-string">$&#123;SW_STORAGE_ES_QUERY_MAX_SIZE:5000&#125;</span><br>    <span class="hljs-attr">segmentQueryMaxSize:</span> <span class="hljs-string">$&#123;SW_STORAGE_ES_QUERY_SEGMENT_SIZE:200&#125;</span><br><span class="hljs-comment">#  h2:</span><br><span class="hljs-comment">#    driver: $&#123;SW_STORAGE_H2_DRIVER:org.h2.jdbcx.JdbcDataSource&#125;</span><br><span class="hljs-comment">#    url: $&#123;SW_STORAGE_H2_URL:jdbc:h2:mem:skywalking-oap-db&#125;</span><br><span class="hljs-comment">#    user: $&#123;SW_STORAGE_H2_USER:sa&#125;</span><br><span class="hljs-comment">#    metadataQueryMaxSize: $&#123;SW_STORAGE_H2_QUERY_MAX_SIZE:5000&#125;</span><br></code></pre></td></tr></table></figure><ul><li><pre><code class="hljs">storage.elasticsearch7<figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey"><br>   <br><br>  é…ç½®é¡¹ï¼Œè®¾ç½®ä½¿ç”¨ Elasticsearch <span class="hljs-number">7</span>.X ç‰ˆæœ¬ä½œä¸ºå­˜å‚¨å™¨ã€‚<br><br>  - è¿™é‡Œï¼Œæˆ‘ä»¬æ‰“å¼€æ³¨é‡Šï¼Œå¹¶è®°å¾—é€šè¿‡ `nameSpace` è®¾ç½® Elasticsearch é›†ç¾¤åã€‚<br><br>- ```<br>  storage.elasticsearch<br></code></pre></td></tr></table></figure> é…ç½®é¡¹ï¼Œè®¾ç½®ä½¿ç”¨ Elasticsearch 6.X ç‰ˆæœ¬ä½œä¸ºå­˜å‚¨å™¨ã€‚- è¿™é‡Œï¼Œæˆ‘ä»¬æ— éœ€åšä»»ä½•æ”¹åŠ¨ã€‚- å¦‚æœèƒ–å‹ä½¿ç”¨ Elasticsearch 6.X ç‰ˆæœ¬ä½œä¸ºå­˜å‚¨å™¨ï¼Œè®°å¾—è®¾ç½®è¿™ä¸ªé…ç½®é¡¹ï¼Œè€Œä¸æ˜¯ `storage.elasticsearch7` é…ç½®é¡¹ã€‚</code></pre></li><li><pre><code class="hljs">storage.h2<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs markdown"><br>   <br><br>  é…ç½®é¡¹ï¼Œè®¾ç½®ä½¿ç”¨ H2 ä½œä¸ºå­˜å‚¨å™¨ã€‚<br><br><span class="hljs-bullet">  -</span> è¿™é‡Œï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨æ³¨é‡Šæ‰ï¼Œå› ä¸º H2 æ˜¯é»˜è®¤é…ç½®çš„å­˜å‚¨å™¨ã€‚<br><br><span class="hljs-quote">&gt; å‹æƒ…æç¤ºï¼šå¦‚æœé…ç½®æ–‡ä»¶ï¼Œé€‚åˆ SkyWalking 7.X ç‰ˆæœ¬ã€‚</span><br><br>![<span class="hljs-string">é…ç½®æ–‡ä»¶</span>](<span class="hljs-link">https://skywalking.apache.org/zh/2020-04-19-skywalking-quick-start/0081Kckwly1gkl534r2llj30pc0rs1kx.jpg</span>)<br><br><span class="hljs-bullet">-</span> é‡ç‚¹ä¿®æ”¹ <span class="hljs-code">`storage`</span> é…ç½®é¡¹ï¼Œé€šè¿‡ <span class="hljs-code">`storage.selector`</span> é…ç½®é¡¹æ¥è®¾ç½®å…·ä½“ä½¿ç”¨çš„å­˜å‚¨å™¨ã€‚<br><span class="hljs-bullet">-</span> <span class="hljs-code">`storage.elasticsearch`</span> é…ç½®é¡¹ï¼Œè®¾ç½®ä½¿ç”¨ Elasticsearch 6.X ç‰ˆæœ¬ä½œä¸ºå­˜å‚¨å™¨ã€‚èƒ–å‹å¯ä»¥ä¸»è¦ä¿®æ”¹ <span class="hljs-code">`nameSpace`</span>ã€<span class="hljs-code">`clusterNodes`</span> ä¸¤ä¸ªé…ç½®é¡¹å³å¯ï¼Œè®¾ç½®ä½¿ç”¨çš„ Elasticsearch çš„é›†ç¾¤å’Œå‘½åç©ºé—´ã€‚<br><span class="hljs-bullet">-</span> <span class="hljs-code">`storage.elasticsearch7`</span> é…ç½®é¡¹ï¼Œè®¾ç½®ä½¿ç”¨ Elasticsearch 7.X ç‰ˆæœ¬ä½œä¸ºå­˜å‚¨å™¨ã€‚<br><span class="hljs-bullet">-</span> è¿˜æœ‰ MySQLã€H2ã€InfluxDB ç­‰ç­‰å­˜å‚¨å™¨çš„é…ç½®å¯ä»¥é€‰æ‹©ï¼Œèƒ–å‹è‡ªå·±æ ¹æ®éœ€è¦å»é€‰æ‹©å“ˆ~<br><br><span class="hljs-strong">**â‘¡ å¯åŠ¨ SkyWalking OAP æœåŠ¡**</span><br><br><span class="hljs-code">```Bash</span><br><span class="hljs-code">$ bin/oapService.sh</span><br><span class="hljs-code"></span><br><span class="hljs-code">SkyWalking OAP started successfully!</span><br></code></pre></td></tr></table></figure></code></pre></li></ul><p>æ˜¯å¦<strong>çœŸæ­£</strong>å¯åŠ¨æˆåŠŸï¼Œèƒ–å‹æ‰“å¼€ <code>logs/skywalking-oap-server.log</code> æ—¥å¿—æ–‡ä»¶ï¼ŒæŸ¥çœ‹æ˜¯å¦æœ‰é”™è¯¯æ—¥å¿—ã€‚é¦–æ¬¡å¯åŠ¨æ—¶ï¼Œå› ä¸º SkyWalking OAP ä¼šåˆ›å»º Elasticsearch çš„ç´¢å¼•ï¼Œæ‰€ä»¥ä¼šâ€œç–¯ç‹‚â€çš„æ‰“å°æ—¥å¿—ã€‚æœ€ç»ˆï¼Œæˆ‘ä»¬çœ‹åˆ°å¦‚ä¸‹æ—¥å¿—ï¼ŒåŸºæœ¬å¯ä»¥ä»£è¡¨ SkyWalking OAP æœåŠ¡å¯åŠ¨æˆåŠŸï¼š</p><blockquote><p>å‹æƒ…æç¤ºï¼šå› ä¸ºé¦–æ¬¡å¯åŠ¨ä¼šåˆ›å»º Elasticsearch ç´¢å¼•ï¼Œæ‰€ä»¥å¯èƒ½ä¼šæ¯”è¾ƒæ…¢ã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-number">2020</span>-<span class="hljs-number">01</span>-<span class="hljs-number">02</span> <span class="hljs-number">18</span>:<span class="hljs-number">22</span>:<span class="hljs-number">53</span>,<span class="hljs-number">635</span> - org.eclipse.jetty.server.Server - <span class="hljs-number">444</span> [main] INFO  [] - Started @35249ms<br></code></pre></td></tr></table></figure><h2 id="2-4-SkyWalking-UI-æ­å»º"><a href="#2-4-SkyWalking-UI-æ­å»º" class="headerlink" title="2.4 SkyWalking UI æ­å»º"></a>2.4 SkyWalking UI æ­å»º</h2><p><strong>â‘  å¯åŠ¨ SkyWalking UI æœåŠ¡</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">bin/webappService.sh<br><br>SkyWalking Web Application started successfully!<br></code></pre></td></tr></table></figure><p>æ˜¯å¦<strong>çœŸæ­£</strong>å¯åŠ¨æˆåŠŸï¼Œèƒ–å‹æ‰“å¼€ <code>logs/logs/webapp.log</code> æ—¥å¿—æ–‡ä»¶ï¼ŒæŸ¥çœ‹æ˜¯å¦æœ‰é”™è¯¯æ—¥å¿—ã€‚æœ€ç»ˆï¼Œæˆ‘ä»¬çœ‹åˆ°å¦‚ä¸‹æ—¥å¿—ï¼ŒåŸºæœ¬å¯ä»¥ä»£è¡¨ SkyWalking UI æœåŠ¡å¯åŠ¨æˆåŠŸï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-number">2020</span>-<span class="hljs-number">01</span>-<span class="hljs-number">02</span> <span class="hljs-number">18</span>:<span class="hljs-number">27</span>:<span class="hljs-number">02.824</span>  INFO <span class="hljs-number">48250</span> --- [main] o.a.s.apm.webapp.ApplicationStartUp      : Started ApplicationStartUp in <span class="hljs-number">7.774</span> seconds (JVM running <span class="hljs-keyword">for</span> <span class="hljs-number">8.316</span>)<br></code></pre></td></tr></table></figure><p>å¦‚æœæƒ³è¦ä¿®æ”¹ SkyWalking UI æœåŠ¡çš„å‚æ•°ï¼Œå¯ä»¥ç¼–è¾‘ <code>webapp/webapp.yml</code> é…ç½®æ–‡ä»¶ã€‚ä¾‹å¦‚è¯´ï¼š</p><ul><li><code>server.port</code> ï¼šSkyWalking UI æœåŠ¡ç«¯å£ã€‚</li><li><code>collector.ribbon.listOfServers</code> ï¼šSkyWalking OAP æœåŠ¡åœ°å€æ•°ç»„ã€‚å› ä¸º SkyWalking UI ç•Œé¢çš„æ•°æ®ï¼Œæ˜¯é€šè¿‡è¯·æ±‚ SkyWalking OAP æœåŠ¡æ¥è·å¾—çš„ã€‚</li></ul><p><strong>â‘¡ è®¿é—® UI ç•Œé¢ï¼š</strong></p><p>æµè§ˆå™¨æ‰“å¼€ <code>http://127.0.0.1:8080</code> ã€‚ç•Œé¢å¦‚ä¸‹å›¾ï¼š<img src="https://skywalking.apache.org/zh/2020-04-19-skywalking-quick-start/0081Kckwly1gkl534a7rnj31f60u0gtw.jpg" alt="SkyWalking UI"></p><h2 id="2-5-SkyWalking-Agent"><a href="#2-5-SkyWalking-Agent" class="headerlink" title="2.5 SkyWalking Agent"></a>2.5 SkyWalking Agent</h2><p>å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åœ¨å¯åŠ¨é¡¹ç›®çš„ Shell è„šæœ¬ä¸Šï¼Œé€šè¿‡ <code>-javaagent</code> å‚æ•°è¿›è¡Œé…ç½® SkyWalking Agent ã€‚æˆ‘ä»¬åœ¨ <a href="https://skywalking.apache.org/zh/2020-04-19-skywalking-quick-start/#">ã€Œ2.3.1 Shellã€</a> å°èŠ‚æ¥çœ‹ã€‚</p><p>è€ƒè™‘åˆ°å¶å°”æˆ‘ä»¬éœ€è¦åœ¨ IDE ä¸­ï¼Œä¹Ÿå¸Œæœ›ä½¿ç”¨ SkyWalking Agent ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ <a href="https://skywalking.apache.org/zh/2020-04-19-skywalking-quick-start/#">ã€Œ2.3.2 IDEAã€</a> å°èŠ‚æ¥çœ‹ã€‚</p><h3 id="2-3-1-Shell"><a href="#2-3-1-Shell" class="headerlink" title="2.3.1 Shell"></a>2.3.1 Shell</h3><p><strong>â‘  Agent è½¯ä»¶åŒ…</strong></p><p>æˆ‘ä»¬éœ€è¦å°† <code>apache-skywalking-apm-bin/agent</code> ç›®å½•ï¼Œæ‹·è´åˆ° Java åº”ç”¨æ‰€åœ¨çš„æœåŠ¡å™¨ä¸Šã€‚è¿™æ ·ï¼ŒJava åº”ç”¨æ‰å¯ä»¥é…ç½®ä½¿ç”¨è¯¥ SkyWalking Agentã€‚æˆ‘ä»¬æ¥çœ‹çœ‹ Agent ç›®å½•ä¸‹æœ‰å“ªäº›ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs Bash">$ <span class="hljs-built_in">ls</span> -<span class="hljs-built_in">ls</span><br><br>total 35176<br>    0 drwxr-xr-x@  7 yunai  staff       224 Dec 24 14:20 activations<br>    0 drwxr-xr-x@  4 yunai  staff       128 Dec 24 14:21 bootstrap-plugins<br>    0 drwxr-xr-x@  3 yunai  staff        96 Dec 24 14:12 config <span class="hljs-comment"># SkyWalking Agent é…ç½®</span><br>    0 drwxr-xr-x@  3 yunai  staff        96 Jan  2 19:29 logs <span class="hljs-comment"># SkyWalking Agent æ—¥å¿—</span><br>    0 drwxr-xr-x@ 13 yunai  staff       416 Dec 24 14:22 optional-plugins <span class="hljs-comment"># å¯é€‰æ’ä»¶</span><br>    0 drwxr-xr-x@ 68 yunai  staff      2176 Dec 24 14:20 plugins <span class="hljs-comment"># æ’ä»¶</span><br>35176 -rw-r--r--@  1 yunai  staff  18006420 Dec 24 14:12 skywalking-agent.jar <span class="hljs-comment"># SkyWalking Agent</span><br></code></pre></td></tr></table></figure><ul><li>å…³äº SkyWalking Agent æä¾›çš„æ’ä»¶åˆ—è¡¨ï¼Œå¯ä»¥çœ‹çœ‹<a href="https://github.com/SkyAPM/document-cn-translation-of-skywalking/blob/master/docs/zh/master/setup/service-agent/java-agent/Supported-list.md">ã€ŠSkyWalking æ–‡æ¡£ â€”â€” æ’ä»¶æ”¯æŒåˆ—è¡¨ã€‹</a>ã€‚</li></ul><p>å› ä¸ºè‰¿è‰¿æ˜¯åœ¨æœ¬æœºæµ‹è¯•ï¼Œæ‰€ä»¥æ— éœ€æ‹·è´ï¼ŒSkyWalking Agent ç›®å½•æ˜¯ <code>/Users/yunai/skywalking/apache-skywalking-apm-bin-es7/agent/</code>ã€‚</p><p>è€ƒè™‘åˆ°æ–¹ä¾¿èƒ–å‹ï¼Œè‰¿è‰¿è¿™é‡Œæä¾›äº†ä¸€ä¸ªæœ€ç®€çš„ Spring Boot åº”ç”¨ <a href="http://static.iocoder.cn/lab-39-demo-2.2.2.RELEASE.jar">lab-39-demo-2.2.2.RELEASE.jar</a>ã€‚å¯¹åº” Github ä»“åº“æ˜¯ <a href="https://github.com/YunaiV/SpringBoot-Labs/tree/master/lab-39/lab-39-demo">lab-39-demo</a>ã€‚</p><p><strong>â‘¡ é…ç½® Java å¯åŠ¨è„šæœ¬</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs Bash"><span class="hljs-comment"># SkyWalking Agent é…ç½®</span><br><span class="hljs-built_in">export</span> SW_AGENT_NAME=demo-application <span class="hljs-comment"># é…ç½® Agent åå­—ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬ç›´æ¥ä½¿ç”¨ Spring Boot é¡¹ç›®çš„ `spring.application.name` ã€‚</span><br><span class="hljs-built_in">export</span> SW_AGENT_COLLECTOR_BACKEND_SERVICES=127.0.0.1:11800 <span class="hljs-comment"># é…ç½® Collector åœ°å€ã€‚</span><br><span class="hljs-built_in">export</span> SW_AGENT_SPAN_LIMIT=2000 <span class="hljs-comment"># é…ç½®é“¾è·¯çš„æœ€å¤§ Span æ•°é‡ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸éœ€è¦é…ç½®ï¼Œé»˜è®¤ä¸º 300 ã€‚ä¸»è¦è€ƒè™‘ï¼Œæœ‰äº›æ–°ä¸Š SkyWalking Agent çš„é¡¹ç›®ï¼Œä»£ç å¯èƒ½æ¯”è¾ƒç³Ÿç³•ã€‚</span><br><span class="hljs-built_in">export</span> JAVA_AGENT=-javaagent:/Users/yunai/skywalking/apache-skywalking-apm-bin-es7/agent/skywalking-agent.jar <span class="hljs-comment"># SkyWalking Agent jar åœ°å€ã€‚</span><br><br><span class="hljs-comment"># Jar å¯åŠ¨</span><br>java -jar <span class="hljs-variable">$JAVA_AGENT</span> -jar lab-39-demo-2.2.2.RELEASE.jar<br></code></pre></td></tr></table></figure><ul><li>é€šè¿‡ç¯å¢ƒå˜é‡ï¼Œè¿›è¡Œé…ç½®ã€‚</li><li>æ›´å¤šçš„å˜é‡ï¼Œå¯ä»¥åœ¨ <a href="https://github.com/apache/skywalking/blob/master/apm-sniffer/config/agent.config"><code>/work/programs/skywalking/apache-skywalking-apm-bin/agent/config/agent.config</code></a> æŸ¥çœ‹ã€‚è¦æ³¨æ„ï¼Œå¯èƒ½æœ‰äº›å˜é‡æ˜¯è¢«æ³¨é‡Šæ‰çš„ï¼Œä¾‹å¦‚è¯´ <code>SW_AGENT_SPAN_LIMIT</code> å¯¹åº”çš„ <code>agent.span_limit_per_segment</code> ã€‚</li></ul><p><strong>â‘¢ æ‰§è¡Œè„šæœ¬ï¼š</strong></p><p>ç›´æ¥æ‰§è¡Œä¸Šè¿°çš„ Shell è„šæœ¬ï¼Œå¯åŠ¨ Java é¡¹ç›®ã€‚åœ¨å¯åŠ¨æ—¥å¿—ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° SkyWalking Agent è¢«åŠ è½½çš„æ—¥å¿—ã€‚æ—¥å¿—ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs Java">DEBUG <span class="hljs-number">2020</span>-<span class="hljs-number">01</span>-<span class="hljs-number">02</span> <span class="hljs-number">19</span>:<span class="hljs-number">29</span>:<span class="hljs-number">29</span>:<span class="hljs-number">400</span> main AgentPackagePath : The beacon <span class="hljs-keyword">class</span> <span class="hljs-title class_">location</span> is jar:file:/Users/yunai/skywalking/apache-skywalking-apm-bin-es7/agent/skywalking-agent.jar!/org/apache/skywalking/apm/agent/core/boot/AgentPackagePath.class.<br>INFO <span class="hljs-number">2020</span>-<span class="hljs-number">01</span>-<span class="hljs-number">02</span> <span class="hljs-number">19</span>:<span class="hljs-number">29</span>:<span class="hljs-number">29</span>:<span class="hljs-number">402</span> main SnifferConfigInitializer : Config file found in /Users/yunai/skywalking/apache-skywalking-apm-bin-es7/agent/config/agent.config.<br></code></pre></td></tr></table></figure><p>åŒæ—¶ï¼Œä¹Ÿå¯ä»¥åœ¨ <code>/Users/yunai/skywalking/apache-skywalking-apm-bin-es7/agent/agent/logs/skywalking-api.log</code> æŸ¥çœ‹å¯¹åº”çš„ SkyWalking Agent æ—¥å¿—ã€‚æ—¥å¿—ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Java">DEBUG <span class="hljs-number">2020</span>-<span class="hljs-number">01</span>-<span class="hljs-number">02</span> <span class="hljs-number">19</span>:<span class="hljs-number">37</span>:<span class="hljs-number">22</span>:<span class="hljs-number">539</span> SkywalkingAgent-<span class="hljs-number">5</span>-ServiceAndEndpointRegisterClient-<span class="hljs-number">0</span> ServiceAndEndpointRegisterClient : ServiceAndEndpointRegisterClient running, status:CONNECTED.<br></code></pre></td></tr></table></figure><ul><li>è¿™é‡Œï¼Œæˆ‘ä»¬çœ‹åˆ° <code>status:CONNECTED</code> ï¼Œè¡¨ç¤º SkyWalking Agent è¿æ¥ SkyWalking OAP æœåŠ¡æˆåŠŸã€‚</li></ul><p><strong>â‘£ ç®€å•æµ‹è¯•</strong></p><p>å®Œäº‹ï¼Œå¯ä»¥å» SkyWalking UI æŸ¥çœ‹æ˜¯å¦é“¾è·¯æ”¶é›†æˆåŠŸã€‚</p><p>1ã€é¦–å…ˆï¼Œä½¿ç”¨æµè§ˆå™¨ï¼Œè®¿é—®ä¸‹ <a href="http://127.0.0.1:8079/demo/echo">http://127.0.0.1:8079/demo/echo</a> åœ°å€ï¼Œè¯·æ±‚ä¸‹ Spring Boot åº”ç”¨æä¾›çš„ APIã€‚å› ä¸ºï¼Œæˆ‘ä»¬è¦è¿½è¸ªä¸‹è¯¥é“¾è·¯ã€‚</p><p>2ã€ç„¶åï¼Œç»§ç»­ä½¿ç”¨æµè§ˆå™¨ï¼Œæ‰“å¼€ <a href="http://127.0.0.1:8080/">http://127.0.0.1:8080/</a> åœ°å€ï¼Œè¿›å…¥ SkyWalking UI ç•Œé¢ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<img src="https://skywalking.apache.org/zh/2020-04-19-skywalking-quick-start/2017-01-01_02.png" alt="SkyWalking UI ç•Œé¢ â€”â€” ä»ªè¡¨ç›˜"></p><p>è¿™é‡Œï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ° SkyWalking ä¸­éå¸¸é‡è¦çš„ä¸‰ä¸ªæ¦‚å¿µï¼š</p><ul><li><p><strong>æœåŠ¡(Service)</strong> ï¼šè¡¨ç¤ºå¯¹è¯·æ±‚æä¾›ç›¸åŒè¡Œä¸ºçš„ä¸€ç³»åˆ—æˆ–ä¸€ç»„å·¥ä½œè´Ÿè½½ã€‚åœ¨ä½¿ç”¨ Agent æˆ– SDK çš„æ—¶å€™ï¼Œä½ å¯ä»¥å®šä¹‰æœåŠ¡çš„åå­—ã€‚å¦‚æœä¸å®šä¹‰çš„è¯ï¼ŒSkyWalking å°†ä¼šä½¿ç”¨ä½ åœ¨å¹³å°ï¼ˆä¾‹å¦‚è¯´ Istioï¼‰ä¸Šå®šä¹‰çš„åå­—ã€‚</p><blockquote><p>è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° Spring Boot åº”ç”¨çš„<strong>æœåŠ¡</strong>ä¸º <code>&quot;demo-application&quot;</code>ï¼Œå°±æ˜¯æˆ‘ä»¬åœ¨ç¯å¢ƒå˜é‡ <code>SW_AGENT_NAME</code> ä¸­æ‰€å®šä¹‰çš„ã€‚</p></blockquote></li><li><p><strong>æœåŠ¡å®ä¾‹(Service Instance)</strong> ï¼šä¸Šè¿°çš„ä¸€ç»„å·¥ä½œè´Ÿè½½ä¸­çš„æ¯ä¸€ä¸ªå·¥ä½œè´Ÿè½½ç§°ä¸ºä¸€ä¸ªå®ä¾‹ã€‚å°±åƒ Kubernetes ä¸­çš„ pods ä¸€æ ·, æœåŠ¡å®ä¾‹æœªå¿…å°±æ˜¯æ“ä½œç³»ç»Ÿä¸Šçš„ä¸€ä¸ªè¿›ç¨‹ã€‚ä½†å½“ä½ åœ¨ä½¿ç”¨ Agent çš„æ—¶å€™, ä¸€ä¸ªæœåŠ¡å®ä¾‹å®é™…å°±æ˜¯æ“ä½œç³»ç»Ÿä¸Šçš„ä¸€ä¸ªçœŸå®è¿›ç¨‹ã€‚</p><blockquote><p>è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° Spring Boot åº”ç”¨çš„<strong>æœåŠ¡</strong>ä¸º <code>&#123;agent_name&#125;-pid:&#123;pid&#125;@&#123;hostname&#125;</code>ï¼Œç”± Agent è‡ªåŠ¨ç”Ÿæˆã€‚å…³äºå®ƒï¼Œæˆ‘ä»¬åœ¨<a href="https://skywalking.apache.org/zh/2020-04-19-skywalking-quick-start/#">ã€Œ5.1 hostnameã€</a>å°èŠ‚ä¸­ï¼Œæœ‰è¿›ä¸€æ­¥çš„è®²è§£ï¼Œèƒ–å‹å¯ä»¥ç…ç…ã€‚</p></blockquote></li><li><p><strong>ç«¯ç‚¹(Endpoint)</strong> ï¼šå¯¹äºç‰¹å®šæœåŠ¡æ‰€æ¥æ”¶çš„è¯·æ±‚è·¯å¾„, å¦‚ HTTP çš„ URI è·¯å¾„å’Œ gRPC æœåŠ¡çš„ç±»å + æ–¹æ³•ç­¾åã€‚</p><blockquote><p>è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° Spring Boot åº”ç”¨çš„ä¸€ä¸ª<strong>ç«¯ç‚¹</strong>ï¼Œä¸º API æ¥å£ <code>/demo/echo</code>ã€‚</p></blockquote></li></ul><p>3ã€ä¹‹åï¼Œç‚¹å‡»ã€Œæ‹“æ‰‘å›¾ã€èœå•ï¼Œè¿›å…¥æŸ¥çœ‹æ‹“æ‰‘å›¾çš„ç•Œé¢ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<img src="https://skywalking.apache.org/zh/2020-04-19-skywalking-quick-start/2017-01-01_03.png" alt="SkyWalking UI ç•Œé¢ â€”â€” æ‹“æ‰‘å›¾"></p><p>4ã€å†ä¹‹åï¼Œç‚¹å‡»ã€Œè¿½è¸ªã€èœå•ï¼Œè¿›å…¥æŸ¥çœ‹é“¾è·¯æ•°æ®çš„ç•Œé¢ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<img src="https://skywalking.apache.org/zh/2020-04-19-skywalking-quick-start/0081Kckwly1gkl535q88ej31ds0u0k0p.jpg" alt="SkyWalking UI ç•Œé¢ â€”â€” è¿½è¸ª"></p><h3 id="2-3-2-IDEA"><a href="#2-3-2-IDEA" class="headerlink" title="2.3.2 IDEA"></a>2.3.2 IDEA</h3><p>æˆ‘ä»¬ç»Ÿä¸€ä½¿ç”¨ IDEA ä½œä¸ºå¼€å‘ IDE ï¼Œæ‰€ä»¥å¿½ç•¥ Eclipse çš„é…ç½®æ–¹å¼ã€‚</p><p>å…·ä½“å‚è€ƒä¸‹å›¾ï¼Œæ¯”è¾ƒç®€å•ï¼š<img src="https://skywalking.apache.org/zh/2020-04-19-skywalking-quick-start/0081Kckwly1gkl5354kg7j30rs0egwkv.jpg" alt="IDEA ç•Œé¢"></p><h1 id="3-æ­å»º-SkyWalking-é›†ç¾¤ç¯å¢ƒ"><a href="#3-æ­å»º-SkyWalking-é›†ç¾¤ç¯å¢ƒ" class="headerlink" title="3. æ­å»º SkyWalking é›†ç¾¤ç¯å¢ƒ"></a>3. æ­å»º SkyWalking é›†ç¾¤ç¯å¢ƒ</h1><p>åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ï¼Œæˆ‘ä»¬ä¸€èˆ¬æ¨èæ­å»º SkyWalking é›†ç¾¤ç¯å¢ƒã€‚ğŸ˜ˆ å½“ç„¶ï¼Œå¦‚æœå…¬å¸æ¯”è¾ƒæŠ é—¨ï¼Œä¹Ÿå¯ä»¥åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ä½¿ç”¨ SkyWalking å•æœºç¯å¢ƒï¼Œæ¯•ç«Ÿ SkyWalking æŒ‚äº†ä¹‹åï¼Œä¸å½±å“ä¸šåŠ¡çš„æ­£å¸¸è¿è¡Œã€‚</p><p>æ­å»ºä¸€ä¸ª SkyWalking <strong>é›†ç¾¤</strong>ç¯å¢ƒï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š</p><ul><li>ç¬¬ä¸€æ­¥ï¼Œæ­å»ºä¸€ä¸ª Elasticsearch æœåŠ¡çš„<strong>é›†ç¾¤</strong>ã€‚</li><li>ç¬¬äºŒæ­¥ï¼Œæ­å»ºä¸€ä¸ªæ³¨å†Œä¸­å¿ƒçš„<strong>é›†ç¾¤</strong>ã€‚ç›®å‰ SkyWalking æ”¯æŒ Zookeeperã€Kubernetesã€Consulã€Nacos ä½œä¸ºæ³¨å†Œä¸­å¿ƒã€‚</li><li>ç¬¬ä¸‰æ­¥ï¼Œæ­å»ºä¸€ä¸ª SkyWalking OAP æœåŠ¡çš„<strong>é›†ç¾¤</strong>ï¼ŒåŒæ—¶å‚è€ƒ<a href="https://github.com/SkyAPM/document-cn-translation-of-skywalking/blob/master/docs/zh/master/setup/backend/backend-cluster.md">ã€ŠSkyWalking æ–‡æ¡£ â€”â€” é›†ç¾¤ç®¡ç†ã€‹</a>ï¼Œå°† SkyWalking OAP æœåŠ¡æ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒä¸Šã€‚</li><li>ç¬¬å››æ­¥ï¼Œå¯åŠ¨ä¸€ä¸ª Spring Boot åº”ç”¨ï¼Œå¹¶é…ç½® SkyWalking Agentã€‚å¦å¤–ï¼Œåœ¨è®¾ç½® SkyWaling Agent çš„ <code>SW_AGENT_COLLECTOR_BACKEND_SERVICES</code> åœ°å€æ—¶ï¼Œéœ€è¦è®¾ç½®å¤šä¸ª SkyWalking OAP æœåŠ¡çš„åœ°å€æ•°ç»„ã€‚</li><li>ç¬¬äº”æ­¥ï¼Œæ­å»ºä¸€ä¸ª SkyWalking UI æœåŠ¡çš„<strong>é›†ç¾¤</strong>ï¼ŒåŒæ—¶ä½¿ç”¨ Nginx è¿›è¡Œè´Ÿè½½å‡è¡¡ã€‚å¦å¤–ï¼Œåœ¨è®¾ç½® SkyWalking UI çš„ <code>collector.ribbon.listOfServers</code> åœ°å€æ—¶ï¼Œä¹Ÿéœ€è¦è®¾ç½®å¤šä¸ª SkyWalking OAP æœåŠ¡çš„åœ°å€æ•°ç»„ã€‚</li></ul><p>ğŸ˜ˆ å…·ä½“çš„æ­å»ºè¿‡ç¨‹ï¼Œå¹¶ä¸å¤æ‚ï¼Œèƒ–å‹è‡ªå·±å»å°è¯•ä¸‹ã€‚</p><h1 id="4-å‘Šè­¦"><a href="#4-å‘Šè­¦" class="headerlink" title="4. å‘Šè­¦"></a>4. å‘Šè­¦</h1><p>åœ¨ SkyWaling ä¸­ï¼Œå·²ç»æä¾›äº†å‘Šè­¦åŠŸèƒ½ï¼Œå…·ä½“å¯è§<a href="https://github.com/SkyAPM/document-cn-translation-of-skywalking/blob/master/docs/zh/master/setup/backend/backend-alarm.md">ã€ŠSkyWalking æ–‡æ¡£ â€”â€” å‘Šè­¦ã€‹</a>ã€‚</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒSkyWalking å·²ç»<a href="https://github.com/SkyAPM/document-cn-translation-of-skywalking/blob/master/docs/zh/master/setup/backend/backend-alarm.md#%E9%BB%98%E8%AE%A4%E5%91%8A%E8%AD%A6%E8%A7%84%E5%88%99">å†…ç½®å‘Šè­¦è§„åˆ™</a>ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å‚è€ƒ<a href="https://github.com/SkyAPM/document-cn-translation-of-skywalking/blob/master/docs/zh/master/setup/backend/backend-alarm.md#%E8%A7%84%E5%88%99">å‘Šè­¦è§„åˆ™</a>ï¼Œè¿›è¡Œè‡ªå®šä¹‰ã€‚</p><p>åœ¨æ»¡è¶³ SkyWalking å‘Šè­¦è§„åˆ™çš„è§¦å‘è§„åˆ™æ—¶ï¼Œæˆ‘ä»¬åœ¨ SkyWaling UI çš„å‘Šè­¦ç•Œé¢ï¼Œå¯ä»¥çœ‹åˆ°å‘Šè­¦å†…å®¹ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<img src="https://skywalking.apache.org/zh/2020-04-19-skywalking-quick-start/2017-01-01_06.png" alt="SkyWaling UI ç•Œé¢ â€”â€” å‘Šè­¦"></p><p>åŒæ—¶ï¼Œæˆ‘ä»¬è‡ªå®šä¹‰ <a href="https://github.com/SkyAPM/document-cn-translation-of-skywalking/blob/master/docs/zh/master/setup/backend/backend-alarm.md#webhook">Webhook</a> ï¼Œå¯¹æ¥ SkyWalking çš„å‘Šè­¦è¯·æ±‚ã€‚è€Œå…·ä½“çš„é‚®ç®±ã€é’‰é’‰ç­‰å‘Šè­¦æ–¹å¼ï¼Œéœ€è¦è‡ªå·±è¿›è¡Œå¼€å‘ã€‚è‡³äºè‡ªå®šä¹‰ WebHook å¦‚ä½•å®ç°ï¼Œå¯ä»¥å‚è€ƒï¼š</p><ul><li>Java è¯­è¨€ï¼š<ul><li><a href="http://www.iocoder.cn/Fight/Distributed-tracking-system-based-on-SkyWalking-abnormal-alert/?self">ã€ŠåŸºäº SkyWalking çš„åˆ†å¸ƒå¼è·Ÿè¸ªç³»ç»Ÿ - å¼‚å¸¸å‘Šè­¦ã€‹</a></li></ul></li><li>Go è¯­è¨€ï¼š<ul><li><a href="https://github.com/yanmaipian/dingding-notify-for-skywalking">dingding-notify-for-skywalking</a></li><li><a href="https://github.com/weiqiang333/infra-skywalking-webhook">infra-skywalking-webhook</a></li></ul></li></ul><h1 id="5-æ³¨æ„äº‹é¡¹"><a href="#5-æ³¨æ„äº‹é¡¹" class="headerlink" title="5. æ³¨æ„äº‹é¡¹"></a>5. æ³¨æ„äº‹é¡¹</h1><h2 id="5-1-hostname-é…ç½®"><a href="#5-1-hostname-é…ç½®" class="headerlink" title="5.1 hostname é…ç½®"></a>5.1 hostname é…ç½®</h2><p>åœ¨ SkyWalking ä¸­ï¼Œæ¯ä¸ªè¢«ç›‘æ§çš„å®ä¾‹çš„åå­—ï¼Œä¼šåŒ…å« hostname ã€‚æ ¼å¼ä¸ºï¼š<code>&#123;agent_name&#125;-pid:&#123;pid&#125;@&#123;hostname&#125;</code> ï¼Œä¾‹å¦‚è¯´ï¼š<code>&quot;scrm-scheduler-pid:27629@iZbp1e2xlyvr7fh67qi59oZ&quot;</code> ã€‚</p><p>å› ä¸ºæœ‰äº›æœåŠ¡å™¨æœªæ­£ç¡®è®¾ç½® <code>hostname</code> ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸€å®šè¦å»ä¿®æ”¹ï¼Œä¸ç„¶éƒ½ä¸çŸ¥é“æ˜¯å“ªä¸ªæœåŠ¡å™¨ä¸Šçš„å®ä¾‹ï¼ˆğŸ˜ˆ é¬¼çŸ¥é“ <code>&quot;iZbp1e2xlyvr7fh67qi59oZ&quot;</code> ä¸€ä¸²æ˜¯å“ªä¸ªæœåŠ¡å™¨å•Šï¼‰ã€‚</p><p>ä¿®æ”¹æ–¹å¼å¦‚ä¸‹ï¼š</p><p><strong>1ã€ä¿®æ”¹ <code>/etc/hosts</code> çš„ <code>hostname</code></strong> ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs Bash">127.0.0.1 localhost<br>::1         localhost localhost.localdomain localhost6 localhost6.localdomain6<br>10.80.62.151 pre-app-01 <span class="hljs-comment"># å°±æ˜¯è¿™ä¸ªï¼Œå…¶ä¸­ 10.80.62.151 æ˜¯æœ¬æœºå†…ç½‘ IP ï¼Œpre-app-01 æ˜¯ hostname ã€‚</span><br></code></pre></td></tr></table></figure><p><strong>2ã€ä¿®æ”¹æœ¬æœº <code>hostname</code></strong> ï¼š</p><p>å‚è€ƒ <a href="https://yq.aliyun.com/articles/427296">ã€ŠCentOS7 ä¿®æ”¹ä¸»æœºåï¼ˆhostnameï¼‰ã€‹</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs Bash">$ hostname pre-app-01 <span class="hljs-comment"># å…¶ä¸­ pre-app-01 å°±æ˜¯ä½ å¸Œæœ›çš„ hostname ã€‚</span><br><br>$ hostnamectl set-hostname pre-app-01 <span class="hljs-comment"># å…¶ä¸­ pre-app-01 å°±æ˜¯ä½ å¸Œæœ›çš„ hostname ã€‚</span><br></code></pre></td></tr></table></figure><h1 id="6-Spring-Boot-ä½¿ç”¨ç¤ºä¾‹"><a href="#6-Spring-Boot-ä½¿ç”¨ç¤ºä¾‹" class="headerlink" title="6. Spring Boot ä½¿ç”¨ç¤ºä¾‹"></a>6. Spring Boot ä½¿ç”¨ç¤ºä¾‹</h1><p>åœ¨ <a href="http://www.iocoder.cn/Spring-Boot/SkyWalking/?self">ã€ŠèŠ‹é“ Spring Boot é“¾è·¯è¿½è¸ª SkyWalking å…¥é—¨ã€‹</a> ä¸­ï¼Œæˆ‘ä»¬æ¥è¯¦ç»†å­¦ä¹ å¦‚ä½•åœ¨ Spring Boot ä¸­ï¼Œæ•´åˆå¹¶ä½¿ç”¨ SkyWalking æ”¶é›†é“¾è·¯æ•°æ®ã€‚ğŸ˜ˆ ç›¸æ¯”<a href="https://skywalking.apache.org/zh/2020-04-19-skywalking-quick-start/#">ã€Œ2.5 SkyWaling Agentã€</a>æ¥è¯´ï¼Œæˆ‘ä»¬ä¼šæä¾›æ›´åŠ ä¸°å¯Œçš„ç¤ºä¾‹å“Ÿã€‚</p><h1 id="7-Spring-Cloud-ä½¿ç”¨ç¤ºä¾‹"><a href="#7-Spring-Cloud-ä½¿ç”¨ç¤ºä¾‹" class="headerlink" title="7. Spring Cloud ä½¿ç”¨ç¤ºä¾‹"></a>7. Spring Cloud ä½¿ç”¨ç¤ºä¾‹</h1><p>åœ¨ <a href="http://www.iocoder.cn/Spring-Cloud/SkyWalking/?self">ã€ŠèŠ‹é“ Spring Cloud é“¾è·¯è¿½è¸ª SkyWalking å…¥é—¨ã€‹</a> ä¸­ï¼Œæˆ‘ä»¬æ¥è¯¦ç»†å­¦ä¹ å¦‚ä½•åœ¨ Spring Cloud ä¸­ï¼Œæ•´åˆå¹¶ä½¿ç”¨ SkyWalking æ”¶é›†é“¾è·¯æ•°æ®ã€‚ğŸ˜ˆ ç›¸æ¯”<a href="https://skywalking.apache.org/zh/2020-04-19-skywalking-quick-start/#">ã€Œ2.5 SkyWaling Agentã€</a>æ¥è¯´ï¼Œæˆ‘ä»¬ä¼šæä¾›æ›´åŠ ä¸°å¯Œçš„ç¤ºä¾‹å“Ÿã€‚</p><h1 id="666-å½©è›‹"><a href="#666-å½©è›‹" class="headerlink" title="666. å½©è›‹ "></a>666. å½©è›‹<a href="https://skywalking.apache.org/zh/2020-04-19-skywalking-quick-start/#666-%E5%BD%A9%E8%9B%8B"> </a></h1><p>æœ¬æ–‡ä»…ä»…æ˜¯ç®€å•çš„ SkyWalking å…¥é—¨æ–‡ç« ï¼Œå¦‚æœèƒ–å‹æƒ³è¦æ›´å¥½çš„ä½¿ç”¨ SkyWalkingï¼Œæ¨èé€šè¯»ä¸‹<a href="https://github.com/SkyAPM/document-cn-translation-of-skywalking">ã€ŠSkyWalking æ–‡æ¡£ã€‹</a>ã€‚</p><p>æƒ³è¦è¿›ä¸€æ­¥æ·±å…¥çš„èƒ–å‹ï¼Œä¹Ÿå¯ä»¥é˜…è¯»å¦‚ä¸‹èµ„æ–™ï¼š</p><ul><li><a href="http://www.iocoder.cn/categories/SkyWalking/?self">ã€ŠSkyWalking æºç è§£æã€‹</a></li><li><a href="http://www.iocoder.cn/Fight/APM-Apache-Skywalking-and-Pinpoint/?self">ã€ŠAPM å·…å³°å¯¹å†³ï¼šApache Skywalking P.K. Pinpointã€‹</a></li><li><a href="http://skywalking.apache.org/zh/blog/">ã€ŠSkyWalking å®˜æ–¹ â€”â€” åšå®¢åˆé›†ã€‹</a></li></ul><p>ğŸ˜ˆ æœ€åå¼±å¼±çš„é—®ä¸€å¥ï¼Œä¸Šå®Œ SkyWaling ä¹‹åï¼Œæœ‰æ²¡å‘ç°è‡ªå·±ç³»ç»Ÿå„ç§åœ°æ–¹æ…¢æ…¢æ…¢ï¼å˜»å˜»ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>è¿ç»´</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç›‘æ§</tag>
      
      <tag>SkyWalking</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>PromQLå†…ç½®å‡½æ•°</title>
    <link href="/2023/04/24/PromQL%E5%86%85%E7%BD%AE%E5%87%BD%E6%95%B0/"/>
    <url>/2023/04/24/PromQL%E5%86%85%E7%BD%AE%E5%87%BD%E6%95%B0/</url>
    
    <content type="html"><![CDATA[<p>Prometheus æä¾›äº†å…¶å®ƒå¤§é‡çš„å†…ç½®å‡½æ•°ï¼Œå¯ä»¥å¯¹æ—¶åºæ•°æ®è¿›è¡Œä¸°å¯Œçš„å¤„ç†ã€‚æŸäº›å‡½æ•°æœ‰é»˜è®¤çš„å‚æ•°ï¼Œä¾‹å¦‚ï¼š<code>year(v=vector(time()) instant-vector)</code>ã€‚å…¶ä¸­å‚æ•° <code>v</code> æ˜¯ä¸€ä¸ªç¬æ—¶å‘é‡ï¼Œå¦‚æœä¸æä¾›è¯¥å‚æ•°ï¼Œå°†ä½¿ç”¨é»˜è®¤å€¼ <code>vector(time())</code>ã€‚instant-vector è¡¨ç¤ºå‚æ•°ç±»å‹ã€‚</p><h2 id="abs"><a href="#abs" class="headerlink" title="abs()"></a>abs()</h2><p><code>abs(v instant-vector)</code> è¿”å›è¾“å…¥å‘é‡çš„æ‰€æœ‰æ ·æœ¬çš„ç»å¯¹å€¼ã€‚</p><h2 id="absent"><a href="#absent" class="headerlink" title="absent()"></a>absent()</h2><p><code>absent(v instant-vector)</code>ï¼Œå¦‚æœä¼ é€’ç»™å®ƒçš„å‘é‡å‚æ•°å…·æœ‰æ ·æœ¬æ•°æ®ï¼Œåˆ™è¿”å›ç©ºå‘é‡ï¼›å¦‚æœä¼ é€’çš„å‘é‡å‚æ•°æ²¡æœ‰æ ·æœ¬æ•°æ®ï¼Œåˆ™è¿”å›ä¸å¸¦åº¦é‡æŒ‡æ ‡åç§°ä¸”å¸¦æœ‰æ ‡ç­¾çš„æ—¶é—´åºåˆ—ï¼Œä¸”æ ·æœ¬å€¼ä¸º1ã€‚</p><p>å½“ç›‘æ§åº¦é‡æŒ‡æ ‡æ—¶ï¼Œå¦‚æœè·å–åˆ°çš„æ ·æœ¬æ•°æ®æ˜¯ç©ºçš„ï¼Œ ä½¿ç”¨ absent æ–¹æ³•å¯¹å‘Šè­¦æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚ä¾‹å¦‚ï¼š</p><p># è¿™é‡Œæä¾›çš„å‘é‡æœ‰æ ·æœ¬æ•°æ®</p><p>absent(http_requests_total{method&#x3D;â€getâ€}) &#x3D;&gt; no data</p><p>absent(sum(http_requests_total{method&#x3D;â€getâ€})) &#x3D;&gt; no data</p><p># ç”±äºä¸å­˜åœ¨åº¦é‡æŒ‡æ ‡ nonexistentï¼Œæ‰€ä»¥ è¿”å›ä¸å¸¦åº¦é‡æŒ‡æ ‡åç§°ä¸”å¸¦æœ‰æ ‡ç­¾çš„æ—¶é—´åºåˆ—ï¼Œä¸”æ ·æœ¬å€¼ä¸º1</p><p>absent(nonexistent{job&#x3D;â€myjobâ€}) &#x3D;&gt; {job&#x3D;â€myjobâ€} 1</p><p># æ­£åˆ™åŒ¹é…çš„ instance ä¸ä½œä¸ºè¿”å› labels ä¸­çš„ä¸€éƒ¨åˆ†</p><p>absent(nonexistent{job&#x3D;â€myjobâ€,instance&#x3D;~â€.*â€}) &#x3D;&gt; {job&#x3D;â€myjobâ€} 1</p><p># sum å‡½æ•°è¿”å›çš„æ—¶é—´åºåˆ—ä¸å¸¦æœ‰æ ‡ç­¾ï¼Œä¸”æ²¡æœ‰æ ·æœ¬æ•°æ®</p><p>absent(sum(nonexistent{job&#x3D;â€myjobâ€})) &#x3D;&gt; {} 1</p><h2 id="ceil"><a href="#ceil" class="headerlink" title="ceil()"></a>ceil()</h2><p><code>ceil(v instant-vector)</code> å°† v ä¸­æ‰€æœ‰å…ƒç´ çš„æ ·æœ¬å€¼å‘ä¸Šå››èˆäº”å…¥åˆ°æœ€æ¥è¿‘çš„æ•´æ•°ã€‚ä¾‹å¦‚ï¼š</p><p>node_load5{instance&#x3D;â€192.168.1.75:9100â€} # ç»“æœä¸º 2.79</p><p>ceil(node_load5{instance&#x3D;â€192.168.1.75:9100â€}) # ç»“æœä¸º 3</p><h2 id="changes"><a href="#changes" class="headerlink" title="changes()"></a>changes()</h2><p><code>changes(v range-vector)</code> è¾“å…¥ä¸€ä¸ªåŒºé—´å‘é‡ï¼Œ è¿”å›è¿™ä¸ªåŒºé—´å‘é‡å†…æ¯ä¸ªæ ·æœ¬æ•°æ®å€¼å˜åŒ–çš„æ¬¡æ•°ï¼ˆç¬æ—¶å‘é‡ï¼‰ã€‚ä¾‹å¦‚ï¼š</p><p># å¦‚æœæ ·æœ¬æ•°æ®å€¼æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œåˆ™è¿”å›ç»“æœä¸º 1</p><p>changes(node_load5{instance&#x3D;â€192.168.1.75:9100â€}[1m]) # ç»“æœä¸º 1</p><h2 id="clamp-max"><a href="#clamp-max" class="headerlink" title="clamp_max()"></a>clamp_max()</h2><p><code>clamp_max(v instant-vector, max scalar)</code> å‡½æ•°ï¼Œè¾“å…¥ä¸€ä¸ªç¬æ—¶å‘é‡å’Œæœ€å¤§å€¼ï¼Œæ ·æœ¬æ•°æ®å€¼è‹¥å¤§äº maxï¼Œåˆ™æ”¹ä¸º maxï¼Œå¦åˆ™ä¸å˜ã€‚ä¾‹å¦‚ï¼š</p><p>node_load5{instance&#x3D;â€192.168.1.75:9100â€} # ç»“æœä¸º 2.79</p><p>clamp_max(node_load5{instance&#x3D;â€192.168.1.75:9100â€}, 2) # ç»“æœä¸º 2</p><h2 id="clamp-min"><a href="#clamp-min" class="headerlink" title="clamp_min()"></a>clamp_min()</h2><p><code>clamp_min(v instant-vector, min scalar)</code> å‡½æ•°ï¼Œè¾“å…¥ä¸€ä¸ªç¬æ—¶å‘é‡å’Œæœ€å°å€¼ï¼Œæ ·æœ¬æ•°æ®å€¼è‹¥å°äº minï¼Œåˆ™æ”¹ä¸º minï¼Œå¦åˆ™ä¸å˜ã€‚ä¾‹å¦‚ï¼š</p><p>node_load5{instance&#x3D;â€192.168.1.75:9100â€} # ç»“æœä¸º 2.79</p><p>clamp_min(node_load5{instance&#x3D;â€192.168.1.75:9100â€}, 3) # ç»“æœä¸º 3</p><h2 id="day-of-month"><a href="#day-of-month" class="headerlink" title="day_of_month()"></a>day_of_month()</h2><p><code>day_of_month(v=vector(time()) instant-vector)</code> å‡½æ•°ï¼Œè¿”å›è¢«ç»™å®š UTC æ—¶é—´æ‰€åœ¨æœˆçš„ç¬¬å‡ å¤©ã€‚è¿”å›å€¼èŒƒå›´ï¼š1~31ã€‚</p><h2 id="day-of-week"><a href="#day-of-week" class="headerlink" title="day_of_week()"></a>day_of_week()</h2><p><code>day_of_week(v=vector(time()) instant-vector)</code> å‡½æ•°ï¼Œè¿”å›è¢«ç»™å®š UTC æ—¶é—´æ‰€åœ¨å‘¨çš„ç¬¬å‡ å¤©ã€‚è¿”å›å€¼èŒƒå›´ï¼š0~6ï¼Œ0 è¡¨ç¤ºæ˜ŸæœŸå¤©ã€‚</p><h2 id="days-in-month"><a href="#days-in-month" class="headerlink" title="days_in_month()"></a>days_in_month()</h2><p><code>days_in_month(v=vector(time()) instant-vector)</code> å‡½æ•°ï¼Œè¿”å›å½“æœˆä¸€å…±æœ‰å¤šå°‘å¤©ã€‚è¿”å›å€¼èŒƒå›´ï¼š28~31ã€‚</p><h2 id="delta"><a href="#delta" class="headerlink" title="delta()"></a>delta()</h2><p><code>delta(v range-vector)</code> çš„å‚æ•°æ˜¯ä¸€ä¸ªåŒºé—´å‘é‡ï¼Œè¿”å›ä¸€ä¸ªç¬æ—¶å‘é‡ã€‚å®ƒè®¡ç®—ä¸€ä¸ªåŒºé—´å‘é‡ v çš„ç¬¬ä¸€ä¸ªå…ƒç´ å’Œæœ€åä¸€ä¸ªå…ƒç´ ä¹‹é—´çš„å·®å€¼ã€‚ç”±äºè¿™ä¸ªå€¼è¢«å¤–æ¨åˆ°æŒ‡å®šçš„æ•´ä¸ªæ—¶é—´èŒƒå›´ï¼Œæ‰€ä»¥å³ä½¿æ ·æœ¬å€¼éƒ½æ˜¯æ•´æ•°ï¼Œä½ ä»ç„¶å¯èƒ½ä¼šå¾—åˆ°ä¸€ä¸ªéæ•´æ•°å€¼ã€‚</p><p>ä¾‹å¦‚ï¼Œä¸‹é¢çš„ä¾‹å­è¿”å›è¿‡å»ä¸¤å°æ—¶çš„ CPU æ¸©åº¦å·®ï¼š</p><p>delta(cpu_temp_celsius{host&#x3D;â€zeusâ€}[2h])</p><p>è¿™ä¸ªå‡½æ•°ä¸€èˆ¬åªç”¨åœ¨ Gauge ç±»å‹çš„æ—¶é—´åºåˆ—ä¸Šã€‚</p><h2 id="deriv"><a href="#deriv" class="headerlink" title="deriv()"></a>deriv()</h2><p><code>deriv(v range-vector)</code> çš„å‚æ•°æ˜¯ä¸€ä¸ªåŒºé—´å‘é‡,è¿”å›ä¸€ä¸ªç¬æ—¶å‘é‡ã€‚å®ƒä½¿ç”¨<a href="http://en.wikipedia.org/wiki/Simple_linear_regression">ç®€å•çš„çº¿æ€§å›å½’</a>è®¡ç®—åŒºé—´å‘é‡ v ä¸­å„ä¸ªæ—¶é—´åºåˆ—çš„å¯¼æ•°ã€‚</p><p>è¿™ä¸ªå‡½æ•°ä¸€èˆ¬åªç”¨åœ¨ Gauge ç±»å‹çš„æ—¶é—´åºåˆ—ä¸Šã€‚</p><h2 id="exp"><a href="#exp" class="headerlink" title="exp()"></a>exp()</h2><p><code>exp(v instant-vector)</code> å‡½æ•°ï¼Œè¾“å…¥ä¸€ä¸ªç¬æ—¶å‘é‡ï¼Œè¿”å›å„ä¸ªæ ·æœ¬å€¼çš„ <code>e</code> çš„æŒ‡æ•°å€¼ï¼Œå³ e çš„ N æ¬¡æ–¹ã€‚å½“ N çš„å€¼è¶³å¤Ÿå¤§æ—¶ä¼šè¿”å› <code>+Inf</code>ã€‚ç‰¹æ®Šæƒ…å†µä¸ºï¼š</p><ul><li><code>Exp(+Inf) = +Inf</code></li><li><code>Exp(NaN) = NaN</code></li></ul><h2 id="floor"><a href="#floor" class="headerlink" title="floor()"></a>floor()</h2><p><code>floor(v instant-vector)</code> å‡½æ•°ä¸ ceil() å‡½æ•°ç›¸åï¼Œå°† v ä¸­æ‰€æœ‰å…ƒç´ çš„æ ·æœ¬å€¼å‘ä¸‹å››èˆäº”å…¥åˆ°æœ€æ¥è¿‘çš„æ•´æ•°ã€‚</p><h2 id="histogram-quantile"><a href="#histogram-quantile" class="headerlink" title="histogram_quantile()"></a>histogram_quantile()</h2><p><code>histogram_quantile(Ï† float, b instant-vector)</code> ä» bucket ç±»å‹çš„å‘é‡ <code>b</code> ä¸­è®¡ç®— Ï† (0 â‰¤ Ï† â‰¤ 1) åˆ†ä½æ•°ï¼ˆç™¾åˆ†ä½æ•°çš„ä¸€èˆ¬å½¢å¼ï¼‰çš„æ ·æœ¬çš„æœ€å¤§å€¼ã€‚ï¼ˆæœ‰å…³ Ï† åˆ†ä½æ•°çš„è¯¦ç»†è¯´æ˜ä»¥åŠç›´æ–¹å›¾æŒ‡æ ‡ç±»å‹çš„ä½¿ç”¨ï¼Œè¯·å‚é˜…<a href="https://prometheus.io/docs/practices/histograms">ç›´æ–¹å›¾å’Œæ‘˜è¦</a>ï¼‰ã€‚å‘é‡ <code>b</code> ä¸­çš„æ ·æœ¬æ˜¯æ¯ä¸ª bucket çš„é‡‡æ ·ç‚¹æ•°é‡ã€‚æ¯ä¸ªæ ·æœ¬çš„ labels ä¸­å¿…é¡»è¦æœ‰ <code>le</code> è¿™ä¸ª label æ¥è¡¨ç¤ºæ¯ä¸ª bucket çš„ä¸Šè¾¹ç•Œï¼Œæ²¡æœ‰ <code>le</code> æ ‡ç­¾çš„æ ·æœ¬ä¼šè¢«å¿½ç•¥ã€‚ç›´æ–¹å›¾æŒ‡æ ‡ç±»å‹è‡ªåŠ¨æä¾›å¸¦æœ‰ <code>_bucket</code> åç¼€å’Œç›¸åº”æ ‡ç­¾çš„æ—¶é—´åºåˆ—ã€‚</p><p>å¯ä»¥ä½¿ç”¨ <code>rate()</code> å‡½æ•°æ¥æŒ‡å®šåˆ†ä½æ•°è®¡ç®—çš„æ—¶é—´çª—å£ã€‚</p><p>ä¾‹å¦‚ï¼Œä¸€ä¸ªç›´æ–¹å›¾æŒ‡æ ‡åç§°ä¸º <code>employee_age_bucket_bucket</code>ï¼Œè¦è®¡ç®—è¿‡å» 10 åˆ†é’Ÿå†… ç¬¬ 90 ä¸ªç™¾åˆ†ä½æ•°ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹è¡¨è¾¾å¼ï¼š</p><p>histogram_quantile(0.9, rate(employee_age_bucket_bucket[10m]))</p><p>è¿”å›ï¼š</p><p>{instance&#x3D;â€10.0.86.71:8080â€,job&#x3D;â€prometheusâ€} 35.714285714285715</p><p>è¿™è¡¨ç¤ºæœ€è¿‘ 10 åˆ†é’Ÿä¹‹å†… 90% çš„æ ·æœ¬çš„æœ€å¤§å€¼ä¸º 35.714285714285715ã€‚</p><p>è¿™ä¸ªè®¡ç®—ç»“æœæ˜¯æ¯ç»„æ ‡ç­¾ç»„åˆæˆä¸€ä¸ªæ—¶é—´åºåˆ—ã€‚æˆ‘ä»¬å¯èƒ½ä¸ä¼šå¯¹æ‰€æœ‰è¿™äº›ç»´åº¦ï¼ˆå¦‚ <code>job</code>ã€<code>instance</code> å’Œ <code>method</code>ï¼‰æ„Ÿå…´è¶£ï¼Œå¹¶å¸Œæœ›å°†å…¶ä¸­çš„ä¸€äº›ç»´åº¦è¿›è¡Œèšåˆï¼Œåˆ™å¯ä»¥ä½¿ç”¨ sum() å‡½æ•°ã€‚ä¾‹å¦‚ï¼Œä»¥ä¸‹è¡¨è¾¾å¼æ ¹æ® <code>job</code> æ ‡ç­¾æ¥å¯¹ç¬¬ 90 ä¸ªç™¾åˆ†ä½æ•°è¿›è¡Œèšåˆï¼š</p><p># histogram_quantile() å‡½æ•°å¿…é¡»åŒ…å« le æ ‡ç­¾</p><p>histogram_quantile(0.9, sum(rate(employee_age_bucket_bucket[10m])) by (job, le))</p><p>å¦‚æœè¦èšåˆæ‰€æœ‰çš„æ ‡ç­¾ï¼Œåˆ™ä½¿ç”¨å¦‚ä¸‹è¡¨è¾¾å¼ï¼š</p><p>histogram_quantile(0.9,sum(rate(employee_age_bucket_bucket[10m])) by (le))</p><blockquote><p><strong>[info] æ³¨æ„</strong></p><p><code>histogram_quantile</code> è¿™ä¸ªå‡½æ•°æ˜¯æ ¹æ®å‡å®šæ¯ä¸ªåŒºé—´å†…çš„æ ·æœ¬åˆ†å¸ƒæ˜¯çº¿æ€§åˆ†å¸ƒæ¥è®¡ç®—ç»“æœå€¼çš„(ä¹Ÿå°±æ˜¯è¯´å®ƒçš„ç»“æœæœªå¿…å‡†ç¡®)ï¼Œæœ€é«˜çš„ bucket å¿…é¡»æ˜¯ le&#x3D;â€+Infâ€ (å¦åˆ™å°±è¿”å› NaN)ã€‚</p><p>å¦‚æœåˆ†ä½æ•°ä½äºæœ€é«˜çš„ bucketï¼ˆ+Infï¼‰ ä¸­ï¼Œåˆ™è¿”å›ç¬¬äºŒä¸ªæœ€é«˜çš„ bucket çš„ä¸Šè¾¹ç•Œã€‚å¦‚æœè¯¥ bucket çš„ä¸Šè¾¹ç•Œå¤§äº 0ï¼Œåˆ™å‡è®¾æœ€ä½çš„ bucket çš„çš„ä¸‹è¾¹ç•Œä¸º 0ï¼Œè¿™ç§æƒ…å†µä¸‹åœ¨è¯¥ bucket å†…ä½¿ç”¨å¸¸è§„çš„çº¿æ€§æ’å€¼ã€‚</p><p>å¦‚æœåˆ†ä½æ•°ä½äºæœ€ä½çš„ bucket ä¸­ï¼Œåˆ™è¿”å›æœ€ä½ bucket çš„ä¸Šè¾¹ç•Œã€‚</p></blockquote><p>å¦‚æœ b å«æœ‰å°‘äº 2 ä¸ª bucketsï¼Œé‚£ä¹ˆä¼šè¿”å› <code>NaN</code>ï¼Œå¦‚æœ Ï† &lt; 0 ä¼šè¿”å› <code>-Inf</code>ï¼Œå¦‚æœ Ï† &gt; 1 ä¼šè¿”å› <code>+Inf</code>ã€‚</p><h2 id="holt-winters"><a href="#holt-winters" class="headerlink" title="holt_winters()"></a>holt_winters()</h2><p><code>holt_winters(v range-vector, sf scalar, tf scalar)</code> å‡½æ•°åŸºäºåŒºé—´å‘é‡ vï¼Œç”Ÿæˆæ—¶é—´åºåˆ—æ•°æ®å¹³æ»‘å€¼ã€‚å¹³æ»‘å› å­ <code>sf</code> è¶Šä½, å¯¹æ—§æ•°æ®çš„é‡è§†ç¨‹åº¦è¶Šé«˜ã€‚è¶‹åŠ¿å› å­ <code>tf</code> è¶Šé«˜ï¼Œå¯¹æ•°æ®çš„è¶‹åŠ¿çš„è€ƒè™‘å°±è¶Šå¤šã€‚å…¶ä¸­ï¼Œ<code>0&lt; sf, tf &lt;=1</code>ã€‚</p><p>holt_winters ä»…é€‚ç”¨äº Gauge ç±»å‹çš„æ—¶é—´åºåˆ—ã€‚</p><h2 id="hour"><a href="#hour" class="headerlink" title="hour()"></a>hour()</h2><p><code>hour(v=vector(time()) instant-vector)</code> å‡½æ•°è¿”å›è¢«ç»™å®š UTC æ—¶é—´çš„å½“å‰ç¬¬å‡ ä¸ªå°æ—¶ï¼Œæ—¶é—´èŒƒå›´ï¼š0~23ã€‚</p><h2 id="idelta"><a href="#idelta" class="headerlink" title="idelta()"></a>idelta()</h2><p>idelta(v range-vector) çš„å‚æ•°æ˜¯ä¸€ä¸ªåŒºé—´å‘é‡, è¿”å›ä¸€ä¸ªç¬æ—¶å‘é‡ã€‚å®ƒè®¡ç®—æœ€æ–°çš„ 2 ä¸ªæ ·æœ¬å€¼ä¹‹é—´çš„å·®å€¼ã€‚</p><p>è¿™ä¸ªå‡½æ•°ä¸€èˆ¬åªç”¨åœ¨ Gauge ç±»å‹çš„æ—¶é—´åºåˆ—ä¸Šã€‚</p><h2 id="increase"><a href="#increase" class="headerlink" title="increase()"></a>increase()</h2><p><code>increase(v range-vector)</code> å‡½æ•°è·å–åŒºé—´å‘é‡ä¸­çš„ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªæ ·æœ¬å¹¶è¿”å›å…¶å¢é•¿é‡, å®ƒä¼šåœ¨å•è°ƒæ€§å‘ç”Ÿå˜åŒ–æ—¶(å¦‚ç”±äºé‡‡æ ·ç›®æ ‡é‡å¯å¼•èµ·çš„è®¡æ•°å™¨å¤ä½)è‡ªåŠ¨ä¸­æ–­ã€‚ç”±äºè¿™ä¸ªå€¼è¢«å¤–æ¨åˆ°æŒ‡å®šçš„æ•´ä¸ªæ—¶é—´èŒƒå›´ï¼Œæ‰€ä»¥å³ä½¿æ ·æœ¬å€¼éƒ½æ˜¯æ•´æ•°ï¼Œä½ ä»ç„¶å¯èƒ½ä¼šå¾—åˆ°ä¸€ä¸ªéæ•´æ•°å€¼ã€‚</p><p>ä¾‹å¦‚ï¼Œä»¥ä¸‹è¡¨è¾¾å¼è¿”å›åŒºé—´å‘é‡ä¸­æ¯ä¸ªæ—¶é—´åºåˆ—è¿‡å» 5 åˆ†é’Ÿå†… HTTP è¯·æ±‚æ•°çš„å¢é•¿æ•°ï¼š</p><p>increase(http_requests_total{job&#x3D;â€apiserverâ€}[5m])</p><p><code>increase</code> çš„è¿”å›å€¼ç±»å‹åªèƒ½æ˜¯è®¡æ•°å™¨ç±»å‹ï¼Œä¸»è¦ä½œç”¨æ˜¯å¢åŠ å›¾è¡¨å’Œæ•°æ®çš„å¯è¯»æ€§ã€‚ä½¿ç”¨ <code>rate</code> å‡½æ•°è®°å½•è§„åˆ™çš„ä½¿ç”¨ç‡ï¼Œä»¥ä¾¿æŒç»­è·Ÿè¸ªæ•°æ®æ ·æœ¬å€¼çš„å˜åŒ–ã€‚</p><h2 id="irate"><a href="#irate" class="headerlink" title="irate()"></a>irate()</h2><p><code>irate(v range-vector)</code> å‡½æ•°ç”¨äºè®¡ç®—åŒºé—´å‘é‡çš„å¢é•¿ç‡ï¼Œä½†æ˜¯å…¶ååº”å‡ºçš„æ˜¯ç¬æ—¶å¢é•¿ç‡ã€‚irate å‡½æ•°æ˜¯é€šè¿‡åŒºé—´å‘é‡ä¸­æœ€åä¸¤ä¸ªä¸¤æœ¬æ•°æ®æ¥è®¡ç®—åŒºé—´å‘é‡çš„å¢é•¿é€Ÿç‡ï¼Œå®ƒä¼šåœ¨å•è°ƒæ€§å‘ç”Ÿå˜åŒ–æ—¶(å¦‚ç”±äºé‡‡æ ·ç›®æ ‡é‡å¯å¼•èµ·çš„è®¡æ•°å™¨å¤ä½)è‡ªåŠ¨ä¸­æ–­ã€‚è¿™ç§æ–¹å¼å¯ä»¥é¿å…åœ¨æ—¶é—´çª—å£èŒƒå›´å†…çš„â€œé•¿å°¾é—®é¢˜â€ï¼Œå¹¶ä¸”ä½“ç°å‡ºæ›´å¥½çš„çµæ•åº¦ï¼Œé€šè¿‡irateå‡½æ•°ç»˜åˆ¶çš„å›¾æ ‡èƒ½å¤Ÿæ›´å¥½çš„ååº”æ ·æœ¬æ•°æ®çš„ç¬æ—¶å˜åŒ–çŠ¶æ€ã€‚</p><p>ä¾‹å¦‚ï¼Œä»¥ä¸‹è¡¨è¾¾å¼è¿”å›åŒºé—´å‘é‡ä¸­æ¯ä¸ªæ—¶é—´åºåˆ—è¿‡å» 5 åˆ†é’Ÿå†…æœ€åä¸¤ä¸ªæ ·æœ¬æ•°æ®çš„ HTTP è¯·æ±‚æ•°çš„å¢é•¿ç‡ï¼š</p><p>irate(http_requests_total{job&#x3D;â€api-serverâ€}[5m])</p><p>irate åªèƒ½ç”¨äºç»˜åˆ¶å¿«é€Ÿå˜åŒ–çš„è®¡æ•°å™¨ï¼Œåœ¨é•¿æœŸè¶‹åŠ¿åˆ†ææˆ–è€…å‘Šè­¦ä¸­æ›´æ¨èä½¿ç”¨ rate å‡½æ•°ã€‚å› ä¸ºä½¿ç”¨ irate å‡½æ•°æ—¶ï¼Œé€Ÿç‡çš„ç®€çŸ­å˜åŒ–ä¼šé‡ç½® <code>FOR</code> è¯­å¥ï¼Œå½¢æˆçš„å›¾å½¢æœ‰å¾ˆå¤šæ³¢å³°ï¼Œéš¾ä»¥é˜…è¯»ã€‚</p><blockquote><p><strong>[info] æ³¨æ„</strong></p><p>å½“å°† <code>irate()</code> å‡½æ•°ä¸<a href="https://prometheus.io/docs/prometheus/latest/querying/operators/#aggregation-operators">èšåˆè¿ç®—ç¬¦</a>ï¼ˆä¾‹å¦‚ <code>sum()</code>ï¼‰æˆ–éšæ—¶é—´èšåˆçš„å‡½æ•°ï¼ˆä»»ä½•ä»¥ <code>_over_time</code> ç»“å°¾çš„å‡½æ•°ï¼‰ä¸€èµ·ä½¿ç”¨æ—¶ï¼Œå¿…é¡»å…ˆæ‰§è¡Œ irate å‡½æ•°ï¼Œç„¶åå†è¿›è¡Œèšåˆæ“ä½œï¼Œå¦åˆ™å½“é‡‡æ ·ç›®æ ‡é‡æ–°å¯åŠ¨æ—¶ irate() æ— æ³•æ£€æµ‹åˆ°è®¡æ•°å™¨æ˜¯å¦è¢«é‡ç½®ã€‚</p></blockquote><h2 id="label-join"><a href="#label-join" class="headerlink" title="label_join()"></a>label_join()</h2><p><code>label_join(v instant-vector, dst_label string, separator string, src_label_1 string, src_label_2 string, ...)</code> å‡½æ•°å¯ä»¥å°†æ—¶é—´åºåˆ— v ä¸­å¤šä¸ªæ ‡ç­¾ <code>src_label</code> çš„å€¼ï¼Œé€šè¿‡ <code>separator</code> ä½œä¸ºè¿æ¥ç¬¦å†™å…¥åˆ°ä¸€ä¸ªæ–°çš„æ ‡ç­¾ <code>dst_label</code> ä¸­ã€‚å¯ä»¥æœ‰å¤šä¸ª src_label æ ‡ç­¾ã€‚</p><p>ä¾‹å¦‚ï¼Œä»¥ä¸‹è¡¨è¾¾å¼è¿”å›çš„æ—¶é—´åºåˆ—å¤šäº†ä¸€ä¸ª <code>foo</code> æ ‡ç­¾ï¼Œæ ‡ç­¾å€¼ä¸º <code>etcd,etcd-k8s</code>ï¼š</p><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xquery">This <span class="hljs-literal">is</span> a code block<br>  up&#123;endpoint=<span class="hljs-string">&quot;api&quot;</span>,<span class="hljs-keyword">instance</span>=<span class="hljs-string">&quot;192.168.123.248:2379&quot;</span>,job=<span class="hljs-string">&quot;etcd&quot;</span>,<span class="hljs-type">namespace</span>=<span class="hljs-string">&quot;monitoring&quot;</span>,service=<span class="hljs-string">&quot;etcd-k8s&quot;</span>&#125; =&gt; up&#123;endpoint=<span class="hljs-string">&quot;api&quot;</span>,<span class="hljs-keyword">instance</span>=<span class="hljs-string">&quot;192.168.123.248:2379&quot;</span>,job=<span class="hljs-string">&quot;etcd&quot;</span>,<span class="hljs-type">namespace</span>=<span class="hljs-string">&quot;monitoring&quot;</span>,service=<span class="hljs-string">&quot;etcd-k8s&quot;</span>&#125; <span class="hljs-number">1</span><br>  <span class="hljs-number">1</span>label_join(up&#123;endpoint=<span class="hljs-string">&quot;api&quot;</span>,<span class="hljs-keyword">instance</span>=<span class="hljs-string">&quot;192.168.123.248:2379&quot;</span>,job=<span class="hljs-string">&quot;etcd&quot;</span>,<span class="hljs-type">namespace</span>=<span class="hljs-string">&quot;monitoring&quot;</span>,service=<span class="hljs-string">&quot;etcd-k8s&quot;</span>&#125;, <span class="hljs-string">&quot;foo&quot;</span>, <span class="hljs-string">&quot;,&quot;</span>, <span class="hljs-string">&quot;job&quot;</span>, <span class="hljs-string">&quot;service&quot;</span>) =&gt; up&#123;endpoint=<span class="hljs-string">&quot;api&quot;</span>,foo=<span class="hljs-string">&quot;etcd,etcd-k8s&quot;</span>,<span class="hljs-keyword">instance</span>=<span class="hljs-string">&quot;192.168.123.248:2379&quot;</span>,job=<span class="hljs-string">&quot;etcd&quot;</span>,<span class="hljs-type">namespace</span>=<span class="hljs-string">&quot;monitoring&quot;</span>,service=<span class="hljs-string">&quot;etcd-k8s&quot;</span>&#125;  <span class="hljs-number">1</span><br>    <br></code></pre></td></tr></table></figure><h2 id="label-replace"><a href="#label-replace" class="headerlink" title="label_replace()"></a>label_replace()</h2><p>ä¸ºäº†èƒ½å¤Ÿè®©å®¢æˆ·ç«¯çš„å›¾æ ‡æ›´å…·æœ‰å¯è¯»æ€§ï¼Œå¯ä»¥é€šè¿‡ <code>label_replace</code> å‡½æ•°ä¸ºæ—¶é—´åºåˆ—æ·»åŠ é¢å¤–çš„æ ‡ç­¾ã€‚label_replace çš„å…·ä½“å‚æ•°å¦‚ä¸‹ï¼š</p><p>label_replace(v instant-vector, dst_label string, replacement string, src_label string, regex string)</p><p>è¯¥å‡½æ•°ä¼šä¾æ¬¡å¯¹ v ä¸­çš„æ¯ä¸€æ¡æ—¶é—´åºåˆ—è¿›è¡Œå¤„ç†ï¼Œé€šè¿‡ <code>regex</code> åŒ¹é… src_label çš„å€¼ï¼Œå¹¶å°†åŒ¹é…éƒ¨åˆ† <code>relacement</code> å†™å…¥åˆ° dst_label æ ‡ç­¾ä¸­ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stylus">This is <span class="hljs-selector-tag">a</span> <span class="hljs-selector-tag">code</span> block<br>  <span class="hljs-built_in">label_replace</span>(up, <span class="hljs-string">&quot;host&quot;</span>, <span class="hljs-string">&quot;$1&quot;</span>, <span class="hljs-string">&quot;instance&quot;</span>,  <span class="hljs-string">&quot;(.*):.*&quot;</span>)<br>    <br></code></pre></td></tr></table></figure><p>å‡½æ•°å¤„ç†åï¼Œæ—¶é—´åºåˆ—å°†åŒ…å«ä¸€ä¸ª <code>host</code> æ ‡ç­¾ï¼Œhost æ ‡ç­¾çš„å€¼ä¸º Exporter å®ä¾‹çš„ IP åœ°å€ï¼š</p><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs clean">This is a <span class="hljs-keyword">code</span> block<br>  up&#123;host=<span class="hljs-string">&quot;localhost&quot;</span>,<span class="hljs-keyword">instance</span>=<span class="hljs-string">&quot;localhost:8080&quot;</span>,job=<span class="hljs-string">&quot;cadvisor&quot;</span>&#125;   <span class="hljs-number">1</span><br>  up&#123;host=<span class="hljs-string">&quot;localhost&quot;</span>,<span class="hljs-keyword">instance</span>=<span class="hljs-string">&quot;localhost:9090&quot;</span>,job=<span class="hljs-string">&quot;prometheus&quot;</span>&#125;   <span class="hljs-number">1</span><br>  up&#123;host=<span class="hljs-string">&quot;localhost&quot;</span>,<span class="hljs-keyword">instance</span>=<span class="hljs-string">&quot;localhost:9100&quot;</span>,job=<span class="hljs-string">&quot;node&quot;</span>&#125;   <span class="hljs-number">1</span><br>    <br></code></pre></td></tr></table></figure><h2 id="ln"><a href="#ln" class="headerlink" title="ln()"></a>ln()</h2><p><code>ln(v instant-vector)</code> è®¡ç®—ç¬æ—¶å‘é‡ v ä¸­æ‰€æœ‰æ ·æœ¬æ•°æ®çš„è‡ªç„¶å¯¹æ•°ã€‚ç‰¹æ®Šæƒ…å†µï¼š</p><ul><li><code>ln(+Inf) = +Inf</code></li><li><code>ln(0) = -Inf</code></li><li><code>ln(x &lt; 0) = NaN</code></li><li><code>ln(NaN) = NaN</code></li></ul><h2 id="log2"><a href="#log2" class="headerlink" title="log2()"></a>log2()</h2><p><code>log2(v instant-vector)</code> å‡½æ•°è®¡ç®—ç¬æ—¶å‘é‡ v ä¸­æ‰€æœ‰æ ·æœ¬æ•°æ®çš„äºŒè¿›åˆ¶å¯¹æ•°ã€‚ç‰¹æ®Šæƒ…å†µåŒä¸Šã€‚</p><h2 id="log10"><a href="#log10" class="headerlink" title="log10()"></a>log10()</h2><p><code>log10(v instant-vector)</code> è®¡ç®—ç¬æ—¶å‘é‡ v ä¸­æ‰€æœ‰æ ·æœ¬æ•°æ®çš„åè¿›åˆ¶å¯¹æ•°ã€‚ç‰¹æ®Šæƒ…å†µåŒä¸Šã€‚</p><h2 id="minute"><a href="#minute" class="headerlink" title="minute()"></a>minute()</h2><p><code>minute(v=vector(time()) instant-vector)</code> å‡½æ•°è¿”å›ç»™å®š UTC æ—¶é—´å½“å‰å°æ—¶çš„ç¬¬å¤šå°‘åˆ†é’Ÿã€‚ç»“æœèŒƒå›´ï¼š0~59ã€‚</p><h2 id="month"><a href="#month" class="headerlink" title="month()"></a>month()</h2><p><code>month(v=vector(time()) instant-vector)</code> å‡½æ•°è¿”å›ç»™å®š UTC æ—¶é—´å½“å‰å±äºç¬¬å‡ ä¸ªæœˆï¼Œç»“æœèŒƒå›´ï¼š0~12ã€‚</p><h2 id="predict-linear"><a href="#predict-linear" class="headerlink" title="predict_linear()"></a>predict_linear()</h2><p><code>predict_linear(v range-vector, t scalar)</code> å‡½æ•°å¯ä»¥é¢„æµ‹æ—¶é—´åºåˆ— v åœ¨ t ç§’åçš„å€¼ã€‚å®ƒåŸºäºç®€å•çº¿æ€§å›å½’çš„æ–¹å¼ï¼Œå¯¹æ—¶é—´çª—å£å†…çš„æ ·æœ¬æ•°æ®è¿›è¡Œç»Ÿè®¡ï¼Œä»è€Œå¯ä»¥å¯¹æ—¶é—´åºåˆ—çš„å˜åŒ–è¶‹åŠ¿åšå‡ºé¢„æµ‹ã€‚è¯¥å‡½æ•°çš„è¿”å›ç»“æœ<strong>ä¸å¸¦æœ‰åº¦é‡æŒ‡æ ‡</strong>ï¼Œåªæœ‰æ ‡ç­¾åˆ—è¡¨ã€‚</p><p>ä¾‹å¦‚ï¼ŒåŸºäº 2 å°æ—¶çš„æ ·æœ¬æ•°æ®ï¼Œæ¥é¢„æµ‹ä¸»æœºå¯ç”¨ç£ç›˜ç©ºé—´çš„æ˜¯å¦åœ¨ 4 ä¸ªå°æ—¶å€™è¢«å æ»¡ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹è¡¨è¾¾å¼ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">predict_linear</span>(node_filesystem_free&#123;job=<span class="hljs-string">&quot;node&quot;</span>&#125;[<span class="hljs-number">2</span>h], <span class="hljs-number">4</span> * <span class="hljs-number">3600</span>) &lt; <span class="hljs-number">0</span><br>  <br></code></pre></td></tr></table></figure><p>é€šè¿‡ä¸‹é¢çš„ä¾‹å­æ¥è§‚å¯Ÿè¿”å›å€¼ï¼š</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">predict<span class="hljs-constructor">_linear(<span class="hljs-params">http_requests_total</span>&#123;<span class="hljs-params">code</span>=<span class="hljs-string">&quot;200&quot;</span>,<span class="hljs-params">instance</span>=<span class="hljs-string">&quot;120.77.65.193:9090&quot;</span>,<span class="hljs-params">job</span>=<span class="hljs-string">&quot;prometheus&quot;</span>,<span class="hljs-params">method</span>=<span class="hljs-string">&quot;get&quot;</span>&#125;[5m], 5)</span><br><br><br>ç»“æœ<br>&#123;code=<span class="hljs-string">&quot;200&quot;</span>,handler=<span class="hljs-string">&quot;query_range&quot;</span>,instance=<span class="hljs-string">&quot;120.77.65.193:9090&quot;</span>,job=<span class="hljs-string">&quot;prometheus&quot;</span>,<span class="hljs-keyword">method</span>=<span class="hljs-string">&quot;get&quot;</span>&#125;  <span class="hljs-number">1</span><br>&#123;code=<span class="hljs-string">&quot;200&quot;</span>,handler=<span class="hljs-string">&quot;prometheus&quot;</span>,instance=<span class="hljs-string">&quot;120.77.65.193:9090&quot;</span>,job=<span class="hljs-string">&quot;prometheus&quot;</span>,<span class="hljs-keyword">method</span>=<span class="hljs-string">&quot;get&quot;</span>&#125;   <span class="hljs-number">4283.449995397104</span><br>code=<span class="hljs-string">&quot;200&quot;</span>,handler=<span class="hljs-string">&quot;static&quot;</span>,instance=<span class="hljs-string">&quot;120.77.65.193:9090&quot;</span>,job=<span class="hljs-string">&quot;prometheus&quot;</span>,<span class="hljs-keyword">method</span>=<span class="hljs-string">&quot;get&quot;</span>&#125;   <span class="hljs-number">22.99999999999999</span><span class="hljs-operator"></span><br><span class="hljs-operator">...</span><br><span class="hljs-operator"></span><br></code></pre></td></tr></table></figure><p>è¿™ä¸ªå‡½æ•°ä¸€èˆ¬åªç”¨åœ¨ Gauge ç±»å‹çš„æ—¶é—´åºåˆ—ä¸Šã€‚</p><h2 id="rate"><a href="#rate" class="headerlink" title="rate()"></a>rate()</h2><p><code>rate(v range-vector)</code> å‡½æ•°å¯ä»¥ç›´æ¥è®¡ç®—åŒºé—´å‘é‡ v åœ¨æ—¶é—´çª—å£å†…å¹³å‡å¢é•¿é€Ÿç‡ï¼Œå®ƒä¼šåœ¨å•è°ƒæ€§å‘ç”Ÿå˜åŒ–æ—¶(å¦‚ç”±äºé‡‡æ ·ç›®æ ‡é‡å¯å¼•èµ·çš„è®¡æ•°å™¨å¤ä½)è‡ªåŠ¨ä¸­æ–­ã€‚è¯¥å‡½æ•°çš„è¿”å›ç»“æœ<strong>ä¸å¸¦æœ‰åº¦é‡æŒ‡æ ‡</strong>ï¼Œåªæœ‰æ ‡ç­¾åˆ—è¡¨ã€‚</p><p>ä¾‹å¦‚ï¼Œä»¥ä¸‹è¡¨è¾¾å¼è¿”å›åŒºé—´å‘é‡ä¸­æ¯ä¸ªæ—¶é—´åºåˆ—è¿‡å» 5 åˆ†é’Ÿå†… HTTP è¯·æ±‚æ•°çš„æ¯ç§’å¢é•¿ç‡ï¼š</p><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs clean">rate(http_requests_total[<span class="hljs-number">5</span>m])<br>ç»“æœï¼š  <br>&#123;<span class="hljs-keyword">code</span>=<span class="hljs-string">&quot;200&quot;</span>,handler=<span class="hljs-string">&quot;label_values&quot;</span>,<span class="hljs-keyword">instance</span>=<span class="hljs-string">&quot;120.77.65.193:9090&quot;</span>,job=<span class="hljs-string">&quot;prometheus&quot;</span>,method=<span class="hljs-string">&quot;get&quot;</span>&#125; <span class="hljs-number">0</span><br>&#123;<span class="hljs-keyword">code</span>=<span class="hljs-string">&quot;200&quot;</span>,handler=<span class="hljs-string">&quot;query_range&quot;</span>,<span class="hljs-keyword">instance</span>=<span class="hljs-string">&quot;120.77.65.193:9090&quot;</span>,job=<span class="hljs-string">&quot;prometheus&quot;</span>,method=<span class="hljs-string">&quot;get&quot;</span>&#125;  <span class="hljs-number">0</span><br>&#123;<span class="hljs-keyword">code</span>=<span class="hljs-string">&quot;200&quot;</span>,handler=<span class="hljs-string">&quot;prometheus&quot;</span>,<span class="hljs-keyword">instance</span>=<span class="hljs-string">&quot;120.77.65.193:9090&quot;</span>,job=<span class="hljs-string">&quot;prometheus&quot;</span>,method=<span class="hljs-string">&quot;get&quot;</span>&#125;   <span class="hljs-number">0.2</span><br>...<br><br></code></pre></td></tr></table></figure><p>rate() å‡½æ•°è¿”å›å€¼ç±»å‹åªèƒ½ç”¨è®¡æ•°å™¨ï¼Œåœ¨é•¿æœŸè¶‹åŠ¿åˆ†ææˆ–è€…å‘Šè­¦ä¸­æ¨èä½¿ç”¨è¿™ä¸ªå‡½æ•°ã€‚</p><blockquote><p><strong>[info] æ³¨æ„</strong></p><p>å½“å°† <code>rate()</code> å‡½æ•°ä¸<a href="https://prometheus.io/docs/prometheus/latest/querying/operators/#aggregation-operators">èšåˆè¿ç®—ç¬¦</a>ï¼ˆä¾‹å¦‚ <code>sum()</code>ï¼‰æˆ–éšæ—¶é—´èšåˆçš„å‡½æ•°ï¼ˆä»»ä½•ä»¥ <code>_over_time</code> ç»“å°¾çš„å‡½æ•°ï¼‰ä¸€èµ·ä½¿ç”¨æ—¶ï¼Œå¿…é¡»å…ˆæ‰§è¡Œ rate å‡½æ•°ï¼Œç„¶åå†è¿›è¡Œèšåˆæ“ä½œï¼Œå¦åˆ™å½“é‡‡æ ·ç›®æ ‡é‡æ–°å¯åŠ¨æ—¶ rate() æ— æ³•æ£€æµ‹åˆ°è®¡æ•°å™¨æ˜¯å¦è¢«é‡ç½®ã€‚</p></blockquote><h2 id="resets"><a href="#resets" class="headerlink" title="resets()"></a>resets()</h2><p><code>resets(v range-vector)</code> çš„å‚æ•°æ˜¯ä¸€ä¸ªåŒºé—´å‘é‡ã€‚å¯¹äºæ¯ä¸ªæ—¶é—´åºåˆ—ï¼Œå®ƒéƒ½è¿”å›ä¸€ä¸ªè®¡æ•°å™¨é‡ç½®çš„æ¬¡æ•°ã€‚ä¸¤ä¸ªè¿ç»­æ ·æœ¬ä¹‹é—´çš„å€¼çš„å‡å°‘è¢«è®¤ä¸ºæ˜¯ä¸€æ¬¡è®¡æ•°å™¨é‡ç½®ã€‚</p><p>è¿™ä¸ªå‡½æ•°ä¸€èˆ¬åªç”¨åœ¨è®¡æ•°å™¨ç±»å‹çš„æ—¶é—´åºåˆ—ä¸Šã€‚</p><h2 id="round"><a href="#round" class="headerlink" title="round()"></a>round()</h2><p><code>round(v instant-vector, to_nearest=1 scalar)</code> å‡½æ•°ä¸ <code>ceil</code> å’Œ <code>floor</code> å‡½æ•°ç±»ä¼¼ï¼Œè¿”å›å‘é‡ä¸­æ‰€æœ‰æ ·æœ¬å€¼çš„æœ€æ¥è¿‘çš„æ•´æ•°ã€‚<code>to_nearest</code> å‚æ•°æ˜¯å¯é€‰çš„,é»˜è®¤ä¸º 1,è¡¨ç¤ºæ ·æœ¬è¿”å›çš„æ˜¯æœ€æ¥è¿‘ 1 çš„æ•´æ•°å€çš„å€¼ã€‚ä½ ä¹Ÿå¯ä»¥å°†è¯¥å‚æ•°æŒ‡å®šä¸ºä»»æ„å€¼ï¼ˆä¹Ÿå¯ä»¥æ˜¯å°æ•°ï¼‰ï¼Œè¡¨ç¤ºæ ·æœ¬è¿”å›çš„æ˜¯æœ€æ¥è¿‘å®ƒçš„æ•´æ•°å€çš„å€¼ã€‚</p><h2 id="scalar"><a href="#scalar" class="headerlink" title="scalar()"></a>scalar()</h2><p><code>scalar(v instant-vector)</code> å‡½æ•°çš„å‚æ•°æ˜¯ä¸€ä¸ªå•å…ƒç´ çš„ç¬æ—¶å‘é‡,å®ƒè¿”å›å…¶å”¯ä¸€çš„æ—¶é—´åºåˆ—çš„å€¼ä½œä¸ºä¸€ä¸ªæ ‡é‡ã€‚å¦‚æœåº¦é‡æŒ‡æ ‡çš„æ ·æœ¬æ•°é‡å¤§äº 1 æˆ–è€…ç­‰äº 0, åˆ™è¿”å› <code>NaN</code>ã€‚</p><h2 id="sort"><a href="#sort" class="headerlink" title="sort()"></a>sort()</h2><p><code>sort(v instant-vector)</code> å‡½æ•°å¯¹å‘é‡æŒ‰å…ƒç´ çš„å€¼è¿›è¡Œå‡åºæ’åºï¼Œè¿”å›ç»“æœï¼škey: value &#x3D; åº¦é‡æŒ‡æ ‡ï¼šæ ·æœ¬å€¼[å‡åºæ’åˆ—]ã€‚</p><h2 id="sort-desc"><a href="#sort-desc" class="headerlink" title="sort_desc()"></a>sort_desc()</h2><p><code>sort(v instant-vector)</code> å‡½æ•°å¯¹å‘é‡æŒ‰å…ƒç´ çš„å€¼è¿›è¡Œé™åºæ’åºï¼Œè¿”å›ç»“æœï¼škey: value &#x3D; åº¦é‡æŒ‡æ ‡ï¼šæ ·æœ¬å€¼[é™åºæ’åˆ—]ã€‚</p><h2 id="sqrt"><a href="#sqrt" class="headerlink" title="sqrt()"></a>sqrt()</h2><p><code>sqrt(v instant-vector)</code> å‡½æ•°è®¡ç®—å‘é‡ v ä¸­æ‰€æœ‰å…ƒç´ çš„å¹³æ–¹æ ¹ã€‚</p><h2 id="time"><a href="#time" class="headerlink" title="time()"></a>time()</h2><p><code>time()</code> å‡½æ•°è¿”å›ä» 1970-01-01 åˆ°ç°åœ¨çš„ç§’æ•°ã€‚æ³¨æ„ï¼šå®ƒä¸æ˜¯ç›´æ¥è¿”å›å½“å‰æ—¶é—´ï¼Œè€Œæ˜¯æ—¶é—´æˆ³</p><h2 id="timestamp"><a href="#timestamp" class="headerlink" title="timestamp()"></a>timestamp()</h2><p><code>timestamp(v instant-vector)</code> å‡½æ•°è¿”å›å‘é‡ v ä¸­çš„æ¯ä¸ªæ ·æœ¬çš„æ—¶é—´æˆ³ï¼ˆä» 1970-01-01 åˆ°ç°åœ¨çš„ç§’æ•°ï¼‰ã€‚</p><p>è¯¥å‡½æ•°ä» Prometheus 2.0 ç‰ˆæœ¬å¼€å§‹å¼•å…¥ã€‚</p><h2 id="vector"><a href="#vector" class="headerlink" title="vector()"></a>vector()</h2><p><code>vector(s scalar)</code> å‡½æ•°å°†æ ‡é‡ s ä½œä¸ºæ²¡æœ‰æ ‡ç­¾çš„å‘é‡è¿”å›ï¼Œå³è¿”å›ç»“æœä¸ºï¼škey: value&#x3D; {}, sã€‚</p><h2 id="year"><a href="#year" class="headerlink" title="year()"></a>year()</h2><p><code>year(v=vector(time()) instant-vector)</code> å‡½æ•°è¿”å›è¢«ç»™å®š UTC æ—¶é—´çš„å½“å‰å¹´ä»½ã€‚</p><h2 id="lt-aggregation-gt-over-time"><a href="#lt-aggregation-gt-over-time" class="headerlink" title="&lt;aggregation&gt;_over_time()"></a><code>&lt;aggregation&gt;_over_time()</code></h2><p>ä¸‹é¢çš„å‡½æ•°åˆ—è¡¨å…è®¸ä¼ å…¥ä¸€ä¸ªåŒºé—´å‘é‡ï¼Œå®ƒä»¬ä¼šèšåˆæ¯ä¸ªæ—¶é—´åºåˆ—çš„èŒƒå›´ï¼Œå¹¶è¿”å›ä¸€ä¸ªç¬æ—¶å‘é‡ï¼š</p><ul><li><code>avg_over_time(range-vector)</code> : åŒºé—´å‘é‡å†…æ¯ä¸ªåº¦é‡æŒ‡æ ‡çš„å¹³å‡å€¼ã€‚</li><li><code>min_over_time(range-vector)</code> : åŒºé—´å‘é‡å†…æ¯ä¸ªåº¦é‡æŒ‡æ ‡çš„æœ€å°å€¼ã€‚</li><li><code>max_over_time(range-vector)</code> : åŒºé—´å‘é‡å†…æ¯ä¸ªåº¦é‡æŒ‡æ ‡çš„æœ€å¤§å€¼ã€‚</li><li><code>sum_over_time(range-vector)</code> : åŒºé—´å‘é‡å†…æ¯ä¸ªåº¦é‡æŒ‡æ ‡çš„æ±‚å’Œã€‚</li><li><code>count_over_time(range-vector)</code> : åŒºé—´å‘é‡å†…æ¯ä¸ªåº¦é‡æŒ‡æ ‡çš„æ ·æœ¬æ•°æ®ä¸ªæ•°ã€‚</li><li><code>quantile_over_time(scalar, range-vector)</code> : åŒºé—´å‘é‡å†…æ¯ä¸ªåº¦é‡æŒ‡æ ‡çš„æ ·æœ¬æ•°æ®å€¼åˆ†ä½æ•°ï¼ŒÏ†-quantile (0 â‰¤ Ï† â‰¤ 1)ã€‚</li><li><code>stddev_over_time(range-vector)</code> : åŒºé—´å‘é‡å†…æ¯ä¸ªåº¦é‡æŒ‡æ ‡çš„æ€»ä½“æ ‡å‡†å·®ã€‚</li><li><code>stdvar_over_time(range-vector)</code> : åŒºé—´å‘é‡å†…æ¯ä¸ªåº¦é‡æŒ‡æ ‡çš„æ€»ä½“æ ‡å‡†æ–¹å·®ã€‚</li></ul><blockquote><p><strong>[info] æ³¨æ„</strong></p><p>å³ä½¿åŒºé—´å‘é‡å†…çš„å€¼åˆ†å¸ƒä¸å‡åŒ€ï¼Œå®ƒä»¬åœ¨èšåˆæ—¶çš„æƒé‡ä¹Ÿæ˜¯ç›¸åŒçš„ã€‚</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>è¿ç»´</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç›‘æ§</tag>
      
      <tag>Prometheus</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Zabbix5.0ç‰ˆæœ¬Docker-compose.yml</title>
    <link href="/2023/04/23/Zabbix5-0%E7%89%88%E6%9C%ACDocker-compose-yml/"/>
    <url>/2023/04/23/Zabbix5-0%E7%89%88%E6%9C%ACDocker-compose-yml/</url>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>é‰´äºç½‘ç»œä¸­å„ä¸ªæ–‡ç« è®²è¿°çš„dockeræ–¹å¼å®‰è£…ä¸€å¥—zabbixâ€”serverç«¯éƒ½æ¨¡ç³Šä¸æ¸…åŠå›½å†…ç½‘ç»œè¿æ¥dockeræœåŠ¡å™¨æ‹‰å–é•œåƒä¸€ç›´æ— æ³•æˆåŠŸçš„æ‹‰å–å®Œæ•´é•œåƒï¼Œé‚åˆ†äº«è‡ªå·±ç»è¿‡æµ‹è¯•å’Œä½¿ç”¨æ— å¼‚å¸¸çš„docker-composeæ–‡ä»¶ï¼Œæ—¨åœ¨è®©å¤§å®¶å¯ä»¥å¿«é€Ÿé«˜æ•ˆçš„éƒ¨ç½²ä¸€å¥—å³å¼€å³ç”¨çš„zabbixæœåŠ¡ç«¯ã€‚</p><h1 id="docker-composeé…ç½®åˆ†äº«"><a href="#docker-composeé…ç½®åˆ†äº«" class="headerlink" title="docker-composeé…ç½®åˆ†äº«"></a>docker-composeé…ç½®åˆ†äº«</h1><p>ä»¥ä¸‹ä¸º<code>docker-compose.yml</code>æ–‡ä»¶ï¼Œè¯·æ ¹æ®è‡ªå·±çš„æƒ…å†µæ›´æ”¹mysqlå¯†ç åŠzabbixç®¡ç†å¯†ç ï¼š</p><figure class="highlight">  <figcaption>This is a code block</figcaption>  <pre><code class="language-shell">  version: "3"  services:    zabbix-db:      image: mysql:5.7      container_name: zabbix-db      environment:        - MYSQL_DATABASE=zabbix        - MYSQL_USER=zabbix        - MYSQL_PASSWORD=zabbix123        - MYSQL_ROOT_PASSWORD=Zabbix123      volumes:        - "$&#123;PWD&#125;/mysql:/var/lib/mysql"<pre><code class="hljs">zabbix-server-mysql:  image: zabbix/zabbix-server-mysql:ubuntu-5.0-latest  container_name: zabbix-server-mysql  environment:    - DB_SERVER_HOST=mysql    - MYSQL_DATABASE=zabbix    - MYSQL_USER=zabbix    - MYSQL_PASSWORD=zabbix123    - MYSQL_ROOT_PASSWORD=Zabbix123  volumes:    - &quot;$&#123;PWD&#125;/zabbix/alertscripts:/usr/lib/zabbix/alertscripts&quot;  ports:    - &quot;10051:10051&quot;  links:    - zabbix-db:mysql  depends_on:    - zabbix-db  zabbix-web-nginx-mysql:  image: zabbix/zabbix-web-nginx-mysql:ubuntu-5.0-latest  container_name: zabbix-web-nginx-mysql  environment:    - DB_SERVER_HOST=mysql    - MYSQL_DATABASE=zabbix    - MYSQL_USER=zabbix    - MYSQL_PASSWORD=zabbix123    - MYSQL_ROOT_PASSWORD=Zabbix123    - TZ=Asia/Shanghai    - PHP_TZ=Asia/Shanghai    ports:    - &quot;8082:8080&quot;  links:    - zabbix-db:mysql    - zabbix-server-mysql:zabbix-server  depends_on:    - zabbix-server-mysql  </code></pre><p>  networks:<br>    default:<br>      external:<br>        name: zabbix</p><p>  </p></code></pre><p></p></figure><p><span style="color: #519D9E; ">æ³¨ï¼šä¸ªäººå»ºè®®åœ¨å¯åŠ¨å‰å…ˆdocker pullä¸‹è½½å¯¹åº”dockeré•œåƒï¼Œå› ä¸ºåœ¨å›½å†…ç½‘ç»œç¯å¢ƒä¸‹æœ‰äº›æƒŠå–œæ— æ³•æ­£å¸¸ä¸‹è½½</span><br>å¦‚é‡æ— æ³•ä¸‹è½½æˆ–æ— æ³•å®Œæ•´ä¸‹è½½çš„é•œåƒæ—¶ï¼Œå¯ä»¥è®¿é—®<a href="https://www.zabbix.com/container_images">Zabbix Docker images</a>Zabbixå®˜ç½‘é•œåƒåœ°å€è·³è½¬è‡³dockeré•œåƒåº“ä¸­ï¼Œåœ¨tagsä¸­é€‰æ‹©è‡ªå·±éœ€è¦çš„ç‰ˆæœ¬å¹¶åœ¨æœ¬åœ°ä½¿ç”¨docker pull xxx è¿›è¡Œæµ‹è¯•æ˜¯å¦å¯ä»¥æ­£å¸¸ä¸‹è½½é•œåƒ</p><h1 id="é‡åˆ°çš„é—®é¢˜"><a href="#é‡åˆ°çš„é—®é¢˜" class="headerlink" title="é‡åˆ°çš„é—®é¢˜"></a>é‡åˆ°çš„é—®é¢˜</h1><h2 id="Mysqlå­—ç¬¦é›†å¯¼è‡´zabbixæ— æ³•æ’å…¥ä¸­æ–‡"><a href="#Mysqlå­—ç¬¦é›†å¯¼è‡´zabbixæ— æ³•æ’å…¥ä¸­æ–‡" class="headerlink" title="Mysqlå­—ç¬¦é›†å¯¼è‡´zabbixæ— æ³•æ’å…¥ä¸­æ–‡"></a>Mysqlå­—ç¬¦é›†å¯¼è‡´zabbixæ— æ³•æ’å…¥ä¸­æ–‡</h2><h3 id="1-æŸ¥çœ‹å½“å‰æ•°æ®åº“æ”¯æŒçš„å­—ç¬¦é›†"><a href="#1-æŸ¥çœ‹å½“å‰æ•°æ®åº“æ”¯æŒçš„å­—ç¬¦é›†" class="headerlink" title="1. æŸ¥çœ‹å½“å‰æ•°æ®åº“æ”¯æŒçš„å­—ç¬¦é›†"></a>1. æŸ¥çœ‹å½“å‰æ•°æ®åº“æ”¯æŒçš„å­—ç¬¦é›†</h3><figure class="highlight">  <figcaption>This is a code block</figcaption>  <pre><code class="language-shell">  mysql> show character set ;  <p>  +â€”â€”â€”-+â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”+â€”â€”â€”â€”â€”â€”â€”+â€”â€”â€“+  </p><p>  | Charset  | Description                     | Default collation   | Maxlen |  </p><p>  +â€”â€”â€”-+â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”+â€”â€”â€”â€”â€”â€”â€”+â€”â€”â€“+  </p><p>  | big5     | Big5 Traditional Chinese        | big5_chinese_ci     |      2 |  </p><p>  | dec8     | DEC West European               | dec8_swedish_ci     |      1 |  </p><p>  | cp850    | DOS West European               | cp850_general_ci    |      1 |  </p><p>  | hp8      | HP West European                | hp8_english_ci      |      1 |  </p><p>  | koi8r    | KOI8-R Relcom Russian           | koi8r_general_ci    |      1 |  </p><p>  | latin1   | cp1252 West European            | latin1_swedish_ci   |      1 |  </p><p>  | latin2   | ISO 8859-2 Central European     | latin2_general_ci   |      1 |  </p><p>  | swe7     | 7bit Swedish                    | swe7_swedish_ci     |      1 |  </p><p>  | ascii    | US ASCII                        | ascii_general_ci    |      1 |  </p><p>  | ujis     | EUC-JP Japanese                 | ujis_japanese_ci    |      3 |  </p><p>  | sjis     | Shift-JIS Japanese              | sjis_japanese_ci    |      2 |  </p><p>  | hebrew   | ISO 8859-8 Hebrew               | hebrew_general_ci   |      1 |  </p><p>  | tis620   | TIS620 Thai                     | tis620_thai_ci      |      1 |  </p><p>  | euckr    | EUC-KR Korean                   | euckr_korean_ci     |      2 |  </p><p>  | koi8u    | KOI8-U Ukrainian                | koi8u_general_ci    |      1 |  </p><p>  | gb2312   | GB2312 Simplified Chinese       | gb2312_chinese_ci   |      2 |  </p><p>  | greek    | ISO 8859-7 Greek                | greek_general_ci    |      1 |  </p><p>  | cp1250   | Windows Central European        | cp1250_general_ci   |      1 |  </p><p>  | gbk      | GBK Simplified Chinese          | gbk_chinese_ci      |      2 |  </p><p>  | latin5   | ISO 8859-9 Turkish              | latin5_turkish_ci   |      1 |  </p><p>  | armscii8 | ARMSCII-8 Armenian              | armscii8_general_ci |      1 |  </p><p>  | utf8     | UTF-8 Unicode                   | utf8_general_ci     |      3 |  </p><p>  | ucs2     | UCS-2 Unicode                   | ucs2_general_ci     |      2 |  </p><p>  | cp866    | DOS Russian                     | cp866_general_ci    |      1 |  </p><p>  | keybcs2  | DOS Kamenicky Czech-Slovak      | keybcs2_general_ci  |      1 |  </p><p>  | macce    | Mac Central European            | macce_general_ci    |      1 |  </p><p>  | macroman | Mac West European               | macroman_general_ci |      1 |  </p><p>  | cp852    | DOS Central European            | cp852_general_ci    |      1 |  </p><p>  | latin7   | ISO 8859-13 Baltic              | latin7_general_ci   |      1 |  </p><p>  | utf8mb4  | UTF-8 Unicode                   | utf8mb4_general_ci  |      4 |  </p><p>  | cp1251   | Windows Cyrillic                | cp1251_general_ci   |      1 |  </p><p>  | utf16    | UTF-16 Unicode                  | utf16_general_ci    |      4 |  </p><p>  | utf16le  | UTF-16LE Unicode                | utf16le_general_ci  |      4 |  </p><p>  | cp1256   | Windows Arabic                  | cp1256_general_ci   |      1 |  </p><p>  | cp1257   | Windows Baltic                  | cp1257_general_ci   |      1 |  </p><p>  | utf32    | UTF-32 Unicode                  | utf32_general_ci    |      4 |  </p><p>  | binary   | Binary pseudo charset           | binary              |      1 |  </p><p>  | geostd8  | GEOSTD8 Georgian                | geostd8_general_ci  |      1 |  </p><p>  | cp932    | SJIS for Windows Japanese       | cp932_japanese_ci   |      2 |  </p><p>  | eucjpms  | UJIS for Windows Japanese       | eucjpms_japanese_ci |      3 |  </p><p>  | gb18030  | China National Standard GB18030 | gb18030_chinese_ci  |      4 |  </p><p>  +â€”â€”â€”-+â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”+â€”â€”â€”â€”â€”â€”â€”+â€”â€”â€“+  </p><p>  41 rows in set (0.00 sec)</p><p>  </p></code></pre><p></p></figure><p>åœ¨æ”¯æŒåˆ—è¡¨ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°çœ¼ç†Ÿçš„asciiï¼Œgbkï¼Œutf8ï¼Œutf8mb4ç­‰ï¼Œä»¥åŠä¸‹é¢ä¼šå‡ºç°çš„latin1ã€‚</p><p><strong>ç€é‡å¼ºè°ƒ</strong>ï¼šutf8å’Œutf8mb4ï¼Œåœ¨åˆ—è¡¨å¯ä»¥çœ‹åˆ°Maxlenæœ€å¤§é•¿åº¦ä¸€æ ï¼Œutf8æœ€å¤§é•¿åº¦ä¸º3å­—èŠ‚ï¼Œæ‰€ä»¥utf8æœ‰ä¸ªåˆ«åå«utf8mb3ï¼Œä¸¤è€…æ˜¯ä¸€ä¸ªæ„æ€ã€‚è€Œutf8mb4æœ€å¤§é•¿åº¦4å­—èŠ‚ï¼Œå¯ä»¥ç†è§£ä¸ºutf8mb4æ˜¯utf8çš„æ‰©å±•ï¼Œæ¯•ç«Ÿå¤šä¸€ä¸ªå­—èŠ‚å¯ä»¥å¤šå­˜å¾ˆå¤šæ•°æ®ï¼Œæ¯”å¦‚ç‰¹æ®Šçš„å­—ç¬¦æˆ–è€…emojiè¡¨æƒ…å°±éœ€è¦utf8mb4å­—ç¬¦é›†ã€‚åœ¨å®é™…ç”Ÿäº§ç¯å¢ƒä¸­ä¹Ÿéƒ½æ˜¯ä½¿ç”¨utf8mb4å­—ç¬¦é›†ã€‚</p><h4 id="1-1-æŸ¥çœ‹å½“å‰æ•°æ®åº“ä½¿ç”¨çš„å­—ç¬¦é›†"><a href="#1-1-æŸ¥çœ‹å½“å‰æ•°æ®åº“ä½¿ç”¨çš„å­—ç¬¦é›†" class="headerlink" title="1.1 æŸ¥çœ‹å½“å‰æ•°æ®åº“ä½¿ç”¨çš„å­—ç¬¦é›†"></a>1.1 æŸ¥çœ‹å½“å‰æ•°æ®åº“ä½¿ç”¨çš„å­—ç¬¦é›†</h4><figure class="highlight">  <figcaption>This is a code block</figcaption>  <pre><code class="language-shell">  mysql> show variables like '%character%' ;  <p>  +â€”â€”â€”â€”â€”â€”â€”â€”â€“+â€”â€”â€”â€”â€”â€”â€”â€”â€”-+  </p><p>  | Variable_name            | Value                      |  </p><p>  +â€”â€”â€”â€”â€”â€”â€”â€”â€“+â€”â€”â€”â€”â€”â€”â€”â€”â€”-+  </p><p>  | character_set_client     | utf8                       |  </p><p>  | character_set_connection | utf8                       |  </p><p>  | character_set_database   | latin1                     |  </p><p>  | character_set_filesystem | binary                     |  </p><p>  | character_set_results    | utf8                       |  </p><p>  | character_set_server     | latin1                     |  </p><p>  | character_set_system     | utf8                       |  </p><p>  | character_sets_dir       | &#x2F;usr&#x2F;share&#x2F;mysql&#x2F;charsets&#x2F; |  </p><p>  +â€”â€”â€”â€”â€”â€”â€”â€”â€“+â€”â€”â€”â€”â€”â€”â€”â€”â€”-+  </p><p>  8 rows in set (0.00 sec)</p><p>  </p></code></pre><p></p></figure><p><strong>å‚æ•°è§£é‡Š</strong>ï¼š</p><p>å®˜æ–¹æ–‡æ¡£ï¼š</p><p><a href="https://dev.mysql.com/doc/refman/5.7/en/server-system-variables.html">https://dev.mysql.com/doc/refman/5.7/en/server-system-variables.html</a></p><table><thead><tr><th>Rate tiers</th><th>Pricing</th></tr></thead><tbody><tr><td>character_set_client</td><td>å®¢æˆ·ç«¯è¯·æ±‚æ•°æ®çš„å­—ç¬¦é›†</td></tr><tr><td>character_set_connection</td><td>ä»å®¢æˆ·ç«¯æ¥æ”¶åˆ°æ•°æ®ï¼Œç„¶åä¼ è¾“çš„å­—ç¬¦é›†</td></tr><tr><td>character_set_database</td><td>é»˜è®¤æ•°æ®åº“çš„å­—ç¬¦é›†ï¼Œæ— è®ºé»˜è®¤æ•°æ®åº“å¦‚ä½•æ”¹å˜ï¼Œéƒ½æ˜¯è¿™ä¸ªå­—ç¬¦é›†ï¼›å¦‚æœæ²¡æœ‰é»˜è®¤æ•°æ®åº“ï¼Œé‚£å°±ä½¿ç”¨ character_set_serveræŒ‡å®šçš„å­—ç¬¦é›†ï¼Œè¿™ä¸ªå˜é‡å»ºè®®ç”±ç³»ç»Ÿè‡ªå·±ç®¡ç†ï¼Œä¸è¦äººä¸ºå®šä¹‰</td></tr><tr><td>character_set_filesystem</td><td>æŠŠosä¸Šæ–‡ä»¶åè½¬åŒ–æˆæ­¤å­—ç¬¦é›†ï¼Œå³æŠŠcharacter_set_clientè½¬æ¢character_set_filesystemï¼Œé»˜è®¤binaryæ˜¯ä¸åšä»»ä½•è½¬æ¢çš„</td></tr><tr><td>character_set_results</td><td>ç»“æœé›†çš„å­—ç¬¦é›†</td></tr><tr><td>character_set_server</td><td>æ•°æ®åº“æœåŠ¡å™¨çš„é»˜è®¤å­—ç¬¦é›†</td></tr><tr><td>character_set_system</td><td>è¿™ä¸ªå€¼æ€»æ˜¯utf8ï¼Œä¸éœ€è¦è®¾ç½®ï¼Œæ˜¯ä¸ºå­˜å‚¨ç³»ç»Ÿå…ƒæ•°æ®çš„å­—ç¬¦é›†</td></tr></tbody></table><p>é€šè¿‡ä»¥ä¸Šå¯ä»¥çœ‹åˆ°æ•°æ®åº“æœåŠ¡å™¨é»˜è®¤çš„å­—ç¬¦é›†æ˜¯latin1ï¼Œæ­¤æ•°æ®é›†æ˜¯ASCIIçš„æ‰©å±•ï¼Œä½†æ˜¯æœ€å¤§é•¿åº¦è¿˜æ˜¯1å­—èŠ‚ï¼Œæ— æ³•å­˜å‚¨æ±‰å­—ï¼Œç‰¹æ®Šç¬¦å·ç­‰ï¼›éœ€è¦å°†é»˜è®¤çš„latin1ä¿®æ”¹ä¸ºå¸¸ç”¨çš„utf8mb4å­—ç¬¦é›†ã€‚</p><p><strong>æ³¨æ„</strong>ï¼šmysqlåœ¨5.5.3ç‰ˆæœ¬ä¹‹åæ‰æ”¯æŒutf8mb4.</p><h4 id="1-2-æŸ¥çœ‹å½“å‰æŸä¸ªæ•°æ®åº“ä½¿ç”¨çš„å­—ç¬¦é›†"><a href="#1-2-æŸ¥çœ‹å½“å‰æŸä¸ªæ•°æ®åº“ä½¿ç”¨çš„å­—ç¬¦é›†" class="headerlink" title="1.2 æŸ¥çœ‹å½“å‰æŸä¸ªæ•°æ®åº“ä½¿ç”¨çš„å­—ç¬¦é›†"></a>1.2 æŸ¥çœ‹å½“å‰æŸä¸ªæ•°æ®åº“ä½¿ç”¨çš„å­—ç¬¦é›†</h4><figure class="highlight">  <figcaption>This is a code block</figcaption>  <pre><code class="language-shell">  mysql> show create database test ;  <p>  +â€”â€”â€”-+â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”+  </p><p>  | Database | Create Database                                                  |  </p><p>  +â€”â€”â€”-+â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”+  </p><p>  | test     | CREATE DATABASE <code>test</code> &#x2F;*!40100 DEFAULT CHARACTER SET utf8mb4 *&#x2F; |  </p><p>  +â€”â€”â€”-+â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”+  </p><p>  1 row in set (0.00 sec)</p><p>  </p></code></pre><p></p></figure><h3 id="2-å­—ç¬¦é›†è½¬æ¢"><a href="#2-å­—ç¬¦é›†è½¬æ¢" class="headerlink" title="2. å­—ç¬¦é›†è½¬æ¢"></a>2. å­—ç¬¦é›†è½¬æ¢</h3><h4 id="1-æ›´æ”¹æ•°æ®åº“é»˜è®¤å­—ç¬¦é›†"><a href="#1-æ›´æ”¹æ•°æ®åº“é»˜è®¤å­—ç¬¦é›†" class="headerlink" title="1. æ›´æ”¹æ•°æ®åº“é»˜è®¤å­—ç¬¦é›†"></a>1. æ›´æ”¹æ•°æ®åº“é»˜è®¤å­—ç¬¦é›†</h4><figure class="highlight">  <figcaption>This is a code block</figcaption>  <pre><code class="language-shell">  [root@localhost ~]# cp /etc/my.cnf /etc/my.cnf.bak    //å¤‡ä»½mysqlé…ç½®æ–‡ä»¶my.cnf  <p>  [root@localhost ~]# vim &#x2F;etc&#x2F;my.cnf<br>  [mysqld]<br>  character-set-server&#x3D;utf8         &#x2F;&#x2F;æ–°å¢é…ç½®é¡¹<br>  datadir&#x3D;&#x2F;var&#x2F;lib&#x2F;mysql<br>  socket&#x3D;&#x2F;var&#x2F;lib&#x2F;mysql&#x2F;mysql.sock<br>  symbolic-links&#x3D;0<br>  log-error&#x3D;&#x2F;var&#x2F;log&#x2F;mysqld.log<br>  pid-file&#x3D;&#x2F;var&#x2F;run&#x2F;mysqld&#x2F;mysqld.pid  </p><p>  [client]                &#x2F;&#x2F;æ–°å¢é…ç½®é¡¹<br>  default-character-set&#x3D;utf8     &#x2F;&#x2F;æ–°å¢é…ç½®é¡¹  </p><p>  [mysql]                     &#x2F;&#x2F;æ–°å¢é…ç½®é¡¹<br>  default-character-set&#x3D;utf8     &#x2F;&#x2F;æ–°å¢é…ç½®é¡¹  </p><p>  [root@localhost ~]# service mysqld restart        &#x2F;&#x2F;é‡å¯mysqlæœåŠ¡<br>  åœæ­¢ mysqldï¼š                                              [ç¡®å®š]<br>  æ­£åœ¨å¯åŠ¨ mysqldï¼š                                          [ç¡®å®š]  </p><p>  [root@localhost ~]# mysql -uroot -p123qqqâ€¦A<br>  â€¦<br>  mysql&gt; show variables like â€˜%char%â€™;<br>  +â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“+â€”â€”â€”â€”â€”â€”â€”â€”â€”-+<br>  | Variable_name                        | Value                      |<br>  +â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“+â€”â€”â€”â€”â€”â€”â€”â€”â€”-+<br>  | character_set_client                 | utf8                       |<br>  | character_set_connection             | utf8                       |<br>  | character_set_database               | utf8                       |<br>  | character_set_filesystem             | binary                     |<br>  | character_set_results                | utf8                       |<br>  | character_set_server                 | utf8                       |<br>  | character_set_system                 | utf8                       |<br>  | character_sets_dir                   | &#x2F;usr&#x2F;share&#x2F;mysql&#x2F;charsets&#x2F; |<br>  | validate_password_special_char_count | 1                          |<br>  +â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“+â€”â€”â€”â€”â€”â€”â€”â€”â€”-+<br>  9 rows in set (0.00 sec)</p><p>  </p></code></pre><p></p></figure><h4 id="2-å¯¼å‡ºæ•°æ®ï¼ˆæ•°æ®åº“å·²å®‰è£…å¹¶é…ç½®äº†zabbixæƒ…å†µä¸‹ï¼‰"><a href="#2-å¯¼å‡ºæ•°æ®ï¼ˆæ•°æ®åº“å·²å®‰è£…å¹¶é…ç½®äº†zabbixæƒ…å†µä¸‹ï¼‰" class="headerlink" title="2. å¯¼å‡ºæ•°æ®ï¼ˆæ•°æ®åº“å·²å®‰è£…å¹¶é…ç½®äº†zabbixæƒ…å†µä¸‹ï¼‰"></a>2. å¯¼å‡ºæ•°æ®ï¼ˆæ•°æ®åº“å·²å®‰è£…å¹¶é…ç½®äº†zabbixæƒ…å†µä¸‹ï¼‰</h4><p>mysqldump -uroot -p  åº“å &gt; zabbix.sql</p><h4 id="3-æ›¿æ¢æ•°æ®ï¼ŒæŸ¥çœ‹sqlæ–‡ä»¶ä¸­çš„å†…å®¹ï¼Œå¯»æ‰¾é»˜è®¤çš„å­—ç¬¦é›†å¹¶æ”¹ä¸ºutf8"><a href="#3-æ›¿æ¢æ•°æ®ï¼ŒæŸ¥çœ‹sqlæ–‡ä»¶ä¸­çš„å†…å®¹ï¼Œå¯»æ‰¾é»˜è®¤çš„å­—ç¬¦é›†å¹¶æ”¹ä¸ºutf8" class="headerlink" title="3. æ›¿æ¢æ•°æ®ï¼ŒæŸ¥çœ‹sqlæ–‡ä»¶ä¸­çš„å†…å®¹ï¼Œå¯»æ‰¾é»˜è®¤çš„å­—ç¬¦é›†å¹¶æ”¹ä¸ºutf8"></a>3. æ›¿æ¢æ•°æ®ï¼ŒæŸ¥çœ‹sqlæ–‡ä»¶ä¸­çš„å†…å®¹ï¼Œå¯»æ‰¾é»˜è®¤çš„å­—ç¬¦é›†å¹¶æ”¹ä¸ºutf8</h4><p>sed -i â€˜s&#x2F;latin1&#x2F;utf8&#x2F;gâ€™ zabbix.sql</p><h4 id="4-å¯¼å…¥æ›´æ¢å­—ç¬¦é›†å’ŒåŸæœ‰æ•°æ®"><a href="#4-å¯¼å…¥æ›´æ¢å­—ç¬¦é›†å’ŒåŸæœ‰æ•°æ®" class="headerlink" title="4. å¯¼å…¥æ›´æ¢å­—ç¬¦é›†å’ŒåŸæœ‰æ•°æ®"></a>4. å¯¼å…¥æ›´æ¢å­—ç¬¦é›†å’ŒåŸæœ‰æ•°æ®</h4><p>Source zabbix.sql</p>]]></content>
    
    
    <categories>
      
      <category>è¿ç»´</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç›‘æ§</tag>
      
      <tag>Zabbix</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Kafkaé›†ç¾¤å®æˆ˜ä¸åŸç†åˆ†æçº¿ä¸Šé—®é¢˜ä¼˜åŒ–</title>
    <link href="/2023/04/21/Kafka%E9%9B%86%E7%BE%A4%E5%AE%9E%E6%88%98%E4%B8%8E%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90%E7%BA%BF%E4%B8%8A%E9%97%AE%E9%A2%98%E4%BC%98%E5%8C%96/"/>
    <url>/2023/04/21/Kafka%E9%9B%86%E7%BE%A4%E5%AE%9E%E6%88%98%E4%B8%8E%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90%E7%BA%BF%E4%B8%8A%E9%97%AE%E9%A2%98%E4%BC%98%E5%8C%96/</url>
    
    <content type="html"><![CDATA[<h1 id="Kafka-é›†ç¾¤å®æˆ˜ä¸åŸç†åˆ†æçº¿ä¸Šé—®é¢˜ä¼˜åŒ–"><a href="#Kafka-é›†ç¾¤å®æˆ˜ä¸åŸç†åˆ†æçº¿ä¸Šé—®é¢˜ä¼˜åŒ–" class="headerlink" title="Kafka é›†ç¾¤å®æˆ˜ä¸åŸç†åˆ†æçº¿ä¸Šé—®é¢˜ä¼˜åŒ–"></a>Kafka é›†ç¾¤å®æˆ˜ä¸åŸç†åˆ†æçº¿ä¸Šé—®é¢˜ä¼˜åŒ–</h1><h2 id="ä¸€ã€ä¸ºä»€ä¹ˆä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—"><a href="#ä¸€ã€ä¸ºä»€ä¹ˆä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—" class="headerlink" title="ä¸€ã€ä¸ºä»€ä¹ˆä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—?"></a>ä¸€ã€ä¸ºä»€ä¹ˆä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—?</h2><h3 id="1-1-KafkaçŸ¥è¯†ç‚¹æ€ç»´å¯¼å›¾"><a href="#1-1-KafkaçŸ¥è¯†ç‚¹æ€ç»´å¯¼å›¾" class="headerlink" title="1.1 KafkaçŸ¥è¯†ç‚¹æ€ç»´å¯¼å›¾"></a>1.1 KafkaçŸ¥è¯†ç‚¹æ€ç»´å¯¼å›¾</h3><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-LinuxKafka%E9%9B%86%E7%BE%A4%E5%AE%9E%E6%88%98.jpg" alt="Kafkaé›†ç¾¤å®æˆ˜"></p><p>ä»¥ç”µå•†ä¸ºä¸šåŠ¡èƒŒæ™¯</p><p>æ¶ˆæ¯é˜Ÿåˆ—è§£å†³çš„å…·ä½“é—®é¢˜æ˜¯ä»€ä¹ˆï¼Ÿ â€“ é€šä¿¡é—®é¢˜ã€‚</p><h3 id="1-2-ä½¿ç”¨åŒæ­¥çš„é€šè®¯æ–¹å¼æ¥è§£å†³å¤šä¸ªæœåŠ¡ä¹‹é—´çš„é€šè®¯"><a href="#1-2-ä½¿ç”¨åŒæ­¥çš„é€šè®¯æ–¹å¼æ¥è§£å†³å¤šä¸ªæœåŠ¡ä¹‹é—´çš„é€šè®¯" class="headerlink" title="1.2 ä½¿ç”¨åŒæ­¥çš„é€šè®¯æ–¹å¼æ¥è§£å†³å¤šä¸ªæœåŠ¡ä¹‹é—´çš„é€šè®¯"></a>1.2 ä½¿ç”¨åŒæ­¥çš„é€šè®¯æ–¹å¼æ¥è§£å†³å¤šä¸ªæœåŠ¡ä¹‹é—´çš„é€šè®¯</h3><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linux%E8%AE%A2%E5%8D%95%E5%9C%BA%E6%99%AF.png" alt="è®¢å•åœºæ™¯"></p><p>åŒæ­¥çš„é€šè®¯æ–¹å¼ä¼šå­˜åœ¨æ€§èƒ½å’Œç¨³å®šæ€§çš„é—®é¢˜ã€‚</p><h3 id="1-3-ä½¿ç”¨å¼‚æ­¥é€šè®¯æ–¹å¼"><a href="#1-3-ä½¿ç”¨å¼‚æ­¥é€šè®¯æ–¹å¼" class="headerlink" title="1.3 ä½¿ç”¨å¼‚æ­¥é€šè®¯æ–¹å¼"></a>1.3 ä½¿ç”¨å¼‚æ­¥é€šè®¯æ–¹å¼</h3><p>åœ¨ä¸šåŠ¡çš„ä¸Šæ¸¸ä¸ä¸‹æ¸¸é—´åŠ å…¥ é€šè®¯æ¨¡å— ï¼ˆæ¶ˆæ¯é˜Ÿåˆ— å­˜å‚¨æ¶ˆæ¯çš„é˜Ÿåˆ—ï¼‰</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linux%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97%E9%80%9A%E8%AE%AF%E6%96%B9%E5%BC%8F.png" alt="æ¶ˆæ¯é˜Ÿåˆ—é€šè®¯æ–¹å¼"></p><p>æœ€ç»ˆä¸€è‡´æ€§</p><p>é’ˆå¯¹åŒæ­¥çš„é€šè®¯æ–¹å¼æ¥è¯´ï¼Œå¼‚æ­¥çš„æ–¹å¼ï¼Œå¯ä»¥è®©ä¸Šæ¸¸å¿«é€ŸæˆåŠŸï¼Œæå¤§æé«˜äº†ç³»ç»Ÿçš„ååé‡ã€‚è€Œä¸”åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œé€šè¿‡ä¸‹æ¸¸å¤šä¸ªæœåŠ¡çš„åˆ†å¸ƒå¼äº‹åŠ¡ä¿éšœï¼Œä¹Ÿèƒ½ä¿è¯ä¸šåŠ¡æ‰§è¡Œä¹‹åçš„æœ€ç»ˆä¸€è‡´æ€§ã€‚</p><h2 id="äºŒã€æ¶ˆæ¯é˜Ÿåˆ—çš„æµæ´¾"><a href="#äºŒã€æ¶ˆæ¯é˜Ÿåˆ—çš„æµæ´¾" class="headerlink" title="äºŒã€æ¶ˆæ¯é˜Ÿåˆ—çš„æµæ´¾"></a>äºŒã€æ¶ˆæ¯é˜Ÿåˆ—çš„æµæ´¾</h2><h3 id="2-1-ä»€ä¹ˆæ˜¯MQ-ï¼Ÿ"><a href="#2-1-ä»€ä¹ˆæ˜¯MQ-ï¼Ÿ" class="headerlink" title="2.1 ä»€ä¹ˆæ˜¯MQ ï¼Ÿ"></a>2.1 ä»€ä¹ˆæ˜¯MQ ï¼Ÿ</h3><p>Message Queueï¼ˆMQï¼‰ï¼Œæ¶ˆæ¯é˜Ÿåˆ—ä¸­é—´ä»¶ã€‚</p><p>å¾ˆå¤šäººéƒ½è¯´ï¼š</p><p>MQ é€šè¿‡å°†æ¶ˆæ¯çš„å‘é€å’Œæ¥æ”¶åˆ†ç¦»æ¥å®ç°åº”ç”¨ç¨‹åºçš„å¼‚æ­¥å’Œè§£å¶ï¼Œè¿™ä¸ªç»™äººçš„ç›´è§‰æ˜¯â€”â€”MQ æ˜¯å¼‚æ­¥çš„ï¼Œç”¨æ¥è§£è€¦çš„ï¼Œä½†æ˜¯è¿™ä¸ªåªæ˜¯ MQ çš„æ•ˆæœè€Œä¸æ˜¯ç›®çš„ã€‚</p><p>MQ çœŸæ­£çš„ç›®çš„æ˜¯ä¸ºäº†é€šè®¯ï¼Œå±è”½åº•å±‚å¤æ‚çš„é€šè®¯åè®®ï¼Œå®šä¹‰äº†ä¸€å¥—åº”ç”¨å±‚çš„ã€æ›´åŠ ç®€å•çš„é€šè®¯åè®®ã€‚</p><p>ä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿä¸­ä¸¤ä¸ªæ¨¡å—ä¹‹é—´é€šè®¯è¦ä¹ˆæ˜¯ HTTPï¼Œè¦ä¹ˆæ˜¯è‡ªå·±å¼€å‘çš„ TCPï¼Œä½†æ˜¯è¿™ä¸¤ç§åè®®å…¶å®éƒ½æ˜¯åŸå§‹çš„åè®®ã€‚</p><p>HTTP åè®®å¾ˆéš¾å®ç°ä¸¤ç«¯é€šè®¯â€”â€”æ¨¡å— A å¯ä»¥è°ƒç”¨ Bï¼ŒB ä¹Ÿå¯ä»¥ä¸»åŠ¨è°ƒç”¨ Aï¼Œå¦‚æœè¦åšåˆ°è¿™ä¸ªä¸¤ç«¯éƒ½è¦èƒŒä¸Š WebServerï¼Œè€Œä¸”è¿˜ä¸æ”¯æŒé•¿è¿æ¥ï¼ˆHTTP 2.0 çš„åº“æ ¹æœ¬æ‰¾ä¸åˆ°ï¼‰ã€‚<br>TCP å°±æ›´åŠ åŸå§‹äº†ï¼Œç²˜åŒ…ã€å¿ƒè·³ã€ç§æœ‰çš„åè®®ï¼Œæƒ³ä¸€æƒ³å¤´çš®å°±å‘éº»ã€‚</p><p>MQ æ‰€è¦åšçš„å°±æ˜¯åœ¨è¿™äº›åè®®ä¹‹ä¸Šæ„å»ºä¸€ä¸ªç®€å•çš„â€œåè®®â€â€”â€”ç”Ÿäº§è€…&#x2F;æ¶ˆè´¹è€…æ¨¡å‹ã€‚</p><p>MQ å¸¦ç»™æˆ‘çš„â€œåè®®â€ä¸æ˜¯å…·ä½“çš„é€šè®¯åè®®ï¼Œè€Œæ˜¯æ›´é«˜å±‚æ¬¡é€šè®¯æ¨¡å‹ã€‚<br>å®ƒå®šä¹‰äº†ä¸¤ä¸ªå¯¹è±¡â€”â€”å‘é€æ•°æ®çš„å«ç”Ÿäº§è€…ï¼Œæ¥æ”¶æ•°æ®çš„å«æ¶ˆè´¹è€…ï¼›<br>æä¾›ä¸€ä¸ª SDK è®©æˆ‘ä»¬å¯ä»¥å®šä¹‰è‡ªå·±çš„ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…å®ç°æ¶ˆæ¯é€šè®¯è€Œæ— è§†åº•å±‚é€šè®¯åè®®ã€‚</p><h3 id="2-2-ä¸­é—´ä»¶é€‰å‹"><a href="#2-2-ä¸­é—´ä»¶é€‰å‹" class="headerlink" title="2.2 ä¸­é—´ä»¶é€‰å‹"></a>2.2 ä¸­é—´ä»¶é€‰å‹</h3><p>ç›®å‰æ¶ˆæ¯é˜Ÿåˆ—çš„ä¸­é—´ä»¶é€‰å‹æœ‰å¾ˆå¤šç§ï¼š</p><p>rabbit MQï¼šå†…éƒ¨å¯ç©æ€§ï¼ˆåŠŸèƒ½æ€§ï¼‰æ˜¯éå¸¸å¼ºçš„</p><p>rocket MQ :é˜¿é‡Œå†…éƒ¨å¤§ç¥æ ¹æ®Kafkaçš„å†…éƒ¨æ‰§è¡ŒåŸç†ï¼Œæ‰‹å†™çš„ä¸€ä¸ªæ¶ˆæ¯ä¸­é—´ä»¶ã€‚æ€§èƒ½æ¯”è‚©kafkaï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œåœ¨åŠŸèƒ½ä¸Šå°è£…äº†æ›´å¤šçš„åŠŸèƒ½ã€‚ï¼ˆæ¶ˆæ¯çš„é€†åºï¼‰<br>kafkaï¼šå…¨çƒæ¶ˆæ¯å¤„ç†æ€§èƒ½æœ€å¿«çš„ä¸€æ¬¾MQï¼ˆçº¯ç²¹ï¼‰</p><p>zeroMQ</p><p>è¿™äº›æ¶ˆæ¯é˜Ÿåˆ—ä¸­é—´ä»¶æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p><p>æˆ‘ä»¬æŠŠæ¶ˆæ¯é˜Ÿåˆ—åˆ†ä¸ºä¸¤ç§</p><p>MQï¼Œåˆ†ä¸ºæœ‰Brokerçš„MQï¼Œå’Œæ²¡æœ‰Brokerçš„MQã€‚<br>Brokerï¼Œä»£ç†ï¼Œç»çºªäººçš„æ„æ€ã€‚</p><h4 id="2-2-1-æœ‰broker"><a href="#2-2-1-æœ‰broker" class="headerlink" title="2.2.1 æœ‰broker"></a>2.2.1 æœ‰broker</h4><p>æœ‰brokerçš„MQ<br>è¿™ä¸ªæµæ´¾é€šå¸¸æœ‰ä¸€å°æœåŠ¡å™¨ä½œä¸ºBrokerï¼Œæ‰€æœ‰çš„æ¶ˆæ¯éƒ½é€šè¿‡å®ƒä¸­è½¬ã€‚ç”Ÿäº§è€…æŠŠæ¶ˆæ¯å‘é€ç»™å®ƒå°±ç»“æŸè‡ªå·±çš„ä»»åŠ¡äº†ï¼ŒBrokeråˆ™æŠŠæ¶ˆæ¯ä¸»åŠ¨æ¨é€ç»™æ¶ˆè´¹è€…ï¼ˆæˆ–è€…æ¶ˆè´¹è€…ä¸»åŠ¨è½®è¯¢ï¼‰ã€‚</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linux%E6%9C%89broker.png" alt="æœ‰broker"></p><p>é‡topicï¼šKafka ã€RocketMQ ã€ ActiveMQ<br>æ•´ä¸ªbrokerï¼Œä¾æ®topicæ¥è¿›è¡Œæ¶ˆæ¯çš„ä¸­è½¬ï¼Œåœ¨é‡topicçš„æ¶ˆæ¯é˜Ÿåˆ—é‡Œå¿…ç„¶éœ€è¦topicçš„å­˜åœ¨</p><p>è½»topicï¼šRabbitMQ<br>topicåªæ˜¯å…¶ä¸€ç§ä¸­è½¬æ¨¡å¼ã€‚</p><h4 id="2-2-2-æ— broker"><a href="#2-2-2-æ— broker" class="headerlink" title="2.2.2 æ— broker"></a>2.2.2 æ— broker</h4><p>åœ¨ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ä¹‹é—´æ²¡æœ‰ä½¿ç”¨brokerï¼Œä¾‹å¦‚zeroMQï¼Œç›´æ¥ä½¿ç”¨socketè¿›è¡Œé€šä¿¡</p><p>æ— brokerçš„MQä»£è¡¨æ˜¯ZeroMQï¼Œè¯¥ä½œè€…éå¸¸ç¿æ™ºï¼Œä»–éå¸¸æ•é”çš„æ„è¯†åˆ°â€“MQæ˜¯æ›´é«˜çº§çš„Socket</p><p>å®ƒæ˜¯è§£å†³é€šä¿¡é—®é¢˜çš„ã€‚æ‰€ä»¥ZeroMQè¢«è®¾è®¡æˆäº†ä¸€ä¸ªâ€œåº“â€è€Œä¸æ˜¯ä¸€ä¸ªä¸­é—´ä»¶ï¼Œè¿™ç§å®ç°ä¹Ÿå¯ä»¥è¾¾åˆ°â€“æ²¡æœ‰Brokerçš„ç›®çš„ã€‚</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linux%E6%97%A0broker.png" alt="æ— broker"></p><h2 id="ä¸‰ã€Kafkaçš„åŸºæœ¬çŸ¥è¯†"><a href="#ä¸‰ã€Kafkaçš„åŸºæœ¬çŸ¥è¯†" class="headerlink" title="ä¸‰ã€Kafkaçš„åŸºæœ¬çŸ¥è¯†"></a>ä¸‰ã€Kafkaçš„åŸºæœ¬çŸ¥è¯†</h2><p>Kafkaæ˜¯æœ€åˆç”±Linkedinå…¬å¸å¼€å‘ï¼Œæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼ã€æ”¯æŒåˆ†åŒºçš„ï¼ˆpartitionï¼‰ã€å¤šå‰¯æœ¬çš„ï¼ˆreplicaï¼‰ï¼ŒåŸºäºzookeeperåè°ƒçš„åˆ†å¸ƒå¼æ¶ˆæ¯ç³»ç»Ÿ.</p><p>å®ƒçš„æœ€å¤§çš„ç‰¹æ€§å°±æ˜¯å¯ä»¥å®æ—¶çš„å¤„ç†å¤§é‡æ•°æ®ä»¥æ»¡è¶³å„ç§éœ€æ±‚åœºæ™¯ï¼š</p><p>æ¯”å¦‚åŸºäºhadoopçš„æ‰¹å¤„ç†ç³»ç»Ÿã€ä½å»¶è¿Ÿçš„å®æ—¶ç³»ç»Ÿã€storm&#x2F;Sparkæµå¼å¤„ç†å¼•æ“ï¼Œweb&#x2F;nginxæ—¥å¿—ã€è®¿é—®æ—¥å¿—ï¼Œæ¶ˆæ¯æœåŠ¡ç­‰ç­‰ï¼Œç”¨scalaè¯­è¨€ç¼–å†™ï¼ŒLinkedinäº2010å¹´è´¡çŒ®ç»™äº†ApacheåŸºé‡‘ä¼šå¹¶æˆä¸ºé¡¶çº§å¼€æºé¡¹ç›®ã€‚</p><h3 id="3-1-Kafkaçš„ç‰¹æ€§"><a href="#3-1-Kafkaçš„ç‰¹æ€§" class="headerlink" title="3.1 Kafkaçš„ç‰¹æ€§:"></a>3.1 Kafkaçš„ç‰¹æ€§:</h3><p>é«˜ååé‡ã€ä½å»¶è¿Ÿï¼škafkaæ¯ç§’å¯ä»¥å¤„ç†å‡ åä¸‡æ¡æ¶ˆæ¯ï¼Œå®ƒçš„å»¶è¿Ÿæœ€ä½åªæœ‰å‡ æ¯«ç§’ï¼Œæ¯ä¸ªtopicå¯ä»¥åˆ†å¤šä¸ªpartition, consumer group å¯¹partitionè¿›è¡Œconsumeæ“ä½œã€‚</p><p>å¯æ‰©å±•æ€§ï¼škafkaé›†ç¾¤æ”¯æŒçƒ­æ‰©å±•</p><p>æŒä¹…æ€§ã€å¯é æ€§ï¼šæ¶ˆæ¯è¢«æŒä¹…åŒ–åˆ°æœ¬åœ°ç£ç›˜ï¼Œå¹¶ä¸”æ”¯æŒæ•°æ®å¤‡ä»½é˜²æ­¢æ•°æ®ä¸¢å¤±</p><p>å®¹é”™æ€§ï¼šå…è®¸é›†ç¾¤ä¸­èŠ‚ç‚¹å¤±è´¥ï¼ˆè‹¥å‰¯æœ¬æ•°é‡ä¸ºn,åˆ™å…è®¸n-1ä¸ªèŠ‚ç‚¹å¤±è´¥ï¼‰</p><p>é«˜å¹¶å‘ï¼šæ”¯æŒæ•°åƒä¸ªå®¢æˆ·ç«¯åŒæ—¶è¯»å†™</p><h3 id="3-2-Kafkaçš„ä½¿ç”¨åœºæ™¯"><a href="#3-2-Kafkaçš„ä½¿ç”¨åœºæ™¯" class="headerlink" title="3.2 Kafkaçš„ä½¿ç”¨åœºæ™¯"></a>3.2 Kafkaçš„ä½¿ç”¨åœºæ™¯</h3><p>æ—¥å¿—æ”¶é›†ï¼šä¸€ä¸ªå…¬å¸å¯ä»¥ç”¨Kafkaå¯ä»¥æ”¶é›†å„ç§æœåŠ¡çš„logï¼Œé€šè¿‡kafkaä»¥ç»Ÿä¸€æ¥å£æœåŠ¡çš„æ–¹å¼å¼€æ”¾ç»™å„ç§consumerï¼Œä¾‹å¦‚hadoopã€Hbaseã€Solrç­‰ã€‚</p><p>æ¶ˆæ¯ç³»ç»Ÿï¼šè§£è€¦å’Œç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ã€ç¼“å­˜æ¶ˆæ¯ç­‰ã€‚</p><p>ç”¨æˆ·æ´»åŠ¨è·Ÿè¸ªï¼šKafkaç»å¸¸è¢«ç”¨æ¥è®°å½•webç”¨æˆ·æˆ–è€…appç”¨æˆ·çš„å„ç§æ´»åŠ¨ï¼Œå¦‚æµè§ˆç½‘é¡µã€æœç´¢ã€ç‚¹å‡»ç­‰æ´»åŠ¨ï¼Œè¿™äº›æ´»åŠ¨ä¿¡æ¯è¢«å„ä¸ªæœåŠ¡å™¨å‘å¸ƒåˆ°kafkaçš„topicä¸­ï¼Œç„¶åè®¢é˜…è€…é€šè¿‡è®¢é˜…è¿™äº›topicæ¥åšå®æ—¶çš„ç›‘æ§åˆ†æï¼Œæˆ–è€…è£…è½½åˆ°hadoopã€æ•°æ®ä»“åº“ä¸­åšç¦»çº¿åˆ†æå’ŒæŒ–æ˜ã€‚</p><p>è¿è¥æŒ‡æ ‡ï¼šKafkaä¹Ÿç»å¸¸ç”¨æ¥è®°å½•è¿è¥ç›‘æ§æ•°æ®ã€‚åŒ…æ‹¬æ”¶é›†å„ç§åˆ†å¸ƒå¼åº”ç”¨çš„æ•°æ®ï¼Œç”Ÿäº§å„ç§æ“ä½œçš„é›†ä¸­åé¦ˆï¼Œæ¯”å¦‚æŠ¥è­¦å’ŒæŠ¥å‘Šã€‚</p><h3 id="3-2-åŸºæœ¬æ¦‚å¿µ"><a href="#3-2-åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="3.2 åŸºæœ¬æ¦‚å¿µ"></a>3.2 åŸºæœ¬æ¦‚å¿µ</h3><p>kafkaæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼çš„ï¼Œåˆ†åŒºçš„æ¶ˆæ¯(å®˜æ–¹ç§°ä¹‹ä¸ºcommit log)æœåŠ¡ã€‚å®ƒæä¾›ä¸€ä¸ªæ¶ˆæ¯ç³»ç»Ÿåº”è¯¥å…·å¤‡çš„åŠŸèƒ½ï¼Œä½†æ˜¯ç¡®æœ‰ç€ç‹¬ç‰¹çš„è®¾è®¡ã€‚</p><p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹åŸºç¡€çš„æ¶ˆæ¯(Message)ç›¸å…³æœ¯è¯­ï¼š</p><p>kafka ä¸­æœ‰è¿™ä¹ˆäº›å¤æ‚çš„æ¦‚å¿µ</p><table><thead><tr><th>åç§°</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td>Broker</td><td>æ¶ˆæ¯ä¸­é—´ä»¶å¤„ç†èŠ‚ç‚¹ï¼Œä¸€ä¸ªkafkaèŠ‚ç‚¹å°±æ˜¯ä¸€ä¸ªbrokerï¼Œä¸€ä¸ªæˆ–å¤šä¸ªBrokerå¯ä»¥ç»„æˆä¸€ä¸ªkafkaé›†ç¾¤</td></tr><tr><td>Topic</td><td>kafkaæ ¹æ®Topicå¯¹æ¶ˆæ¯è¿›è¡Œåˆ†ç±»ï¼Œå‘å¸ƒåˆ°kafkaé›†ç¾¤çš„æ¯æ¡æ¶ˆæ¯éƒ½éœ€è¦æŒ‡å®šä¸€ä¸ªTopic</td></tr><tr><td>Producer</td><td>æ¶ˆæ¯ç”Ÿäº§è€…ï¼Œå‘Brokerå‘é€æ¶ˆæ¯çš„å®¢æˆ·ç«¯</td></tr><tr><td>Consumer</td><td>æ¶ˆæ¯æ¶ˆè´¹è€…ï¼Œä»Brokerè¯»å–æ¶ˆæ¯çš„å®¢æˆ·ç«¯</td></tr><tr><td>ConsumerGroup</td><td>ä¸ªconsumerå±äºä¸€ä¸ªç‰¹å®šçš„Consumer Groupï¼Œä¸€æ¡æ¶ˆæ¯å¯ä»¥è¢«å¤šä¸ªä¸åŒçš„Consumeræ¶ˆè´¹ï¼Œä½†æ˜¯ä¸€ä¸ªConsumer Groupä¸­åªèƒ½æœ‰ä¸€ä¸ªconsumerèƒ½æ¶ˆè´¹è¯¥æ¶ˆæ¯</td></tr><tr><td>Partition</td><td>ç‰©ç†ä¸Šçš„æ¦‚å¿µï¼Œä¸€ä¸ªtopicå¯ä»¥åˆ†ä¸ºå¤šä¸ªpartitionï¼Œæ¯ä¸ªpartitionå†…éƒ¨æ¶ˆæ¯æ˜¯æœ‰åºçš„</td></tr></tbody></table><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linuxkafka%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5.png" alt="kafkaåŸºæœ¬æ¦‚å¿µ"></p><h3 id="3-3-åˆ›å»ºä¸»é¢˜topic"><a href="#3-3-åˆ›å»ºä¸»é¢˜topic" class="headerlink" title="3.3 åˆ›å»ºä¸»é¢˜topic"></a>3.3 åˆ›å»ºä¸»é¢˜topic</h3><p>topic kafkaæ¶ˆæ¯é€»è¾‘çš„åˆ’åˆ†</p><p>topicæ˜¯ä»€ä¹ˆæ¦‚å¿µ? topicå¯ä»¥å®ç°æ¶ˆæ¯çš„åˆ†ç±»ï¼Œä¸åŒæ¶ˆè´¹è€…è®¢é˜…ä¸åŒçš„topicã€‚</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linux20220111104851.png"></p><p>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤åˆ›å»ºåä¸ºâ€testâ€çš„topicï¼Œè¿™ä¸ªtopicåªæœ‰ä¸€ä¸ªpartitionï¼Œå¹¶ä¸”å¤‡ä»½å› å­ä¹Ÿè®¾ç½®ä¸º1;</p><figure class="highlight">  <figcaption>This is a code block</figcaption>  <pre><code class="language-shell">  ./kafka-topics.sh --create --zookeeper 172.16.253.35:2181 --replication-factor 1 --partitions 1 --topic test  </code></pre></figure><p>æŸ¥çœ‹å½“å‰kafkaå†…æœ‰å“ªäº›topic</p><figure class="highlight">  <figcaption>This is a code block</figcaption>  <pre><code class="language-shell">  ./ kafka-topics.sh --list --zookeeper 172.16.253.35:2181  </code></pre></figure><h3 id="3-4-å‘é€æ¶ˆæ¯"><a href="#3-4-å‘é€æ¶ˆæ¯" class="headerlink" title="3.4 å‘é€æ¶ˆæ¯"></a>3.4 å‘é€æ¶ˆæ¯</h3><p>kafkaè‡ªå¸¦äº†ä¸€ä¸ªproducerå‘½ä»¤å®¢æˆ·ç«¯ï¼Œå¯ä»¥ä»æœ¬åœ°æ–‡ä»¶ä¸­è¯»å–å†…å®¹ï¼Œæˆ–è€…æˆ‘ä»¬ä¹Ÿå¯ä»¥ä»¥å‘½ä»¤è¡Œä¸­ç›´æ¥è¾“å…¥å†…å®¹ï¼Œå¹¶å°†è¿™äº›å†…å®¹ä»¥æ¶ˆæ¯çš„å½¢å¼å‘é€åˆ°kafkaé›†ç¾¤ä¸­ã€‚åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯ä¸€ä¸ªè¡Œä¼šè¢«å½“åšæˆä¸€ä¸ªç‹¬ç«‹çš„æ¶ˆæ¯ã€‚</p><p>ä½¿ç”¨kafkaçš„å‘é€æ¶ˆæ¯çš„å®¢æˆ·ç«¯ï¼ŒæŒ‡å®šå‘é€åˆ°çš„kafkaæœåŠ¡å™¨åœ°å€å’Œtopic</p><figure class="highlight">  <figcaption>This is a code block</figcaption>  <pre><code class="language-shell">  ./kafka-console-producer.sh --broker-list 10.31.167.10:9092 --topic test  </code></pre></figure><h3 id="3-5-æ¶ˆè´¹æ¶ˆæ¯"><a href="#3-5-æ¶ˆè´¹æ¶ˆæ¯" class="headerlink" title="3.5 æ¶ˆè´¹æ¶ˆæ¯"></a>3.5 æ¶ˆè´¹æ¶ˆæ¯</h3><p>å¯¹äºconsumer, kafkaåŒæ ·ä¹Ÿæºå¸¦äº†ä¸€ä¸ªå‘½ä»¤è¡Œå®¢æˆ·ç«¯ï¼Œä¼šå°†è·å–åˆ°å†…å®¹åœ¨å‘½ä»¤ä¸­è¿›è¡Œè¾“å‡ºï¼Œé»˜è®¤æ˜¯æ¶ˆè´¹æœ€æ–°çš„æ¶ˆæ¯ã€‚ä½¿ç”¨kafkaçš„æ¶ˆè´¹è€…æ¶ˆæ¯çš„å®¢æˆ·ç«¯ï¼Œä»æŒ‡å®škafkaæœåŠ¡å™¨çš„æŒ‡å®štopicä¸­æ¶ˆè´¹æ¶ˆæ¯</p><p>æ–¹å¼ä¸€:ä»å½“å‰ä¸»é¢˜ä¸­æœ€åä¸€æ¡æ¶ˆæ¯çš„offsetï¼ˆåç§»é‡ï¼‰+1å¼€å§‹æ¶ˆè´¹</p><figure class="highlight">  <figcaption>This is a code block</figcaption>  <pre><code class="language-shell">  ./kafka-console-consumer.sh --bootstrap-server 10.31.167.10:9092 --topic test  </code></pre></figure><p>æ–¹å¼äºŒâˆ¶ä»å½“å‰ä¸»é¢˜ä¸­çš„ç¬¬ä¸€æ¡æ¶ˆæ¯å¼€å§‹æ¶ˆè´¹</p><figure class="highlight">  <figcaption>This is a code block</figcaption>  <pre><code class="language-shell">  ./kafxa-console-consumer.sh --bootstrap-server 10.31.167.10:9092 --from-beginning --topic test  </code></pre></figure><h3 id="3-6-å…³äºæ¶ˆæ¯çš„ç»†èŠ‚"><a href="#3-6-å…³äºæ¶ˆæ¯çš„ç»†èŠ‚" class="headerlink" title="3.6 å…³äºæ¶ˆæ¯çš„ç»†èŠ‚"></a>3.6 å…³äºæ¶ˆæ¯çš„ç»†èŠ‚</h3><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linuxkafka%E6%B6%88%E8%B4%B9%E7%BB%86%E8%8A%82.png"></p><p>ç”Ÿäº§è€…å°†æ¶ˆæ¯å‘é€ç»™brokerï¼Œbrokerä¼šå°†æ¶ˆæ¯ä¿å­˜åœ¨æœ¬åœ°çš„æ—¥å¿—æ–‡ä»¶ä¸­</p><p><code>/usr/ local/kafka/data/kafka-logs/ä¸»é¢˜-åˆ†åŒº/0000000o.log</code></p><p>æ¶ˆæ¯çš„ä¿å­˜æ˜¯æœ‰åºçš„ï¼Œé€šè¿‡offsetåç§»é‡æ¥æè¿°æ¶ˆæ¯çš„æœ‰åºæ€§</p><p>æ¶ˆè´¹è€…æ¶ˆè´¹æ¶ˆæ¯æ—¶ä¹Ÿæ˜¯é€šè¿‡offsetæ¥æè¿°å½“å‰è¦æ¶ˆè´¹çš„é‚£æ¡æ¶ˆæ¯çš„ä½ç½®</p><h3 id="3-7-å•æ’­æ¶ˆæ¯"><a href="#3-7-å•æ’­æ¶ˆæ¯" class="headerlink" title="3.7 å•æ’­æ¶ˆæ¯"></a>3.7 å•æ’­æ¶ˆæ¯</h3><p>åœ¨ä¸€ä¸ªkafkaçš„topicä¸­ï¼Œå¯åŠ¨ä¸¤ä¸ªæ¶ˆè´¹è€…ï¼Œä¸€ä¸ªç”Ÿäº§è€…ï¼Œé—®:ç”Ÿäº§è€…å‘é€æ¶ˆæ¯ï¼Œè¿™æ¡æ¶ˆæ¯æ˜¯å¦åŒæ—¶ä¼šè¢«ä¸¤ä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹?</p><p>å¦‚æœå¤šä¸ªæ¶ˆè´¹è€…åœ¨åŒä¸€ä¸ªæ¶ˆè´¹ç»„ï¼Œé‚£ä¹ˆåªæœ‰ä¸€ä¸ªæ¶ˆè´¹è€…å¯ä»¥æ”¶åˆ°è®¢é˜…çš„topicä¸­çš„æ¶ˆæ¯ã€‚æ¢è¨€ä¹‹ï¼ŒåŒä¸€ä¸ªæ¶ˆè´¹ç»„ä¸­åªèƒ½æœ‰ä¸€ä¸ªæ¶ˆè´¹è€…æ”¶åˆ°ä¸€ä¸ªtopicä¸­çš„æ¶ˆæ¯ã€‚</p><figure class="highlight">  <figcaption>This is a code block</figcaption>  <pre><code class="language-shell">  ./kafka-console-consumer.sh --bootstrap-server 172.16.253.38:9092--consumer-property group.id=testGroup --topic test  </code></pre></figure><h3 id="3-8-å¤šæ’­æ¶ˆæ¯"><a href="#3-8-å¤šæ’­æ¶ˆæ¯" class="headerlink" title="3.8 å¤šæ’­æ¶ˆæ¯"></a>3.8 å¤šæ’­æ¶ˆæ¯</h3><p>ä¸åŒçš„æ¶ˆè´¹ç»„è®¢é˜…åŒä¸€ä¸ªtopicï¼Œé‚£ä¹ˆä¸åŒçš„æ¶ˆè´¹ç»„ä¸­åªæœ‰ä¸€ä¸ªæ¶ˆè´¹è€…èƒ½æ”¶åˆ°æ¶ˆæ¯ã€‚å®é™…ä¸Šä¹Ÿæ˜¯å¤šä¸ªæ¶ˆè´¹ç»„ä¸­çš„å¤šä¸ªæ¶ˆè´¹è€…æ”¶åˆ°äº†åŒä¸€ä¸ªæ¶ˆæ¯ã€‚</p><figure class="highlight">  <figcaption>This is a code block</figcaption>  <pre><code class="language-shell">  ./kafka-console-consumer.sh --bootstrap-server 172.16.253.38:9092--consumer-property group.id=testGroupl --topic test  </code></pre></figure><figure class="highlight">  <figcaption>This is a code block</figcaption>  <pre><code class="language-shell">  ./kafka-console-consumer.sh --bootstrap-server 172.16.253.38:9092--consumer-property group.id=testGroup2 --topic test  </code></pre></figure><p>ä¸‹å›¾å°±æ˜¯æè¿°å¤šæ’­å’Œå•æ’­æ¶ˆæ¯çš„åŒºåˆ«:</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linuxkafka%E5%A4%9A%E6%92%AD%E4%B8%8E%E5%8D%95%E6%92%AD%E6%B6%88%E6%81%AF%E7%9A%84%E5%8C%BA%E5%88%AB.png"></p><h3 id="3-9-æŸ¥çœ‹æ¶ˆè´¹ç»„çš„è¯¦ç»†ä¿¡æ¯"><a href="#3-9-æŸ¥çœ‹æ¶ˆè´¹ç»„çš„è¯¦ç»†ä¿¡æ¯" class="headerlink" title="3.9 æŸ¥çœ‹æ¶ˆè´¹ç»„çš„è¯¦ç»†ä¿¡æ¯"></a>3.9 æŸ¥çœ‹æ¶ˆè´¹ç»„çš„è¯¦ç»†ä¿¡æ¯</h3><p>é€šè¿‡ä»¥ä¸‹å‘½ä»¤å¯ä»¥æŸ¥çœ‹åˆ°æ¶ˆè´¹ç»„çš„è¯¦ç»†ä¿¡æ¯ï¸°</p><figure class="highlight">  <figcaption>This is a code block</figcaption>  <pre><code class="language-shell">  ./kafka-consumer-groups.sh --bootstrap-server 172.16.253.38:9092 --describe --group testGroup  </code></pre></figure><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linuxkafka%E6%9F%A5%E7%9C%8B%E6%B6%88%E8%B4%B9%E7%BB%84%E8%AF%A6%E7%BB%86%E4%BF%A1%E6%81%AF.png"></p><p>é‡ç‚¹å…³æ³¨ä»¥ä¸‹å‡ ä¸ªä¿¡æ¯âˆ¶</p><ul><li>current-offset:æœ€åè¢«æ¶ˆè´¹çš„æ¶ˆæ¯çš„åç§»é‡</li><li>Log-end-offset:æ¶ˆæ¯æ€»é‡(æœ€åä¸€æ¡æ¶ˆæ¯çš„åç§»é‡)</li><li>Lag:ç§¯å‹äº†å¤šå°‘æ¡æ¶ˆæ¯</li></ul><h2 id="å››ã€Kafka-ä¸­ä¸»é¢˜å’Œåˆ†åŒºçš„æ¦‚å¿µ"><a href="#å››ã€Kafka-ä¸­ä¸»é¢˜å’Œåˆ†åŒºçš„æ¦‚å¿µ" class="headerlink" title="å››ã€Kafka ä¸­ä¸»é¢˜å’Œåˆ†åŒºçš„æ¦‚å¿µ"></a>å››ã€Kafka ä¸­ä¸»é¢˜å’Œåˆ†åŒºçš„æ¦‚å¿µ</h2><h3 id="4-1-ä¸»é¢˜Topic"><a href="#4-1-ä¸»é¢˜Topic" class="headerlink" title="4.1 ä¸»é¢˜Topic"></a>4.1 ä¸»é¢˜Topic</h3><p>ä¸»é¢˜-topicåœ¨kafkaä¸­æ˜¯ä¸€ä¸ªé€»è¾‘çš„æ¦‚å¿µï¼Œkafkaé€šè¿‡topicå°†æ¶ˆæ¯è¿›è¡Œåˆ†ç±»ã€‚ä¸åŒçš„topicä¼šè¢«è®¢é˜…è¯¥topicçš„æ¶ˆè´¹è€…æ¶ˆè´¹ã€‚</p><p>ä½†æ˜¯æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœè¯´è¿™ä¸ªtopicä¸­çš„æ¶ˆæ¯éå¸¸éå¸¸å¤šï¼Œå¤šåˆ°éœ€è¦å‡ Tæ¥å­˜ï¼Œå› ä¸ºæ¶ˆæ¯æ˜¯ä¼šè¢«ä¿å­˜åˆ°logæ—¥å¿—æ–‡ä»¶ä¸­çš„ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªæ–‡ä»¶è¿‡å¤§çš„é—®é¢˜, kafkaæå‡ºäº†Partitionåˆ†åŒºçš„æ¦‚å¿µ</p><h3 id="4-2-partition-åˆ†åŒº"><a href="#4-2-partition-åˆ†åŒº" class="headerlink" title="4.2 partition åˆ†åŒº"></a>4.2 partition åˆ†åŒº</h3><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linuxkafka%E5%88%86%E5%8C%BA.png"></p><p>1)åˆ†åŒºçš„æ¦‚å¿µ</p><p>é€šè¿‡partitionå°†ä¸€ä¸ªtopicä¸­çš„æ¶ˆæ¯åˆ†åŒºæ¥å­˜å‚¨ã€‚</p><p>è¿™æ ·çš„å¥½å¤„æœ‰å¤šä¸ª:</p><ul><li><p>åˆ†åŒºå­˜å‚¨ï¼Œå¯ä»¥è§£å†³ç»Ÿä¸€å­˜å‚¨æ–‡ä»¶è¿‡å¤§çš„é—®é¢˜</p></li><li><p>æä¾›äº†è¯»å†™çš„ååé‡:è¯»å’Œå†™å¯ä»¥åŒæ—¶åœ¨å¤šä¸ªåˆ†åŒºä¸­è¿›è¡Œ</p></li></ul><p>2)åˆ›å»ºå¤šåˆ†åŒºçš„ä¸»é¢˜</p><figure class="highlight">  <figcaption>This is a code block</figcaption>  <pre><code class="language-shell">  ./kafka-topics.sh --create --zokeeper 172.16.253.35:2181 --replication-factor l --partitions 2 --topic test1  </code></pre></figure><h3 id="4-3-kafka-ä¸­æ¶ˆæ¯æ—¥å¿—æ–‡ä»¶ä¸­ä¿å­˜çš„å†…å®¹"><a href="#4-3-kafka-ä¸­æ¶ˆæ¯æ—¥å¿—æ–‡ä»¶ä¸­ä¿å­˜çš„å†…å®¹" class="headerlink" title="4.3 kafka ä¸­æ¶ˆæ¯æ—¥å¿—æ–‡ä»¶ä¸­ä¿å­˜çš„å†…å®¹"></a>4.3 kafka ä¸­æ¶ˆæ¯æ—¥å¿—æ–‡ä»¶ä¸­ä¿å­˜çš„å†…å®¹</h3><p><code>. 00000.log</code>:è¿™ä¸ªæ–‡ä»¶ä¸­ä¿å­˜çš„å°±æ˜¯æ¶ˆæ¯<br>_consumer_offsets-49</p><p>kafkaå†…éƒ¨è‡ªå·±åˆ›å»ºäº†_consumer_offsetsä¸»é¢˜åŒ…å«äº†50ä¸ªåˆ†åŒºã€‚è¿™ä¸ªä¸»é¢˜ç”¨æ¥å­˜æ”¾æ¶ˆè´¹è€…æ¶ˆè´¹æŸä¸ªä¸»é¢˜çš„åç§»é‡ã€‚</p><p>å› ä¸ºæ¯ä¸ªæ¶ˆè´¹è€…éƒ½ä¼šè‡ªå·±ç»´æŠ¤ç€æ¶ˆè´¹çš„ä¸»é¢˜çš„åç§»é‡ï¼Œä¹Ÿå°±æ˜¯è¯´æ¯ä¸ªæ¶ˆè´¹è€…ä¼šæŠŠæ¶ˆè´¹çš„ä¸»é¢˜çš„åç§»é‡è‡ªä¸»ä¸ŠæŠ¥ç»™kafkaä¸­çš„é»˜è®¤ä¸»é¢˜consumer_offsetsã€‚å› æ­¤kafkaä¸ºäº†æå‡è¿™ä¸ªä¸»é¢˜çš„å¹¶å‘æ€§ï¼Œé»˜è®¤è®¾ç½®äº†50ä¸ªåˆ†åŒºã€‚(å¯ä»¥é€šè¿‡offsets.topic.num.paritionsè®¾ç½®)ï¼Œè¿™æ ·å¯ä»¥é€šè¿‡åŠ æœºå™¨çš„æ–¹å¼æŠ—å¤§å¹¶å‘ã€‚</p><ul><li><p>æäº¤åˆ°å“ªä¸ªåˆ†åŒºï¸°é€šè¿‡hashå‡½æ•°: hash(consumerGroupld) %_consumer_offsetsä¸»é¢˜çš„åˆ†åŒºæ•°</p></li><li><p>æäº¤åˆ°è¯¥ä¸»é¢˜ä¸­çš„å†…å®¹æ˜¯: keyæ˜¯consumerGroupld+topic+åˆ†åŒºå·ï¼Œvalueå°±æ˜¯å½“å‰offsetçš„å€¼</p></li><li><p>æ–‡ä»¶ä¸­ä¿å­˜çš„æ¶ˆæ¯ï¼Œkafkaä¼šå®šæœŸæ¸…ç†topicé‡Œçš„æ¶ˆæ¯ï¼Œæœ€åå°±ä¿ç•™æœ€æ–°çš„é‚£æ¡æ•°æ®é»˜è®¤ä¿å­˜7å¤©ã€‚ä¸ƒå¤©åˆ°åæ¶ˆæ¯ä¼šè¢«åˆ é™¤ã€‚</p></li></ul><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linuxkafka-offsets50%E9%BB%98%E8%AE%A4%E4%B8%BB%E9%A2%98.png"></p><h2 id="äº”ã€Kafkaé›†ç¾¤æ“ä½œ"><a href="#äº”ã€Kafkaé›†ç¾¤æ“ä½œ" class="headerlink" title="äº”ã€Kafkaé›†ç¾¤æ“ä½œ"></a>äº”ã€Kafkaé›†ç¾¤æ“ä½œ</h2><h3 id="5-1-æ­å»ºkafkaé›†ç¾¤ï¼ˆä¸‰ä¸ªbrokerï¼‰"><a href="#5-1-æ­å»ºkafkaé›†ç¾¤ï¼ˆä¸‰ä¸ªbrokerï¼‰" class="headerlink" title="5.1 æ­å»ºkafkaé›†ç¾¤ï¼ˆä¸‰ä¸ªbrokerï¼‰"></a>5.1 æ­å»ºkafkaé›†ç¾¤ï¼ˆä¸‰ä¸ªbrokerï¼‰</h3><p>åˆ›å»ºä¸‰ä¸ª<code>server.properties</code>æ–‡ä»¶</p><figure class="highlight">  <figcaption>This is a code block</figcaption>  <pre><code class="language-shell">  \#0 1 2  broker.id=2  <p>  #9092 9093 9094<br>  listeners&#x3D;PLAINTEXT :&#x2F;&#x2F;192.168.65.60:9094  </p><p>  #kafka-logs kafka-logs-1 kafka-logs-2<br>  log.dir&#x3D;&#x2F;usr&#x2F; local&#x2F; data&#x2F; kafka-logs-2<br>  </p></code></pre><p></p></figure><p>é€šè¿‡å‘½ä»¤æ¥å¯åŠ¨ä¸‰å°broker</p><figure class="highlight">  <figcaption>This is a code block</figcaption>  <pre><code class="language-shell">  ./ kafka-server-start.sh -daemon ../config/server.properties  ./ kafka-server-start.sh -daemon ../config/server1.properties  ./ kafka-server-start.sh -daemon ../config/server2.properties  </code></pre></figure><p>æ ¡éªŒæ˜¯å¦å¯åŠ¨æˆåŠŸ</p><p><code>è¿›å…¥åˆ°zkä¸­æŸ¥çœ‹/brokers/idsä¸­è¿‡æ˜¯å¦æœ‰ä¸‰ä¸ªznode (0,1,2)</code></p><h3 id="5-2-å‰¯æœ¬çš„æ¦‚å¿µ"><a href="#5-2-å‰¯æœ¬çš„æ¦‚å¿µ" class="headerlink" title="5.2 å‰¯æœ¬çš„æ¦‚å¿µ"></a>5.2 å‰¯æœ¬çš„æ¦‚å¿µ</h3><p>åœ¨åˆ›å»ºä¸»é¢˜æ—¶ï¼Œé™¤äº†æŒ‡æ˜äº†ä¸»é¢˜çš„åˆ†åŒºæ•°ä»¥å¤–ï¼Œè¿˜æŒ‡æ˜äº†å‰¯æœ¬æ•°ï¼Œé‚£ä¹ˆå‰¯æœ¬æ˜¯ä¸€ä¸ªä»€ä¹ˆæ¦‚å¿µå‘¢?</p><p>å‰¯æœ¬æ˜¯ä¸ºäº†ä¸ºä¸»é¢˜ä¸­çš„åˆ†åŒºåˆ›å»ºå¤šä¸ªå¤‡ä»½ï¼Œå¤šä¸ªå‰¯æœ¬åœ¨kafkaé›†ç¾¤çš„å¤šä¸ªbrokerä¸­ï¼Œä¼šæœ‰ä¸€ä¸ªå‰¯æœ¬ä½œä¸ºleaderï¼Œå…¶ä»–æ˜¯followerã€‚ ç”Ÿäº§è€…ä¸æ¶ˆè´¹è€…åªä¼šä¸leaderäº¤äº’æ¶ˆæ¯ï¼Œè€Œfolloweråªä¼šä¸leaderä¿æŒåŒæ­¥ä»¥å¤‡ä¸æ—¶ä¹‹éœ€ã€‚</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linuxkafka%E5%89%AF%E6%9C%AC%E6%A6%82%E5%BF%B5.png"></p><ul><li><p>leader: kafkaçš„å†™å’Œè¯»çš„æ“ä½œï¼Œéƒ½å‘ç”Ÿåœ¨leaderä¸Šã€‚leaderè´Ÿè´£æŠŠæ•°æ®åŒæ­¥ç»™followerã€‚å½“leaderæŒ‚äº†ï¼Œç»è¿‡ä¸»ä»é€‰ä¸¾ï¼Œä»å¤šä¸ªfollowerä¸­é€‰ä¸¾äº§ç”Ÿä¸€ä¸ªæ–°çš„leader</p></li><li><p>followerï¼š æ¥æ”¶leaderçš„åŒæ­¥çš„æ•°æ®</p></li><li><p>isr: å¯ä»¥åŒæ­¥å’Œå·²åŒæ­¥çš„èŠ‚ç‚¹ä¼šè¢«å­˜å…¥åˆ°isré›†åˆä¸­ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªç»†èŠ‚ï¸°å¦‚æœisrä¸­çš„èŠ‚ç‚¹æ€§èƒ½è¾ƒå·®ï¼Œä¼šè¢«æå‡ºisré›†åˆã€‚)</p></li></ul><p><strong>ç†è§£:</strong> é›†ç¾¤ä¸­æœ‰å¤šä¸ªbrokerï¼Œåˆ›å»ºä¸»é¢˜æ—¶å¯ä»¥æŒ‡æ˜ä¸»é¢˜æœ‰å¤šä¸ªåˆ†åŒº(æŠŠæ¶ˆæ¯æ‹†åˆ†åˆ°ä¸åŒçš„åˆ†åŒºä¸­å­˜å‚¨)ï¼Œå¯ä»¥ä¸ºåˆ†åŒºåˆ›å»ºå¤šä¸ªå‰¯æœ¬ï¼Œä¸åŒçš„å‰¯æœ¬å­˜æ”¾åœ¨ä¸åŒçš„brokeré‡Œã€‚</p><h3 id="5-3-å…³äºé›†ç¾¤æ¶ˆè´¹"><a href="#5-3-å…³äºé›†ç¾¤æ¶ˆè´¹" class="headerlink" title="5.3 å…³äºé›†ç¾¤æ¶ˆè´¹"></a>5.3 å…³äºé›†ç¾¤æ¶ˆè´¹</h3><p>å‘é›†ç¾¤å‘é€æ¶ˆæ¯âˆ¶</p><figure class="highlight">  <figcaption>This is a code block</figcaption>  <pre><code class="language-shell">  ./kafka-console-consumer . sh --bootstrap-server 172.16.253.38:9092,172.16.253.38:9093,172.16.253.38:9094 --from-beginning --consumer-property group.id=testGroupl --topic my-replicated-topic  </code></pre></figure><p>ä»é›†ç¾¤ä¸­æ¶ˆè´¹æ¶ˆæ¯</p><figure class="highlight">  <figcaption>This is a code block</figcaption>  <pre><code class="language-shell">  ./kafka-console-producer .sh --broker-list 172.16.253.38:9092,172.16.253.38:9093,172.16.253.38:9094 --topicmy-replicated-topic  </code></pre></figure><p>æŒ‡å®šæ¶ˆè´¹ç»„æ¥æ¶ˆè´¹æ¶ˆæ¯</p><figure class="highlight">  <figcaption>This is a code block</figcaption>  <pre><code class="language-shell">  ./kafka-console-consumer .sh --bootstrap-server 172.16.253.38âˆ¶9092,172.16.253.38:9093,172.16.253.38:9094 --from-beginning --consumer-property group.id=testGroupl --topic my-replicated-topic  </code></pre></figure><h3 id="5-4-åˆ†åŒºåˆ†æ¶ˆè´¹ç»„çš„é›†ç¾¤æ¶ˆè´¹ä¸­çš„ç»†èŠ‚"><a href="#5-4-åˆ†åŒºåˆ†æ¶ˆè´¹ç»„çš„é›†ç¾¤æ¶ˆè´¹ä¸­çš„ç»†èŠ‚" class="headerlink" title="5.4 åˆ†åŒºåˆ†æ¶ˆè´¹ç»„çš„é›†ç¾¤æ¶ˆè´¹ä¸­çš„ç»†èŠ‚"></a>5.4 åˆ†åŒºåˆ†æ¶ˆè´¹ç»„çš„é›†ç¾¤æ¶ˆè´¹ä¸­çš„ç»†èŠ‚</h3><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linuxkafka%E5%88%86%E5%8C%BA%E5%88%86%E6%B6%88%E8%B4%B9%E7%BB%84%E7%9A%84%E9%9B%86%E7%BE%A4%E6%B6%88%E8%B4%B9%E4%B8%AD%E7%9A%84%E7%BB%86%E8%8A%82.png"></p><ol><li>ä¸€ä¸ªpartitionåªèƒ½è¢«ä¸€ä¸ªæ¶ˆè´¹ç»„ä¸­çš„ä¸€ä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹ï¼Œç›®çš„æ˜¯ä¸ºäº†ä¿è¯æ¶ˆè´¹çš„é¡ºåºæ€§ï¼Œä½†æ˜¯å¤šä¸ªpartionçš„å¤šä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹çš„æ€»çš„é¡ºåºæ€§æ˜¯å¾—ä¸åˆ°ä¿è¯çš„ï¼Œé‚£æ€ä¹ˆåšåˆ°æ¶ˆè´¹çš„æ€»é¡ºåºæ€§å‘¢?</li><li>partitionçš„æ•°é‡å†³å®šäº†æ¶ˆè´¹ç»„ä¸­æ¶ˆè´¹è€…çš„æ•°é‡ï¼Œå»ºè®®åŒä¸€ä¸ªæ¶ˆè´¹ç»„ä¸­æ¶ˆè´¹è€…çš„æ•°é‡ä¸è¦è¶…è¿‡partitionçš„æ•°é‡ï¼Œå¦åˆ™å¤šçš„æ¶ˆè´¹è€…æ¶ˆè´¹ä¸åˆ°æ¶ˆæ¯</li><li>å¦‚æœæ¶ˆè´¹è€…æŒ‚äº†ï¼Œé‚£ä¹ˆä¼šè§¦å‘rebalanceæœºåˆ¶ï¼ˆåé¢ä»‹ç»)ï¼Œä¼šè®©å…¶ä»–æ¶ˆè´¹è€…æ¥æ¶ˆè´¹è¯¥åˆ†åŒº</li></ol><h2 id="å…­ã€ä¸“é¢˜1-Kafka-é›†ç¾¤Controller-ã€Rebalance-å’ŒHW"><a href="#å…­ã€ä¸“é¢˜1-Kafka-é›†ç¾¤Controller-ã€Rebalance-å’ŒHW" class="headerlink" title="å…­ã€ä¸“é¢˜1 Kafka é›†ç¾¤Controller ã€Rebalance å’ŒHW"></a>å…­ã€ä¸“é¢˜1 Kafka é›†ç¾¤Controller ã€Rebalance å’ŒHW</h2><h3 id="6-1-controller"><a href="#6-1-controller" class="headerlink" title="6.1 controller"></a>6.1 controller</h3><p>é›†ç¾¤ä¸­è°æ¥å……å½“controller</p><ol><li><p>æ¯ä¸ªbrokerå¯åŠ¨æ—¶ä¼šå‘zkåˆ›å»ºä¸€ä¸ªä¸´æ—¶åºå·èŠ‚ç‚¹ï¼Œè·å¾—çš„åºå·æœ€å°çš„é‚£ä¸ªbrokerå°†ä¼šä½œä¸ºé›†ç¾¤ä¸­çš„controllerï¼Œè´Ÿè´£è¿™ä¹ˆå‡ ä»¶äº‹:</p></li><li><p>å½“é›†ç¾¤ä¸­æœ‰ä¸€ä¸ªå‰¯æœ¬çš„leaderæŒ‚æ‰ï¼Œéœ€è¦åœ¨é›†ç¾¤ä¸­é€‰ä¸¾å‡ºä¸€ä¸ªæ–°çš„leaderï¼Œé€‰ä¸¾çš„è§„åˆ™æ˜¯ä»isré›†åˆä¸­æœ€å·¦è¾¹è·å¾—ã€‚</p></li><li><p>å½“é›†ç¾¤ä¸­æœ‰brokeræ–°å¢æˆ–å‡å°‘ï¼Œcontrollerä¼šåŒæ­¥ä¿¡æ¯ç»™å…¶ä»–broker</p></li></ol><h3 id="6-2-rebalanceæœºåˆ¶"><a href="#6-2-rebalanceæœºåˆ¶" class="headerlink" title="6.2 rebalanceæœºåˆ¶"></a>6.2 rebalanceæœºåˆ¶</h3><p>**å‰æ:**æ¶ˆè´¹ç»„ä¸­çš„æ¶ˆè´¹è€…æ²¡æœ‰æŒ‡æ˜åˆ†åŒºæ¥æ¶ˆè´¹</p><p>**è§¦å‘çš„æ¡ä»¶:**å½“æ¶ˆè´¹ç»„ä¸­çš„æ¶ˆè´¹è€…å’Œåˆ†åŒºçš„å…³ç³»å‘ç”Ÿå˜åŒ–çš„æ—¶å€™</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linuxkafka-rebalance%E6%9C%BA%E5%88%B6.png"></p><p>**åˆ†åŒºåˆ†é…çš„ç­–ç•¥:**åœ¨rebalanceä¹‹å‰ï¼Œ åˆ†åŒºæ€ä¹ˆåˆ†é…ä¼šæœ‰è¿™ä¹ˆä¸‰ç§ç­–ç•¥</p><ul><li><p>range: æ ¹æ®å…¬ç¤ºè®¡ç®—å¾—åˆ°æ¯ä¸ªæ¶ˆè´¹æ¶ˆè´¹å“ªå‡ ä¸ªåˆ†åŒº:å‰é¢çš„æ¶ˆè´¹è€…æ˜¯åˆ†åŒºæ€»æ•°&#x2F;æ¶ˆè´¹<br>è€…æ•°é‡+1,ä¹‹åçš„æ¶ˆè´¹è€…æ˜¯åˆ†åŒºæ€»æ•°&#x2F;æ¶ˆè´¹è€…æ•°é‡.</p></li><li><p>è½®è¯¢:å¤§å®¶è½®ç€æ¥</p></li><li><p>sticky: ç²˜åˆç­–ç•¥ï¼Œå¦‚æœéœ€è¦rebalance, ä¼šåœ¨ä¹‹å‰å·²åˆ†é…çš„åŸºç¡€ä¸Šè°ƒæ•´ï¼Œä¸ä¼šæ”¹å˜ä¹‹å‰çš„åˆ†é…æƒ…å†µã€‚å¦‚æœè¿™ä¸ªç­–ç•¥æ²¡æœ‰å¼€ï¼Œé‚£ä¹ˆå°±è¦è¿›è¡Œå…¨éƒ¨çš„é‡æ–°åˆ†é…ã€‚å»ºè®®å¼€å¯ã€‚</p></li></ul><h2 id="ä¸ƒã€ä¸“é¢˜2-Kafkaä¸­çš„ä¼˜åŒ–é—®é¢˜-é¢è¯•é—®é¢˜"><a href="#ä¸ƒã€ä¸“é¢˜2-Kafkaä¸­çš„ä¼˜åŒ–é—®é¢˜-é¢è¯•é—®é¢˜" class="headerlink" title="ä¸ƒã€ä¸“é¢˜2 Kafkaä¸­çš„ä¼˜åŒ–é—®é¢˜(é¢è¯•é—®é¢˜)"></a>ä¸ƒã€ä¸“é¢˜2 Kafkaä¸­çš„ä¼˜åŒ–é—®é¢˜(é¢è¯•é—®é¢˜)</h2><h3 id="7-1-å¦‚ä½•é˜²æ­¢æ¶ˆæ¯ä¸¢å¤±"><a href="#7-1-å¦‚ä½•é˜²æ­¢æ¶ˆæ¯ä¸¢å¤±" class="headerlink" title="7.1 å¦‚ä½•é˜²æ­¢æ¶ˆæ¯ä¸¢å¤±"></a>7.1 å¦‚ä½•é˜²æ­¢æ¶ˆæ¯ä¸¢å¤±</h3><p>â½£äº§è€…ï¼š</p><ol><li>ä½¿â½¤åŒæ­¥å‘é€</li><li>æŠŠackè®¾æˆ1ï¼ˆleader æˆåŠŸå†™å…¥ï¼‰æˆ–è€…all(æ‰€æœ‰brokerå®ŒæˆåŒæ­¥)ï¼Œå¹¶ä¸”è®¾ç½®åŒæ­¥çš„åˆ†åŒºæ•°&gt;&#x3D;2<br>æ¶ˆè´¹è€…ï¼šæŠŠâ¾ƒåŠ¨æäº¤æ”¹æˆâ¼¿åŠ¨æäº¤</li></ol><h3 id="7-2å¦‚ä½•é˜²â½Œé‡å¤æ¶ˆè´¹"><a href="#7-2å¦‚ä½•é˜²â½Œé‡å¤æ¶ˆè´¹" class="headerlink" title="7.2å¦‚ä½•é˜²â½Œé‡å¤æ¶ˆè´¹"></a>7.2å¦‚ä½•é˜²â½Œé‡å¤æ¶ˆè´¹</h3><p>åœ¨é˜²â½Œæ¶ˆæ¯ä¸¢å¤±çš„â½…æ¡ˆä¸­ï¼Œå¦‚æœâ½£äº§è€…å‘é€å®Œæ¶ˆæ¯åï¼Œå› ä¸ºâ½¹ç»œæŠ–åŠ¨ï¼Œæ²¡æœ‰æ”¶åˆ°ackï¼Œä½†å®é™… ä¸Šbrokerå·²ç»æ”¶åˆ°äº†ã€‚</p><p>æ­¤æ—¶â½£äº§è€…ä¼šè¿›â¾é‡è¯•ï¼Œäºæ˜¯brokerå°±ä¼šæ”¶åˆ°å¤šæ¡ç›¸åŒçš„æ¶ˆæ¯ï¼Œâ½½é€ æˆæ¶ˆè´¹è€…çš„é‡å¤æ¶ˆè´¹ã€‚</p><p><strong>æ€ä¹ˆè§£å†³ï¼š</strong></p><p>â½£äº§è€…å…³é—­é‡è¯•ï¼šä¼šé€ æˆä¸¢æ¶ˆæ¯ï¼ˆä¸å»ºè®®ï¼‰</p><p>æ¶ˆè´¹è€…è§£å†³â¾®å¹‚ç­‰æ€§æ¶ˆè´¹é—®é¢˜ï¼š æ‰€è°“çš„å¹‚ç­‰æ€§ï¼šå¤šæ¬¡è®¿é—®çš„ç»“æœæ˜¯â¼€æ ·çš„ã€‚</p><p>å¯¹äºrestçš„è¯·æ±‚ï¼ˆgetï¼ˆå¹‚ç­‰ï¼‰ã€postï¼ˆâ¾®å¹‚ ç­‰ï¼‰ã€putï¼ˆå¹‚ç­‰ï¼‰ã€deleteï¼ˆå¹‚ç­‰ï¼‰ï¼‰</p><p>å¹‚ç­‰ï¼šå¤šæ¬¡è®¿é—®çš„ç»“æœæ˜¯ä¸€æ ·çš„</p><p><strong>è§£å†³â½…æ¡ˆï¼š</strong><br>åœ¨æ•°æ®åº“ä¸­åˆ›å»ºè”åˆä¸»é”®ï¼Œé˜²â½Œç›¸åŒçš„ä¸»é”® åˆ›å»ºå‡ºå¤šæ¡è®°å½•<br>ä½¿â½¤åˆ†å¸ƒå¼é”ï¼Œä»¥ä¸šåŠ¡idä¸ºé”ã€‚ä¿è¯åªæœ‰â¼€æ¡è®°å½•èƒ½å¤Ÿåˆ›å»ºæˆåŠŸ</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linuxkafka%E5%A6%82%E4%BD%95%E9%98%B2%E2%BD%8C%E9%87%8D%E5%A4%8D%E6%B6%88%E8%B4%B9.png"></p><h3 id="7-3-å¦‚ä½•åšåˆ°æ¶ˆæ¯çš„é¡ºåºæ¶ˆè´¹"><a href="#7-3-å¦‚ä½•åšåˆ°æ¶ˆæ¯çš„é¡ºåºæ¶ˆè´¹" class="headerlink" title="7.3 å¦‚ä½•åšåˆ°æ¶ˆæ¯çš„é¡ºåºæ¶ˆè´¹"></a>7.3 å¦‚ä½•åšåˆ°æ¶ˆæ¯çš„é¡ºåºæ¶ˆè´¹</h3><ul><li><p>â½£äº§è€…ï¼šä¿è¯æ¶ˆæ¯æŒ‰é¡ºåºæ¶ˆè´¹ï¼Œä¸”æ¶ˆæ¯ä¸ä¸¢å¤±â€”â€”ä½¿â½¤åŒæ­¥çš„å‘é€ï¼Œackè®¾ç½®æˆâ¾®0çš„ å€¼ã€‚</p></li><li><p>æ¶ˆè´¹è€…ï¼šä¸»é¢˜åªèƒ½è®¾ç½®â¼€ä¸ªåˆ†åŒºï¼Œæ¶ˆè´¹ç»„ä¸­åªèƒ½æœ‰â¼€ä¸ªæ¶ˆè´¹è€…</p></li></ul><p>kafkaçš„é¡ºåºæ¶ˆè´¹ä½¿â½¤åœºæ™¯ä¸å¤šï¼Œå› ä¸ºç‰ºç‰²æ‰äº†æ€§èƒ½ï¼Œä½†æ˜¯â½å¦‚rocketmqåœ¨è¿™â¼€å—æœ‰ä¸“â»”çš„åŠŸèƒ½å·²è®¾è®¡å¥½</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linuxkafka%E5%A6%82%E4%BD%95%E5%81%9A%E5%88%B0%E6%B6%88%E6%81%AF%E7%9A%84%E9%A1%BA%E5%BA%8F%E6%B6%88%E8%B4%B9.png"></p><h3 id="7-4-å¦‚ä½•è§£å†³æ¶ˆæ¯ç§¯å‹é—®é¢˜"><a href="#7-4-å¦‚ä½•è§£å†³æ¶ˆæ¯ç§¯å‹é—®é¢˜" class="headerlink" title="7.4 å¦‚ä½•è§£å†³æ¶ˆæ¯ç§¯å‹é—®é¢˜"></a>7.4 å¦‚ä½•è§£å†³æ¶ˆæ¯ç§¯å‹é—®é¢˜</h3><p>1ï¼‰æ¶ˆæ¯ç§¯å‹é—®é¢˜çš„å‡ºç°</p><p>æ¶ˆæ¯çš„æ¶ˆè´¹è€…çš„æ¶ˆè´¹é€Ÿåº¦è¿œèµ¶ä¸ä¸Šâ½£äº§è€…çš„â½£äº§æ¶ˆæ¯çš„é€Ÿåº¦ï¼Œå¯¼è‡´kafkaä¸­æœ‰â¼¤é‡çš„æ•°æ®æ²¡æœ‰è¢«æ¶ˆè´¹ã€‚</p><p>éšç€æ²¡æœ‰è¢«æ¶ˆè´¹çš„æ•°æ®å †ç§¯è¶Šå¤šï¼Œæ¶ˆè´¹è€…å¯»å€çš„æ€§èƒ½ä¼šè¶Šæ¥è¶Šå·®ï¼Œæœ€åå¯¼è‡´æ•´ä¸ª kafkaå¯¹å¤–æä¾›çš„æœåŠ¡çš„æ€§èƒ½å¾ˆå·®ï¼Œä»â½½é€ æˆå…¶ä»–æœåŠ¡ä¹Ÿè®¿é—®é€Ÿåº¦å˜æ…¢ï¼Œé€ æˆæœåŠ¡é›ªå´©ã€‚</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linuxkafka%E6%B6%88%E6%81%AF%E7%A7%AF%E5%8E%8B%E9%97%AE%E9%A2%98%E7%9A%84%E5%87%BA%E7%8E%B0.png"></p><p>2ï¼‰æ¶ˆæ¯ç§¯å‹çš„è§£å†³â½…æ¡ˆ</p><ol><li><p>åœ¨è¿™ä¸ªæ¶ˆè´¹è€…ä¸­ï¼Œä½¿â½¤å¤šçº¿ç¨‹ï¼Œå……åˆ†åˆ©â½¤æœºå™¨çš„æ€§èƒ½è¿›â¾æ¶ˆè´¹æ¶ˆæ¯ã€‚</p></li><li><p>é€šè¿‡ä¸šåŠ¡çš„æ¶æ„è®¾è®¡ï¼Œæå‡ä¸šåŠ¡å±‚â¾¯æ¶ˆè´¹çš„æ€§èƒ½ã€‚</p></li><li><p>åˆ›å»ºå¤šä¸ªæ¶ˆè´¹ç»„ï¼Œå¤šä¸ªæ¶ˆè´¹è€…ï¼Œéƒ¨ç½²åˆ°å…¶ä»–æœºå™¨ä¸Šï¼Œâ¼€èµ·æ¶ˆè´¹ï¼Œæâ¾¼æ¶ˆè´¹è€…çš„æ¶ˆè´¹é€Ÿåº¦</p></li></ol><p>åˆ›å»ºâ¼€ä¸ªæ¶ˆè´¹è€…ï¼Œè¯¥æ¶ˆè´¹è€…åœ¨kafkaå¦å»ºâ¼€ä¸ªä¸»é¢˜ï¼Œé…ä¸Šå¤šä¸ªåˆ†åŒºï¼Œå¤šä¸ªåˆ†åŒºå†é…ä¸Šå¤šä¸ª æ¶ˆè´¹è€…ã€‚è¯¥æ¶ˆè´¹è€…å°†pollä¸‹æ¥çš„æ¶ˆæ¯ï¼Œä¸è¿›â¾æ¶ˆè´¹ï¼Œç›´æ¥è½¬å‘åˆ°æ–°å»ºçš„ä¸»é¢˜ä¸Šã€‚æ­¤æ—¶ï¼Œæ–° çš„ä¸»é¢˜çš„å¤šä¸ªåˆ†åŒºçš„å¤šä¸ªæ¶ˆè´¹è€…å°±å¼€å§‹â¼€èµ·æ¶ˆè´¹äº†ã€‚â€”â€”ä¸å¸¸â½¤</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linuxkafka%E6%B6%88%E6%81%AF%E7%A7%AF%E5%8E%8B%E7%9A%84%E8%A7%A3%E5%86%B3%E2%BD%85%E6%A1%88.png"></p><h3 id="5-å®ç°å»¶æ—¶é˜Ÿåˆ—çš„æ•ˆæœ"><a href="#5-å®ç°å»¶æ—¶é˜Ÿåˆ—çš„æ•ˆæœ" class="headerlink" title="5.å®ç°å»¶æ—¶é˜Ÿåˆ—çš„æ•ˆæœ"></a>5.å®ç°å»¶æ—¶é˜Ÿåˆ—çš„æ•ˆæœ</h3><p>1ï¼‰åº”â½¤åœºæ™¯ è®¢å•åˆ›å»ºåï¼Œè¶…è¿‡30åˆ†é’Ÿæ²¡æœ‰â½€ä»˜ï¼Œåˆ™éœ€è¦å–æ¶ˆè®¢å•ï¼Œè¿™ç§åœºæ™¯å¯ä»¥é€šè¿‡å»¶æ—¶é˜Ÿåˆ—æ¥å®ç°</p><p>2ï¼‰å…·ä½“â½…æ¡ˆ</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linuxkafka%E5%AE%9E%E7%8E%B0%E5%BB%B6%E6%97%B6%E9%98%9F%E5%88%97%E7%9A%84%E6%95%88%E6%9E%9C.png"></p><ol><li><p>kafkaä¸­åˆ›å»ºåˆ›å»ºç›¸åº”çš„ä¸»é¢˜</p></li><li><p>æ¶ˆè´¹è€…æ¶ˆè´¹è¯¥ä¸»é¢˜çš„æ¶ˆæ¯(è½®è¯¢)</p></li><li><p>æ¶ˆè´¹è€…æ¶ˆè´¹æ¶ˆæ¯æ—¶åˆ¤æ–­æ¶ˆæ¯çš„åˆ›å»ºæ—¶é—´å’Œå½“å‰æ—¶é—´æ˜¯å¦è¶…è¿‡30åˆ†é’Ÿ(å‰ææ˜¯è®¢å•æ²¡æ”¯ä»˜)</p></li><li><p>å¦‚æœæ˜¯:å»æ•°æ®åº“ä¸­ä¿®æ”¹è®¢å•çŠ¶æ€ä¸ºå·²å–æ¶ˆ</p></li><li><p>å¦‚æœå¦:è®°å½•å½“å‰æ¶ˆæ¯çš„offset,å¹¶ä¸å†ç»§ç»­æ¶ˆè´¹ä¹‹åçš„æ¶ˆæ¯ã€‚ç­‰å¾…1åˆ†é’Ÿåï¼Œå†æ¬¡å‘kafkaæ‹‰å–è¯¥offsetåŠä¹‹åçš„æ¶ˆ<br>æ¯ï¼Œç»§ç»­è¿›è¡Œåˆ¤æ–­ï¼Œä»¥æ­¤åå¤ã€‚</p></li></ol><h2 id="å…«ã€Kafka-eagleç›‘æ§å¹³å°"><a href="#å…«ã€Kafka-eagleç›‘æ§å¹³å°" class="headerlink" title="å…«ã€Kafka-eagleç›‘æ§å¹³å°"></a>å…«ã€Kafka-eagleç›‘æ§å¹³å°</h2><h3 id="8-1-æ­å»º"><a href="#8-1-æ­å»º" class="headerlink" title="8.1 æ­å»º"></a>8.1 æ­å»º</h3><p>å»kafka-eagleå®˜â½¹ä¸‹è½½å‹ç¼©åŒ…<br><a href="http://download.kafka-eagle.org/">http://download.kafka-eagle.org/</a></p><p>åˆ†é…â¼€å°è™šæ‹Ÿæœº<br>è™šæ‹Ÿæœºä¸­å®‰è£…jdk<br>è§£å‹ç¼©kafka-eagleçš„å‹ç¼©åŒ…<br>ç»™kafka-eagleé…ç½®ç¯å¢ƒå˜é‡</p><p><code>export KE_HOME=/usr/local/kafka-eagle</code><br><code>export PATH=$PATH:$KE_HOME/bin</code></p><p>éœ€è¦ä¿®æ”¹kafka-eagleå†…éƒ¨çš„é…ç½®â½‚ä»¶ï¼š<br>vim system-config.properties<br>ä¿®æ”¹â¾¥â¾¯çš„zkçš„åœ°å€å’Œmysqlçš„åœ°å€<br>è¿›â¼Šåˆ°binä¸­ï¼Œé€šè¿‡å‘½ä»¤æ¥å¯åŠ¨</p><p><code>./ke.sh start</code></p><h3 id="8-2-ä½¿ç”¨"><a href="#8-2-ä½¿ç”¨" class="headerlink" title="8.2 ä½¿ç”¨"></a>8.2 ä½¿ç”¨</h3><p>kafka-eagle ç›‘æ§é¢æ¿</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linuxkafka-eagle-%E7%9B%91%E6%8E%A7%E9%9D%A2%E6%9D%BF.PNG"></p><p>kafka-ç›‘æ§æŸ¥çœ‹èŠ‚ç‚¹ä¿¡æ¯</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linuxkafka-%E7%9B%91%E6%8E%A7%E6%9F%A5%E7%9C%8B%E8%8A%82%E7%82%B9%E4%BF%A1%E6%81%AF.PNG"></p><p>kafka-eagleæŸ¥çœ‹æ¶ˆè´¹ç»„ä¸æ¶ˆè´¹ä¸»é¢˜ä¿¡æ¯</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linuxkafka-eagle%E6%9F%A5%E7%9C%8B%E6%B6%88%E8%B4%B9%E7%BB%84%E6%B6%88%E8%B4%B9%E4%B8%BB%E9%A2%98%E4%BF%A1%E6%81%AF.PNG"></p><p>kafka-eagleæŸ¥çœ‹æ¶ˆæ¯ç§¯å‹æƒ…å†µ</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linuxkafka-eagle%E6%9F%A5%E7%9C%8B%E6%B6%88%E6%81%AF%E7%A7%AF%E5%8E%8B%E6%83%85%E5%86%B5.PNG"></p>]]></content>
    
    
    <categories>
      
      <category>ä¸­é—´ä»¶</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Kafka</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ—¥å¿—å¤„ç†-Grokæ­£åˆ™æ•è·</title>
    <link href="/2023/04/21/%E6%97%A5%E5%BF%97%E5%A4%84%E7%90%86-Grok%E6%AD%A3%E5%88%99%E6%8D%95%E8%8E%B7/"/>
    <url>/2023/04/21/%E6%97%A5%E5%BF%97%E5%A4%84%E7%90%86-Grok%E6%AD%A3%E5%88%99%E6%8D%95%E8%8E%B7/</url>
    
    <content type="html"><![CDATA[<p>ä¸€èˆ¬ç³»ç»Ÿæˆ–æœåŠ¡ç”Ÿæˆçš„æ—¥å¿—éƒ½æ˜¯ä¸€å¤§é•¿ä¸²ã€‚æ¯ä¸ªå­—æ®µä¹‹é—´ç”¨ç©ºæ ¼éš”å¼€ã€‚logstashåœ¨è·å–æ—¥å¿—æ˜¯æ•´ä¸ªä¸€ä¸²è·å–ï¼Œå¦‚æœæŠŠæ—¥å¿—ä¸­æ¯ä¸ªå­—æ®µä»£è¡¨çš„æ„æ€åˆ†å‰²å¼€æ¥åœ¨ä¼ ç»™elasticsearchã€‚è¿™æ ·å‘ˆç°å‡ºæ¥çš„æ•°æ®æ›´åŠ æ¸…æ™°ï¼Œè€Œä¸”ä¹Ÿèƒ½è®©kibanaæ›´æ–¹ä¾¿çš„ç»˜åˆ¶å›¾å½¢ã€‚</p><p>Grok æ˜¯ Logstash æœ€é‡è¦çš„æ’ä»¶ã€‚å®ƒçš„ä¸»è¦ä½œç”¨å°±æ˜¯å°†æ–‡æœ¬æ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œè½¬æ¢æˆä¸ºå…·ä½“çš„ç»“æ„åŒ–çš„æ•°æ®ï¼Œé…åˆæ­£åˆ™è¡¨è¾¾å¼ä½¿ç”¨ã€‚</p><h1 id="Grok-æ­£åˆ™æ•è·"><a href="#Grok-æ­£åˆ™æ•è·" class="headerlink" title="Grok æ­£åˆ™æ•è·"></a>Grok æ­£åˆ™æ•è·</h1><p>Grok æ”¯æŒæŠŠé¢„å®šä¹‰çš„ grok è¡¨è¾¾å¼ å†™å…¥åˆ°æ–‡ä»¶ä¸­ï¼Œå®˜æ–¹æä¾›çš„é¢„å®šä¹‰ grok è¡¨è¾¾å¼è§ï¼š<a href="https://github.com/logstash/logstash/tree/v1.4.2/patterns%E3%80%82">https://github.com/logstash/logstash/tree/v1.4.2/patternsã€‚</a></p><p><code>%&#123;syntax:semantic&#125;</code></p><p>syntaxä»£è¡¨çš„æ˜¯æ­£åˆ™è¡¨è¾¾å¼æ›¿ä»£å­—æ®µï¼Œsemanticæ˜¯ä»£è¡¨è¿™ä¸ªè¡¨è¾¾å¼å¯¹åº”çš„å­—æ®µåï¼Œä½ å¯ä»¥è‡ªç”±å‘½åã€‚è¿™ä¸ªå‘½åå°½é‡èƒ½ç®€å•æ˜“æ‡‚çš„è¡¨è¾¾å‡ºè¿™ä¸ªå­—æ®µä»£è¡¨çš„æ„æ€ã€‚</p><p>logstashå®‰è£…æ—¶å°±å¸¦æœ‰å·²ç»å†™å¥½çš„æ­£åˆ™è¡¨è¾¾å¼ã€‚è·¯å¾„å¦‚ä¸‹ï¼š</p><p><code>/usr/local/logstash-2.3.4/vendor/bundle/jruby/1.9/gems/logstash-patterns-core-2.0.5/patterns</code></p><p>æˆ–è€…ç›´æ¥è®¿é—®logstash-plugins&#x2F;logstash-patterns-core Â· GitHub</p><p>ä¸Šé¢IPORHOSTï¼ŒUSERç­‰éƒ½æ˜¯åœ¨é‡Œé¢å·²ç»å®šä¹‰å¥½çš„ï¼å½“ç„¶è¿˜æœ‰å…¶ä»–çš„ï¼ŒåŸºæœ¬èƒ½æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ã€‚</p><h2 id="grok-patterns"><a href="#grok-patterns" class="headerlink" title="grok-patterns"></a>grok-patterns</h2><figure class="highlight">  <figcaption>This is a code block</figcaption>  <pre><code class="language-shell">  cat /proc/cpuinfo| grep "physical id  USERNAME [a-zA-Z0-9._-]+  USER %&#123;USERNAME&#125;  EMAILLOCALPART [a-zA-Z0-9!#$%&'*+\-/=?^_`&#123;|&#125;~]&#123;1,64&#125;(?:\.[a-zA-Z0-9!#$%&'*+\-/=?^_`&#123;|&#125;~]&#123;1,62&#125;)&#123;0,63&#125;  EMAILADDRESS %&#123;EMAILLOCALPART&#125;@%&#123;HOSTNAME&#125;  INT (?:[+-]?(?:[0-9]+))  BASE10NUM (?<![0-9.+-])(?>[+-]?(?:(?:[0-9]+(?:\.[0-9]+)?)|(?:\.[0-9]+)))  NUMBER (?:%&#123;BASE10NUM&#125;)  BASE16NUM (?<![0-9A-Fa-f])(?:[+-]?(?:0x)?(?:[0-9A-Fa-f]+))  BASE16FLOAT \b(?<![0-9A-Fa-f.])(?:[+-]?(?:0x)?(?:(?:[0-9A-Fa-f]+(?:\.[0-9A-Fa-f]*)?)|(?:\.[0-9A-Fa-f]+)))\b  <p>  POSINT \b(?:[1-9][0-9]<em>)\b<br>  NONNEGINT \b(?:[0-9]+)\b<br>  WORD \b\w+\b<br>  NOTSPACE \S+<br>  SPACE \s</em><br>  DATA .<em>?<br>  GREEDYDATA .</em><br>  QUOTEDSTRING (?&gt;(?&lt;!\)(?&gt;â€(?&gt;\.|[^\â€œ]+)+â€|â€â€|(?&gt;â€™(?&gt;\.|[^\â€˜]+)+â€™)|â€™â€™|(?&gt;<code>(?&gt;\\.|[^\\</code>]+)+&#96;)|&#96;&#96;))<br>  UUID [A-Fa-f0-9]{8}-(?:[A-Fa-f0-9]{4}-){3}[A-Fa-f0-9]{12}<br>  # URN, allowing use of RFC 2141 section 2.3 reserved characters<br>  URN urn:[0-9A-Za-z][0-9A-Za-z-]{0,31}:(?:%[0-9a-fA-F]{2}|[0-9A-Za-z()+,.:&#x3D;@;$_!*â€™&#x2F;?#-])+  <p></p><p>  # Networking<br>  MAC (?:%{CISCOMAC}|%{WINDOWSMAC}|%{COMMONMAC})<br>  CISCOMAC (?:(?:[A-Fa-f0-9]{4}.){2}[A-Fa-f0-9]{4})<br>  WINDOWSMAC (?:(?:[A-Fa-f0-9]{2}-){5}[A-Fa-f0-9]{2})<br>  COMMONMAC (?:(?:[A-Fa-f0-9]{2}:){5}[A-Fa-f0-9]{2})<br>  IPV6 ((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?<br>  IPV4 (?&lt;![0-9])(?:(?:[0-1]?[0-9]{1,2}|2[0-4][0-9]|25[0-5])<a href="?:%5B0-1%5D?%5B0-9%5D%7B1,2%7D%7C2%5B0-4%5D%5B0-9%5D%7C25%5B0-5%5D">.</a><a href="?:%5B0-1%5D?%5B0-9%5D%7B1,2%7D%7C2%5B0-4%5D%5B0-9%5D%7C25%5B0-5%5D">.</a><a href="?:%5B0-1%5D?%5B0-9%5D%7B1,2%7D%7C2%5B0-4%5D%5B0-9%5D%7C25%5B0-5%5D">.</a>)(?![0-9])<br>  IP (?:%{IPV6}|%{IPV4})<br>  HOSTNAME \b(?:[0-9A-Za-z][0-9A-Za-z-]{0,62})(?:.(?:[0-9A-Za-z][0-9A-Za-z-]{0,62}))*(.?|\b)<br>  IPORHOST (?:%{IP}|%{HOSTNAME})<br>  HOSTPORT %{IPORHOST}:%{POSINT}  </p><p>  # paths (only absolute paths are matched)<br>  PATH (?:%{UNIXPATH}|%{WINPATH})<br>  UNIXPATH (&#x2F;[[[:alnum:]]_%!$@:.,+<code>~</code>-]<em>)+<br>  TTY (?:&#x2F;dev&#x2F;(pts|tty([pq])?)(\w+)?&#x2F;?(?:[0-9]+))<br>  WINPATH (?&gt;[A-Za-z]+:|\)(?:\[^\?</em>]<em>)+<br>  URIPROTO <a href="%5BA-Za-z0-9+-.%5D+">A-Za-z</a>+<br>  URIHOST %{IPORHOST}(?::%{POSINT})?<br>  # uripath comes loosely from RFC1738, but mostly from what Firefox doesnâ€™t turn into %XX<br>  URIPATH (?:&#x2F;[A-Za-z0-9$.+!</em>â€˜(){},<code>~</code>:;&#x3D;@#%&amp;<em>-]<em>)+<br>  URIQUERY [A-Za-z0-9$.+!</em>â€˜|(){},<code>~</code>@#%&amp;&#x2F;&#x3D;:;</em>?-[]&lt;&gt;]*<br>  # deprecated (kept due compatibility):<br>  URIPARAM ?%{URIQUERY}<br>  URIPATHPARAM %{URIPATH}(?:?%{URIQUERY})?<br>  URI %{URIPROTO}:&#x2F;&#x2F;(?:%{USER}(?::[^@]*)?@)?(?:%{URIHOST})?(?:%{URIPATH}(?:?%{URIQUERY})?)?  </p><p>  # Months: January, Feb, 3, 03, 12, December<br>  MONTH \b(?:[Jj]an(?:uary|uar)?|[Ff]eb(?:ruary|ruar)?|<a href="?:a%7C%C3%A4">Mm</a>?r(?:ch|z)?|[Aa]pr(?:il)?|[Mm]a(?:y|i)?|[Jj]un(?:e|i)?|[Jj]ul(?:y|i)?|[Aa]ug(?:ust)?|[Ss]ep(?:tember)?|<a href="?:c%7Ck">Oo</a>?t(?:ober)?|[Nn]ov(?:ember)?|[Dd]e(?:c|z)(?:ember)?)\b<br>  MONTHNUM (?:0?[1-9]|1[0-2])<br>  MONTHNUM2 (?:0[1-9]|1[0-2])<br>  MONTHDAY (?:(?:0[1-9])|(?:[12][0-9])|(?:3[01])|[1-9])  </p><p>  # Days: Monday, Tue, Thu, etcâ€¦<br>  DAY (?:Mon(?:day)?|Tue(?:sday)?|Wed(?:nesday)?|Thu(?:rsday)?|Fri(?:day)?|Sat(?:urday)?|Sun(?:day)?)  </p><p>  # Years?<br>  YEAR (?&gt;\d\d){1,2}<br>  HOUR (?:2[0123]|[01]?[0-9])<br>  MINUTE (?:[0-5][0-9])<br>  # â€˜60â€™ is a leap second in most time standards and thus is valid.<br>  SECOND (?:(?:[0-5]?[0-9]|60)(?:[:.,][0-9]+)?)<br>  TIME (?!&lt;[0-9])%{HOUR}:%{MINUTE}(?::%{SECOND})(?![0-9])<br>  # datestamp is YYYY&#x2F;MM&#x2F;DD-HH:MM:SS.UUUU (or something like it)<br>  DATE_US %{MONTHNUM}[&#x2F;-]%{MONTHDAY}[&#x2F;-]%{YEAR}<br>  DATE_EU %{MONTHDAY}[.&#x2F;-]%{MONTHNUM}[.&#x2F;-]%{YEAR}<br>  ISO8601_TIMEZONE (?:Z|[+-]%{HOUR}(?::?%{MINUTE}))<br>  ISO8601_SECOND %{SECOND}<br>  TIMESTAMP_ISO8601 %{YEAR}-%{MONTHNUM}-%{MONTHDAY}[T ]%{HOUR}:?%{MINUTE}(?::?%{SECOND})?%{ISO8601_TIMEZONE}?<br>  DATE %{DATE_US}|%{DATE_EU}<br>  DATESTAMP %{DATE}[- ]%{TIME}<br>  TZ (?:[APMCE][SD]T|UTC)<br>  DATESTAMP_RFC822 %{DAY} %{MONTH} %{MONTHDAY} %{YEAR} %{TIME} %{TZ}<br>  DATESTAMP_RFC2822 %{DAY}, %{MONTHDAY} %{MONTH} %{YEAR} %{TIME} %{ISO8601_TIMEZONE}<br>  DATESTAMP_OTHER %{DAY} %{MONTH} %{MONTHDAY} %{TIME} %{TZ} %{YEAR}<br>  DATESTAMP_EVENTLOG %{YEAR}%{MONTHNUM2}%{MONTHDAY}%{HOUR}%{MINUTE}%{SECOND}  </p><p>  # Syslog Dates: Month Day HH:MM:SS<br>  SYSLOGTIMESTAMP %{MONTH} +%{MONTHDAY} %{TIME}<br>  PROG [\x21-\x5a\x5c\x5e-\x7e]+<br>  SYSLOGPROG %{PROG:[process][name]}(?:[%{POSINT:[process][pid]:int}])?<br>  SYSLOGHOST %{IPORHOST}<br>  SYSLOGFACILITY &lt;%{NONNEGINT:[log][syslog][facility][code]:int}.%{NONNEGINT:[log][syslog][priority]:int}&gt;<br>  HTTPDATE %{MONTHDAY}&#x2F;%{MONTH}&#x2F;%{YEAR}:%{TIME} %{INT}  </p><p>  # Shortcuts<br>  QS %{QUOTEDSTRING}  </p><p>  # Log formats<br>  SYSLOGBASE %{SYSLOGTIMESTAMP:timestamp} (?:%{SYSLOGFACILITY} )?%{SYSLOGHOST:[host][hostname]} %{SYSLOGPROG}:  </p><p>  # Log Levels<br>  LOGLEVEL ([Aa]lert|ALERT|[Tt]race|TRACE|[Dd]ebug|DEBUG|[Nn]otice|NOTICE|[Ii]nfo?(?:rmation)?|INFO?(?:RMATION)?|[Ww]arn?(?:ing)?|WARN?(?:ING)?|[Ee]rr?(?:or)?|ERR?(?:OR)?|[Cc]rit?(?:ical)?|CRIT?(?:ICAL)?|[Ff]atal|FATAL|[Ss]evere|SEVERE|EMERG(?:ENCY)?|[Ee]merg(?:ency)?)<br>  </p></code></pre><p></p></figure><h2 id="æ¡ˆä¾‹å®è·µ"><a href="#æ¡ˆä¾‹å®è·µ" class="headerlink" title="æ¡ˆä¾‹å®è·µ"></a>æ¡ˆä¾‹å®è·µ</h2><p><strong>ä¾‹1</strong>ï¼šå°†ä¸‹é¢çš„æ—¥å¿—æ–‡ä»¶æ ¼å¼æ‹†åˆ†ä¸º5æ®µ</p><figure class="highlight">  <figcaption>This is a code block</figcaption>  <pre><code class="language-shell">  2016-09-19T18:19:00 [8.8.8.8:prd] DEBUG this is an example log message  </code></pre></figure><ul><li>æ—¶é—´</li><li>IPåœ°å€</li><li>ç¯å¢ƒ</li><li>ç­‰çº§</li><li>ä¿¡æ¯</li></ul><p>ä½¿ç”¨Grok é»˜è®¤æä¾›çš„æ­£åˆ™åŒ¹é…å</p><figure class="highlight">  <figcaption>This is a code block</figcaption>  <pre><code class="language-shell">  %&#123;TIMESTAMP_ISO8601:timestamp&#125; \[%&#123;IPV4:ip&#125;;%&#123;WORD:environment&#125;\] %&#123;LOGLEVEL:log_level&#125; %&#123;GREEDYDATA:message&#125;    <p>  è¿™æ ·å°±ä¼šç”Ÿæˆç»“æ„åŒ–ç»“æœï¼š<br>  &#123;<br>    â€œtimestampâ€: â€œ2016-09-19T18:19:00â€,<br>    â€œipâ€: â€œ8.8.8.8â€,<br>    â€œenvironmentâ€: â€œprdâ€,<br>    â€œlog_levelâ€: â€œDEBUGâ€,<br>    â€œmessageâ€: â€œthis is an example log messageâ€<br>  &#125;<br>  </p></code></pre><p></p></figure><p><code>TIMESTAMP_ISO8601</code> ç”¨æ¥åŒ¹é…æ—¶é—´</p><p><code>IPV4</code>åŒ¹é…IPV4 IPåœ°å€</p><p><code>WORD</code>åŒ¹é…ç¯å¢ƒ</p><p><code>LOGLEVEL</code>åŒ¹é…äº†æ—¥å¿—ç­‰çº§</p><p><code>GREEDYDATA</code>åŒ¹é…åé¢çš„æ‰€æœ‰å†…å®¹</p><p><strong>ä¾‹2</strong>ï¼š</p><figure class="highlight">  <figcaption>This is a code block</figcaption>  <pre><code class="language-shell">  220.181.108.96 - - [13/Jun/2015:21:14:28 +0000] "GET /blog/geekery/xvfb-firefox.html HTTP/1.1" 200 10975 "-" "Mozilla/5.0 (compatible; Baiduspider/2.0; +http://www.baidu.com/search/spider.html)"  </code></pre></figure><p><strong>è½¬æ¢å</strong>ï¼š</p><figure class="highlight">  <figcaption>This is a code block</figcaption>  <pre><code class="language-shell">  %&#123;IPORHOST:clientip&#125; %&#123;USER:ident&#125; %&#123;USER:auth&#125; \[%&#123;HTTPDATE:timestamp&#125;\] "%&#123;WORD:verb&#125; %&#123;DATA:request&#125; HTTP/%&#123;NUMBER:httpversion&#125;" %&#123;NUMBER:response:int&#125; (?:-|%&#123;NUMBER:bytes:int&#125;) %&#123;QS:referrer&#125; %&#123;QS:agent&#125;  </code></pre></figure><p><strong>ä¾‹3</strong>ï¼š</p><figure class="highlight">  <figcaption>This is a code block</figcaption>  <pre><code class="language-shell">  220.181.108.96 - - [13/Jun/2015:21:14:28 +0000] "GET /blog/geekery/xvfb-firefox.html HTTP/1.1" 200 10975 "-" "Mozilla/5.0 (compatible; Baiduspider/2.0; +http://www.baidu.com/search/spider.html)"  </code></pre></figure><p><strong>è½¬æ¢å</strong>ï¼š</p><figure class="highlight">  <figcaption>This is a code block</figcaption>  <pre><code class="language-shell">  %&#123;IPORHOST:clientip&#125; %&#123;USER:ident&#125; %&#123;USER:auth&#125; \[%&#123;HTTPDATE:timestamp&#125;\] "%&#123;WORD:verb&#125; %&#123;DATA:request&#125; HTTP/%&#123;NUMBER:httpversion&#125;" %&#123;NUMBER:response:int&#125; (?:-|%&#123;NUMBER:bytes:int&#125;) %&#123;QS:referrer&#125; %&#123;QS:agent&#125;  </code></pre></figure><p><strong>ä¾‹4</strong>ï¼šå‡è®¾æˆ‘ä»¬æœ‰ä¸‰ä¸ªä½¿ç”¨â€œcommon_headerï¼špayloadâ€æ ¼å¼çš„åº”ç”¨ç¨‹åº</p><figure class="highlight">  <figcaption>This is a code block</figcaption>  <pre><code class="language-shell">  Application 1: '8.8.8.8 process-name[666]: a b 1 2 a lot of text at the end'  <p>  Application 2: â€˜8.8.8.8 process-name[667]: a 1 2 3 a lot of text near the end;4â€™</p><p>  Application 3: â€˜8.8.8.8 process-name[421]: a completely different format | 1111â€™<br>  </p></code></pre><p></p></figure><p><strong>è½¬æ¢å</strong>ï¼š</p><figure class="highlight">  <figcaption>This is a code block</figcaption>  <pre><code class="language-shell">  grok &#123;  "match" => &#123; "message => [    '%&#123;IPORHOST:clientip&#125; %&#123;DATA:process_name&#125;\[%&#123;NUMBER:process_id&#125;\]: %&#123;WORD:word_1&#125; %&#123;WORD:word_2&#125; %&#123;NUMBER:number_1&#125; %&#123;NUMBER:number_2&#125; %&#123;DATA:data&#125;',    '%&#123;IPORHOST:clientip&#125; %&#123;DATA:process_name&#125;\[%&#123;NUMBER:process_id&#125;\]: %&#123;WORD:word_1&#125; %&#123;NUMBER:number_1&#125; %&#123;NUMBER:number_2&#125; %&#123;NUMBER:number_3&#125; %&#123;DATA:data&#125;;%&#123;NUMBER:number_4&#125;',    '%&#123;IPORHOST:clientip&#125; %&#123;DATA:process_name&#125;\[%&#123;NUMBER:process_id&#125;\]: %&#123;DATA:data&#125; | %&#123;NUMBER:number&#125;'    ] &#125;&#125;  </code></pre></figure><h3 id="ä¸‹é¢é’ˆå¯¹Apacheæ—¥å¿—æ¥åˆ†å‰²å¤„ç†"><a href="#ä¸‹é¢é’ˆå¯¹Apacheæ—¥å¿—æ¥åˆ†å‰²å¤„ç†" class="headerlink" title="ä¸‹é¢é’ˆå¯¹Apacheæ—¥å¿—æ¥åˆ†å‰²å¤„ç†"></a>ä¸‹é¢é’ˆå¯¹Apacheæ—¥å¿—æ¥åˆ†å‰²å¤„ç†</h3><figure class="highlight">  <figcaption>This is a code block</figcaption>  <pre><code class="language-shell">  192.168.10.97 - - [19/Jul/2016:16:28:52 +0800] "GET / HTTP/1.1" 200 23 "-" "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.101 Safari/537.36"  </code></pre></figure><p>æ—¥å¿—ä¸­æ¯ä¸ªå­—æ®µä¹‹é—´ç©ºæ ¼éš”å¼€ï¼Œåˆ†åˆ«å¯¹åº”messageä¸­çš„å­—æ®µã€‚</p><p>å¦‚ï¼š%{IPORHOST:addre} â€“&gt; 192.168.10.97</p><p>ä½†é—®é¢˜æ˜¯IPORHOSTåˆä¸æ˜¯æ­£åˆ™è¡¨è¾¾å¼ï¼Œæ€ä¹ˆèƒ½åŒ¹é…IPåœ°å€å‘¢ï¼Ÿ</p><p>å› ä¸ºIPPRHOSTæ˜¯grokè¡¨è¾¾å¼ï¼Œå®ƒä»£è¡¨çš„æ­£åˆ™è¡¨è¾¾å¼å¦‚ä¸‹ï¼š</p><figure class="highlight">  <figcaption>This is a code block</figcaption>  <pre><code class="language-shell">  IPV6 ((([0-9A-Fa-f]&#123;1,4&#125;:)&#123;7&#125;([0-9A-Fa-f]&#123;1,4&#125;|:))|(([0-9A-Fa-f]&#123;1,4&#125;:)&#123;6&#125;(:[0-9A-Fa-f]&#123;1,4&#125;|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d))&#123;3&#125;)|:))|(([0-9A-Fa-f]&#123;1,4&#125;:)&#123;5&#125;(((:[0-9A-Fa-f]&#123;1,4&#125;)&#123;1,2&#125;)|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d))&#123;3&#125;)|:))|(([0-9A-Fa-f]&#123;1,4&#125;:)&#123;4&#125;(((:[0-9A-Fa-f]&#123;1,4&#125;)&#123;1,3&#125;)|((:[0-9A-Fa-f]&#123;1,4&#125;)?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d))&#123;3&#125;))|:))|(([0-9A-Fa-f]&#123;1,4&#125;:)&#123;3&#125;(((:[0-9A-Fa-f]&#123;1,4&#125;)&#123;1,4&#125;)|((:[0-9A-Fa-f]&#123;1,4&#125;)&#123;0,2&#125;:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d))&#123;3&#125;))|:))|(([0-9A-Fa-f]&#123;1,4&#125;:)&#123;2&#125;(((:[0-9A-Fa-f]&#123;1,4&#125;)&#123;1,5&#125;)|((:[0-9A-Fa-f]&#123;1,4&#125;)&#123;0,3&#125;:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d))&#123;3&#125;))|:))|(([0-9A-Fa-f]&#123;1,4&#125;:)&#123;1&#125;(((:[0-9A-Fa-f]&#123;1,4&#125;)&#123;1,6&#125;)|((:[0-9A-Fa-f]&#123;1,4&#125;)&#123;0,4&#125;:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d))&#123;3&#125;))|:))|(:(((:[0-9A-Fa-f]&#123;1,4&#125;)&#123;1,7&#125;)|((:[0-9A-Fa-f]&#123;1,4&#125;)&#123;0,5&#125;:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d))&#123;3&#125;))|:)))(%.+)?  IPV4 (?<![0-9])(?:(?:[0-1]?[0-9]&#123;1,2&#125;|2[0-4][0-9]|25[0-5])[.](?:[0-1]?[0-9]&#123;1,2&#125;|2[0-4][0-9]|25[0-5])[.](?:[0-1]?[0-9]&#123;1,2&#125;|2[0-4][0-9]|25[0-5])[.](?:[0-1]?[0-9]&#123;1,2&#125;|2[0-4][0-9]|25[0-5]))(?![0-9])  IP (?:%&#123;IPV6&#125;|%&#123;IPV4&#125;)  HOSTNAME \b(?:[0-9A-Za-z][0-9A-Za-z-]&#123;0,62&#125;)(?:\.(?:[0-9A-Za-z][0-9A-Za-z-]&#123;0,62&#125;))*(\.?|\b)  IPORHOST (?:%&#123;IP&#125;|%&#123;HOSTNAME&#125;)  </code></code></pre></figure><figure class="highlight">  <figcaption>This is a code block</figcaption>  <pre><code class="language-shell">  IPORHOSTä»£è¡¨çš„æ˜¯ipv4æˆ–è€…ipv6æˆ–è€…HOSTNAMEæ‰€åŒ¹é…çš„grokè¡¨è¾¾å¼ã€‚<p>  ä¸Šé¢çš„IPORHOSTæœ‰ç‚¹å¤æ‚ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ç®€å•ç‚¹çš„ï¼Œå¦‚USER</p><p>  USERNAME [a-zA-Z0-9._-]+     </p><p>  #USERNAMEæ˜¯åŒ¹é…ç”±å­—æ¯ï¼Œæ•°å­—ï¼Œâ€œ.â€, â€œ_â€, â€œ-â€œç»„æˆçš„ä»»æ„å­—ç¬¦</p><p>  USER %&#123;USERNAME&#125;</p><p>  #USERä»£è¡¨USERNAMEçš„æ­£åˆ™è¡¨è¾¾å¼</p><p>  ç¬¬ä¸€è¡Œï¼Œç”¨æ™®é€šçš„æ­£åˆ™è¡¨è¾¾å¼æ¥å®šä¹‰ä¸€ä¸ª grok è¡¨è¾¾å¼ï¼›</p><p>  ç¬¬äºŒè¡Œï¼Œé€šè¿‡æ‰“å°èµ‹å€¼æ ¼å¼ï¼Œç”¨å‰é¢å®šä¹‰å¥½çš„ grok è¡¨è¾¾å¼æ¥å®šä¹‰å¦ä¸€ä¸ª grok è¡¨è¾¾å¼ã€‚<br>  </p></code></pre><p></p></figure><figure class="highlight">  <figcaption>This is a code block</figcaption>  <pre><code class="language-shell">  filter &#123;    if [type] == "apache" &#123;      grok &#123;        match => ["message" => "%&#123;IPORHOST:addre&#125; %&#123;USER:ident&#125; %&#123;USER:auth&#125; \[%&#123;HTTPDATE:timestamp&#125;\] \"%&#123;WORD:http_method&#125; %&#123;NOTSPACE:request&#125; HTTP/%&#123;NUMBER:httpversion&#125;\" %&#123;NUMBER:status&#125; (?:%&#123;NUMBER:bytes&#125;|-) \"(?:%&#123;URI:http_referer&#125;|-)\" \"%&#123;GREEDYDATA:User_Agent&#125;\""]        remove_field => ["message"]      &#125;      date &#123;        match => [ "timestamp", "dd/MMM/YYYY:HH:mm:ss Z" ]      &#125;    &#125;  &#125;  </code></pre></figure><h3 id="Httpd"><a href="#Httpd" class="headerlink" title="Httpd"></a>Httpd</h3><figure class="highlight">  <figcaption>This is a code block</figcaption>  <pre><code class="language-shell">  HTTPDUSER %&#123;EMAILADDRESS&#125;|%&#123;USER&#125;  HTTPDERROR_DATE %&#123;DAY&#125; %&#123;MONTH&#125; %&#123;MONTHDAY&#125; %&#123;TIME&#125; %&#123;YEAR&#125;  <p>  # Log formats<br>  HTTPD_COMMONLOG %&#123;IPORHOST:clientip&#125; %&#123;HTTPDUSER:ident&#125; %&#123;HTTPDUSER:auth&#125; [%&#123;HTTPDATE:timestamp&#125;] â€œ(?:%&#123;WORD:verb&#125; %&#123;NOTSPACE:request&#125;(?: HTTP&#x2F;%&#123;NUMBER:httpversion&#125;)?|%&#123;DATA:rawrequest&#125;)â€ %&#123;NUMBER:response&#125; (?:%&#123;NUMBER:bytes&#125;|-)<br>  HTTPD_COMBINEDLOG %&#123;HTTPD_COMMONLOG&#125; %&#123;QS:referrer&#125; %&#123;QS:agent&#125;  </p><p>  # Error logs<br>  HTTPD20_ERRORLOG [%&#123;HTTPDERROR_DATE:timestamp&#125;] [%&#123;LOGLEVEL:loglevel&#125;] (?:[client %&#123;IPORHOST:clientip&#125;] )&#123;0,1&#125;%&#123;GREEDYDATA:message&#125;<br>  HTTPD24_ERRORLOG [%&#123;HTTPDERROR_DATE:timestamp&#125;] [%&#123;WORD:module&#125;:%&#123;LOGLEVEL:loglevel&#125;] [pid %&#123;POSINT:pid&#125;(:tid %&#123;NUMBER:tid&#125;)?]( (%&#123;POSINT:proxy_errorcode&#125;)%&#123;DATA:proxy_message&#125;:)?( [client %&#123;IPORHOST:clientip&#125;:%&#123;POSINT:clientport&#125;])?( %&#123;DATA:errorcode&#125;:)? %&#123;GREEDYDATA:message&#125;<br>  HTTPD_ERRORLOG %&#123;HTTPD20_ERRORLOG&#125;|%&#123;HTTPD24_ERRORLOG&#125;  </p><p>  # Deprecated<br>  COMMONAPACHELOG %&#123;HTTPD_COMMONLOG&#125;<br>  COMBINEDAPACHELOG %&#123;HTTPD_COMBINEDLOG&#125;<br>  </p></code></pre><p></p></figure><h3 id="java"><a href="#java" class="headerlink" title="java"></a>java</h3><figure class="highlight">  <figcaption>This is a code block</figcaption>  <pre><code class="language-shell">  JAVACLASS (?:[a-zA-Z$_][a-zA-Z$_0-9]*\.)*[a-zA-Z$_][a-zA-Z$_0-9]*  <p>  #Space is an allowed character to match special cases like â€˜Native Methodâ€™ or â€˜Unknown Sourceâ€™<br>  JAVAFILE (?:[A-Za-z0-9_. -]+)  </p><p>  #Allow special <init>, <clinit> methods<br>  JAVAMETHOD (?:(&lt;(?:cl)?init&gt;)|[a-zA-Z$_][a-zA-Z$_0-9]*)  </clinit></init></p><p>  #Line number is optional in special cases â€˜Native methodâ€™ or â€˜Unknown sourceâ€™<br>  JAVASTACKTRACEPART %&#123;SPACE&#125;at %&#123;JAVACLASS:class&#125;.%&#123;JAVAMETHOD:method&#125;(%&#123;JAVAFILE:file&#125;(?::%&#123;NUMBER:line&#125;)?)  </p><p>  # Java Logs<br>  JAVATHREAD (?:[A-Z]&#123;2&#125;-Processor[\d]+)<br>  JAVACLASS (?:[a-zA-Z0-9-]+.)+[A-Za-z0-9$]+<br>  JAVAFILE (?:[A-Za-z0-9_.-]+)<br>  JAVALOGMESSAGE (.*)  </p><p>  # MMM dd, yyyy HH:mm:ss eg: Jan 9, 2014 7:13:13 AM<br>  CATALINA_DATESTAMP %&#123;MONTH&#125; %&#123;MONTHDAY&#125;, 20%&#123;YEAR&#125; %&#123;HOUR&#125;:?%&#123;MINUTE&#125;(?::?%&#123;SECOND&#125;) (?:AM|PM)  </p><p>  # yyyy-MM-dd HH:mm:ss,SSS ZZZ eg: 2014-01-09 17:32:25,527 -0800<br>  TOMCAT_DATESTAMP 20%&#123;YEAR&#125;-%&#123;MONTHNUM&#125;-%&#123;MONTHDAY&#125; %&#123;HOUR&#125;:?%&#123;MINUTE&#125;(?::?%&#123;SECOND&#125;) %&#123;ISO8601_TIMEZONE&#125;<br>  CATALINALOG %&#123;CATALINA_DATESTAMP:timestamp&#125; %&#123;JAVACLASS:class&#125; %&#123;JAVALOGMESSAGE:logmessage&#125;  </p><p>  # 2014-01-09 20:03:28,269 -0800 | ERROR | com.example.service.ExampleService - something compeletely unexpected happenedâ€¦<br>  TOMCATLOG %&#123;TOMCAT_DATESTAMP:timestamp&#125; | %&#123;LOGLEVEL:level&#125; | %&#123;JAVACLASS:class&#125; - %&#123;JAVALOGMESSAGE:logmessage&#125;</p><p>  </p></code></pre><p></p></figure><h3 id="Grok-Debugger"><a href="#Grok-Debugger" class="headerlink" title="Grok Debugger"></a>Grok Debugger</h3><p>å½“æˆ‘ä»¬æ‹¿åˆ°ä¸€æ®µæ—¥å¿—ï¼ŒæŒ‰ç…§ä¸Šé¢çš„grokè¡¨è¾¾å¼ä¸€ä¸ªä¸ªå»åŒ¹é…æ—¶ï¼Œæˆ‘ä»¬å¦‚ä½•ç¡®å®šæˆ‘ä»¬åŒ¹é…çš„æ˜¯å¦æ­£ç¡®å‘¢ï¼Ÿ</p><p><a href="https://grokconstructor.appspot.com/do/match#result">https://grokconstructor.appspot.com/do/match#result</a> è¿™ä¸ªåœ°å€å¯ä»¥æ»¡è¶³æˆ‘ä»¬çš„æµ‹è¯•éœ€æ±‚ã€‚å°±æ‹¿ä¸Šé¢apacheçš„æ—¥å¿—æµ‹è¯•ã€‚</p><p>ç‚¹å‡»åå°±å‡ºç°å¦‚ä¸‹æ•°æ®ï¼Œä½ å†™çš„æ¯ä¸ªgrokè¡¨è¾¾å¼éƒ½è·å–åˆ°å€¼äº†ã€‚ä¸ºäº†æµ‹è¯•å‡†ç¡®ï¼Œå¯ä»¥å¤šæµ‹è¯•å‡ æ¡æ—¥å¿—ã€‚</p><p>é…ç½®æ–‡ä»¶ï¼š</p><figure class="highlight">  <figcaption>This is a code block</figcaption>  <pre><code class="language-shell">  \# ---------------input è¾“å…¥æ¨¡å—-----------------------  input &#123;  beats &#123;  port => 5044  &#125;  &#125;  <p>  # â€”â€”â€”â€”â€”filter è¿‡æ»¤æ¨¡å—â€”â€”â€”â€”â€”â€”â€”â€“  </p><p>  filter &#123;<br>      grok &#123;<br>          match &#x3D;&gt; &#123;<br>              â€œmessageâ€ &#x3D;&gt; â€œ%&#123;TIMESTAMP_ISO8601:times&#125; %&#123;HOSTNAME:hosts&#125; %&#123;USERNAME:logtype&#125;: message repeated %&#123;INT:repetition_times&#125; times: [ æ—¥å¿—ç±»å‹:(?<Operation_type>(?&lt;&#x3D;)(.&#123;4&#125;)), (?<Operation_typ1e>(?&lt;&#x3D;)(.&#123;2&#125;)):%&#123;USER:user&#125;(%&#123;HOSTNAME:connection_method&#125;)(%&#123;HOSTNAME:connection_method&#125;), IPåœ°å€:%&#123;IPV4:connection_ip&#125;, æ“ä½œå¯¹è±¡:%&#123;GREEDYDATA:Action_log&#125;, æ“ä½œç±»å‹:(?<behaviour_t>(?&lt;&#x3D;)(.&#123;4&#125;)), æè¿°:(?<Behavior_performance>(?&lt;&#x3D;)(.&#123;4&#125;))]â€œ<br>          &#125;<br>      &#125;<br>  &#125;  </Behavior_performance></behaviour_t></Operation_typ1e></Operation_type></p><p>  # â€”â€”â€”â€”â€”output è¾“å‡ºæ¨¡å—â€”â€”â€”â€”â€”â€”â€”â€“  </p><p>  output &#123;<br>  elasticsearch &#123;<br>  hosts &#x3D;&gt; [â€œ<a href="http://localhost:9200" ]">http://localhost:9200&quot;]</a><br>  index &#x3D;&gt; â€œsangfor-af-%&#123;+YYYY.MM.dd&#125;â€<br>  #user &#x3D;&gt; â€œelasticâ€<br>  #password &#x3D;&gt; â€œchangemeâ€<br>  &#125;<br>  &#125;<br>  </p></code></pre><p></p></figure><h2 id="è‡ªå®šä¹‰grokè¡¨è¾¾å¼"><a href="#è‡ªå®šä¹‰grokè¡¨è¾¾å¼" class="headerlink" title="è‡ªå®šä¹‰grokè¡¨è¾¾å¼"></a>è‡ªå®šä¹‰grokè¡¨è¾¾å¼</h2><p>grokä¸»è¦æœ‰ä¸¤éƒ¨åˆ†ï¼šè‡ªå®šä¹‰æ­£åˆ™è¡¨è¾¾å¼å’Œç³»ç»Ÿé¢„å®šä¹‰çš„æ¨¡å¼è¡¨è¾¾å¼ã€‚</p><p>å¦‚æœä½ æ„Ÿè§‰logstashè‡ªå¸¦çš„grokè¡¨è¾¾å¼ä¸èƒ½æ»¡è¶³éœ€è¦ï¼Œä½ ä¹Ÿå¯ä»¥è‡ªå·±å®šä¹‰</p><p>å¦‚ï¼š</p><figure class="highlight">  <figcaption>This is a code block</figcaption>  <pre><code class="language-shell">  filter &#123;    if [type] == "apache" &#123;      grok &#123;        patterns_dir => "/usr/local/logstash-2.3.4/ownpatterns/patterns"        match => &#123;                  "message" => "%&#123;APACHE_LOG&#125;"                  &#125;        remove_field => ["message"]      &#125;      date &#123;        match => [ "timestamp", "dd/MMM/YYYY:HH:mm:ss Z" ]      &#125;    &#125;  &#125;  <p>  #patterns_dirä¸ºè‡ªå®šä¹‰çš„grokè¡¨è¾¾å¼çš„è·¯å¾„ã€‚<br>  #è‡ªå®šä¹‰çš„patternsä¸­æŒ‰ç…§logstashè‡ªå¸¦çš„æ ¼å¼ä¹¦å†™ã€‚<br>  </p></code></pre><p></p></figure><figure class="highlight">  <figcaption>This is a code block</figcaption>  <pre><code class="language-shell">  APACHE_LOG %&#123;IPORHOST:addre&#125; %&#123;USER:ident&#125; %&#123;USER:auth&#125; \[%&#123;HTTPDATE:timestamp&#125;\] \"%&#123;WORD:http_method&#125; %&#123;NOTSPACE:request&#125; HTTP/%&#123;NUMBER:httpversion&#125;\" %&#123;NUMBER:status&#125; (?:%&#123;NUMBER:bytes&#125;|-) \"(?:%&#123;URI:http_referer&#125;|-)\" \"%&#123;GREEDYDATA:User_Agent&#125;\"  <p>  #æˆ‘åªæ˜¯æŠŠapacheæ—¥å¿—åŒ¹é…çš„grokè¡¨è¾¾å¼å†™å…¥è‡ªå®šä¹‰æ–‡ä»¶ä¸­ï¼Œç®€åŒ–confæ–‡ä»¶ã€‚å•ä¸ªå­—æ®µçš„æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ä½ å¯ä»¥è‡ªå·±ä¹¦å†™æµ‹è¯•ã€‚<br>  </p></code></pre><p></p></figure><p><strong>å¸¸ç”¨æ­£åˆ™</strong></p><figure class="highlight">  <figcaption>This is a code block</figcaption>  <pre><code class="language-shell">  (?<temMsg>(.*)(?=Report)/?) è·å–Reportä¹‹å‰çš„å­—ç¬¦  (?<temMsg>(?=Report)(.*)/?) è·å–Reportä¹‹åçš„å­—ç¬¦  (?<temMsg>(?<=report).*?(?=msg)) æˆªå–reportå’Œmsgä¹‹é—´çš„å€¼ ä¸åŒ…å«reportå’Œmsgæœ¬èº« (?<temmsg>(report).*?(?=msg)) æˆªå–åŒ…å«reportä½†ä¸åŒ…å«msg  (?<temMsg>(?<=report).*?(msg)) æˆªå–ä¸åŒ…å«reportä½†åŒ…å«msg (?<temmsg>(report).*?(msg|request)) è¾“å‡ºä»¥reportå¼€å¤´,ä»¥msgæˆ–è€…ä»¥requestç»“å°¾çš„æ‰€æœ‰åŒ…å«å¤´å°¾ä¿¡æ¯  (?<temMsg>(report).*?(?=(msg|request))) è¾“å‡ºä»¥reportå¼€å¤´,ä»¥msgæˆ–è€…ä»¥requestç»“å°¾çš„ä¸åŒ…å«å¤´å°¾ä¿¡æ¯  </temMsg></=report).*?(msg))></temMsg></=report).*?(?=msg))></temMsg></temMsg></temMsg></code></pre></figure><p><strong>grokæˆªå–å­—ç¬¦ä¸­æŒ‡å®šé•¿åº¦çš„å†…å®¹</strong><br>è¦æ±‚åˆ©ç”¨grokæˆªå–æ—¥å¿—æ¶ˆæ¯ä¸­æŸä¸€æŒ‡å®šé•¿åº¦çš„å†…å®¹ã€‚</p><p>Logstatshéœ€è¦ä¸¤ä¸ªå¿…éœ€å‚æ•°inputã€outputï¼Œä»¥åŠä¸€ä¸ªå¯é€‰å‚æ•°filterã€‚inputç”¨äºè¾“å…¥æ•°æ®çš„è®¾ç½®ï¼Œoutputç”¨äºè¾“å‡ºæ•°æ®çš„è®¾ç½®ã€‚filteræ˜¯å®ç°æ•°æ®è¿‡æ»¤çš„è®¾ç½®ã€‚grokæ˜¯åœ¨filteré‡Œé¢å®ç°æ•°æ®æˆªå–ã€‚</p><p>é¡¹ç›®æœ‰ä¸€ä¸²åè®®æ¶ˆæ¯å¦‚ 7e8900000c040116432693324af0010180010005e98e0706000a7eï¼Œè¦æ±‚åˆ©ç”¨grokæˆªå–7eåé¢çš„å››ä¸ªå­—ç¬¦ï¼Œåˆ©ç”¨grokæ­£åˆ™è¡¨è¾¾å¼å³å¯å®ç°ã€‚<br>å®ç°ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight">  <figcaption>This is a code block</figcaption>  <pre><code class="language-shell">  filter&#123;   grok&#123; match => &#123;   "message" => "(?<mid>(?<=7e)(.&#123;4&#125;))" &#125; < code></=7e)(.&#123;4&#125;))"></mid></code></pre></figure><p>ä»£ç è§£é‡Šï¼š</p><p><code>message</code>ï¼šå³è¾“å…¥çš„æ•°æ®ä¿¡æ¯ã€‚</p><p><code>mid</code>ï¼šå³è¾“å‡ºç»“æœçš„åç§°</p><p><code>(?&lt;=7e)</code>ï¼šå³è¡¨ç¤ºè·å–7eåé¢çš„å­—ç¬¦ï¼Œä½†ä¸åŒ…æ‹¬7e</p><p><code>(.&#123;4&#125;)</code>ï¼šå³è¡¨ç¤ºè·å–çš„å­—ç¬¦é•¿åº¦ä¸º4ä¸ª</p>]]></content>
    
    
    <categories>
      
      <category>è¿ç»´</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ—¥å¿—</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>AWSæ•°æ®ä¼ è¾“è´¹ç”¨æ€ä¹ˆç®—ï¼Ÿ</title>
    <link href="/2023/04/20/AWS%E6%95%B0%E6%8D%AE%E4%BC%A0%E8%BE%93%E8%B4%B9%E7%94%A8%E6%80%8E%E4%B9%88%E7%AE%97%EF%BC%9F/"/>
    <url>/2023/04/20/AWS%E6%95%B0%E6%8D%AE%E4%BC%A0%E8%BE%93%E8%B4%B9%E7%94%A8%E6%80%8E%E4%B9%88%E7%AE%97%EF%BC%9F/</url>
    
    <content type="html"><![CDATA[<h2 id="AWSçš„æ•°æ®ä¼ è¾“ç±»å‹å¤§è‡´æœ‰å¦‚ä¸‹ä¸‰ç±»ï¼š"><a href="#AWSçš„æ•°æ®ä¼ è¾“ç±»å‹å¤§è‡´æœ‰å¦‚ä¸‹ä¸‰ç±»ï¼š" class="headerlink" title="AWSçš„æ•°æ®ä¼ è¾“ç±»å‹å¤§è‡´æœ‰å¦‚ä¸‹ä¸‰ç±»ï¼š"></a><strong>AWSçš„æ•°æ®ä¼ è¾“ç±»å‹å¤§è‡´æœ‰å¦‚ä¸‹ä¸‰ç±»</strong>ï¼š</h2><ul><li>ä¸Internetä¹‹é—´çš„æ•°æ®ä¼ è¾“</li><li>AWSå†…éƒ¨è·¨åŒºåŸŸçš„æ•°æ®ä¼ è¾“</li><li>AWSå†…éƒ¨åŒä¸€åŒºåŸŸçš„æ•°æ®ä¼ è¾“<br>æœ¬æ–‡å°†ä»¥ap-southeast-2åŒºåŸŸä¸­çš„EC2å’ŒS3ä¸ºä¾‹ã€‚</li></ul><h2 id="ä¸Internetä¹‹é—´çš„æ•°æ®ä¼ è¾“è´¹ç”¨è®¡ç®—"><a href="#ä¸Internetä¹‹é—´çš„æ•°æ®ä¼ è¾“è´¹ç”¨è®¡ç®—" class="headerlink" title="ä¸Internetä¹‹é—´çš„æ•°æ®ä¼ è¾“è´¹ç”¨è®¡ç®—"></a><strong>ä¸Internetä¹‹é—´çš„æ•°æ®ä¼ è¾“è´¹ç”¨è®¡ç®—</strong></h2><p>æ‰€æœ‰ä»Internetåˆ°AWSçš„æµé‡æ˜¯å…è´¹çš„ï¼Œæ‰€æœ‰ä»AWSåˆ°Internetçš„æµé‡æ˜¯æ”¶è´¹çš„ã€‚å³å¯¹AWSæœåŠ¡è€Œè¨€ï¼Œä¸Šè¡Œæ”¶è´¹ï¼Œä¸‹è¡Œå…è´¹ã€‚</p><p>é’ˆå¯¹ä¸Šè¡Œæµé‡ï¼ŒAWSæ ¹æ®ä¸åŒçš„ä½¿ç”¨é‡é‡‡ç”¨ä¸åŒçš„è´¹ç‡ï¼Œä¸‹è¡¨ä¸­å±•ç¤ºçš„æ˜¯ap-southeast-2åŒºåŸŸä»AWSåˆ°Internetçš„æ•°æ®ä¼ è¾“è´¹ç‡ã€‚</p><table><thead><tr><th>Rate tiers</th><th>Pricing</th></tr></thead><tbody><tr><td>Up to 1 GB &#x2F; Month</td><td>$0.00 per GB</td></tr><tr><td>Next 9.999 TB</td><td>$0.114 per GB</td></tr><tr><td>Next 40 TB &#x2F; Month</td><td>$0.098 per GB</td></tr><tr><td>Next 100 TB &#x2F; Month</td><td>$0.094 per GB</td></tr><tr><td>Greater than 150 TB &#x2F; Month</td><td>$0.092 per GB</td></tr></tbody></table><p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œåœ¨è¿™ä¸€ä¸ªæœˆä¸­S3å’ŒEC2å‡äº§ç”Ÿäº†1GBåˆ°Internetçš„ä¸Šè¡Œæµé‡ï¼ŒAWSåº”è¯¥æ”¶æˆ‘å¤šå°‘é’±ï¼Ÿ$0? ä¸æ˜¯çš„ï¼Œä¼šäº§ç”Ÿ $0.114 è´¹ç”¨ã€‚</p><h2 id="ä¸ºå•¥ï¼Ÿ"><a href="#ä¸ºå•¥ï¼Ÿ" class="headerlink" title="ä¸ºå•¥ï¼Ÿ"></a><strong>ä¸ºå•¥ï¼Ÿ</strong></h2><p>AWSä¼šæ ¹æ®ä»AWSæœåŠ¡ä¼ è¾“åˆ°Internetçš„æ•°æ®æ€»é‡è®¡ç®—æ•°æ®ä¼ è¾“è´¹ç‡ã€‚å…·ä½“è€Œè¨€ï¼ŒAWSä¼šå°†ä»Amazon EC2, Amazon S3, Amazon Glacier, Amazon RDS, Amazon Redshift, Amazon SES, Amazon SimpleDB, Amazon SQS, Amazon SNS, Amazon DynamoDB, AWS Storage Gateway, å’Œ Amazon CloudWatch Logsåˆ°Internetçš„æµé‡è¿›è¡Œåˆå¹¶è®¡ç®—æ•°æ®ä¼ è¾“è´¹ç‡ã€‚</p><p>æ¯”å¦‚ï¼Œæˆ‘ä»¬åªä½¿ç”¨äº†EC2å’ŒS3æœåŠ¡ï¼Œåœ¨æœ¬æœˆæˆ‘ä»¬å·²ç»ä½¿ç”¨äº†10TBï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥EC2æˆ–è€…S3åˆ°Internetçš„è´¹ç”¨åˆ°ä¼šæŒ‰ç…§$0.098&#x2F;GBæ”¶è´¹ï¼ŒçŸ¥é“ä½¿ç”¨åˆ°ä¸‹ä¸€ä¸ªè´¹ç‡æ ‡å‡†ã€‚</p><p>ç®€å•è¯´ï¼Œä¸‹è¡Œå…è´¹ï¼Œä¸Šè¡Œæ”¶è´¹ï¼Œè´¹ç‡ç®—æ€»é‡ã€‚</p><h2 id="è·¨åŒºåŸŸçš„æ•°æ®ä¼ è¾“è´¹ç”¨è®¡ç®—"><a href="#è·¨åŒºåŸŸçš„æ•°æ®ä¼ è¾“è´¹ç”¨è®¡ç®—" class="headerlink" title="è·¨åŒºåŸŸçš„æ•°æ®ä¼ è¾“è´¹ç”¨è®¡ç®—"></a><strong>è·¨åŒºåŸŸçš„æ•°æ®ä¼ è¾“è´¹ç”¨è®¡ç®—</strong></h2><p>ä¸åŒåŒºåŸŸå¯¹è·¨åŒºåŸŸæ•°æ®ä¼ è¾“çš„è´¹ç‡æ˜¯ä¸ä¸€æ ·çš„ã€‚å¯¹äºä¸Šè¡Œçš„æ•°æ®ä¼ è¾“ä¼šæŒ‰ç…§è´¹ç‡æ”¶å–è´¹ç”¨ï¼Œå¯¹äºä¸‹è¡Œçš„æ•°æ®ä¼ è¾“ä¸æ”¶è´¹ã€‚</p><p>æ¯”å¦‚ç°åœ¨æœ‰2å°EC2å®ä¾‹Aå’ŒBï¼ŒAåœ¨æ‚‰å°¼(ap-southeast-2)ï¼ŒBåœ¨æ–°åŠ å¡(ap-southeast-1)ã€‚è¿™ä¸¤å°å®ä¾‹ä¹‹é—´å¦‚ä½•æ”¶å–æ•°æ®ä¼ è¾“è´¹ç”¨ï¼Ÿ</p><p>å·²çŸ¥ä»æ‚‰å°¼ap-southeast-2åˆ°å…¶ä»–åŒºåŸŸçš„æ•°æ®ä¼ è¾“è´¹ç”¨ä¸º $0.14&#x2F;GBï¼Œä»æ–°åŠ å¡ap-southeast-1åˆ°å…¶ä»–åŒºåŸŸçš„æ•°æ®ä¼ è¾“è´¹ç”¨ä¸º $0.09&#x2F;GB</p><p>åˆ™ä»Aç»™Bä¼ è¾“1GBçš„æ•°æ®ï¼ŒAéœ€è¦ä»˜å‡ºæ•°æ®ä¼ è¾“è´¹ç”¨ $0.14ï¼ŒBä¸éœ€è¦ä»˜è´¹ã€‚ä»Bç»™Aä¼ è¾“1GBçš„æ•°æ®ï¼ŒAä¸éœ€è¦ä»˜è´¹ï¼ŒBéœ€è¦ä»˜è´¹ $0.09ã€‚</p><p>ä¸‹è¡Œå…è´¹ï¼Œä¸Šè¡Œæ”¶è´¹ï¼Œè´¹ç‡åˆ†åŒºåŸŸã€‚</p><h2 id="åˆ°CloudFrontçš„æ•°æ®ä¼ è¾“è´¹ç”¨è®¡ç®—"><a href="#åˆ°CloudFrontçš„æ•°æ®ä¼ è¾“è´¹ç”¨è®¡ç®—" class="headerlink" title="åˆ°CloudFrontçš„æ•°æ®ä¼ è¾“è´¹ç”¨è®¡ç®—"></a><strong>åˆ°CloudFrontçš„æ•°æ®ä¼ è¾“è´¹ç”¨è®¡ç®—</strong></h2><p>æ— è®ºEC2è¿˜æ˜¯S3åˆ°CloudFrontçš„æ•°æ®ä¼ è¾“éƒ½æ˜¯å…è´¹çš„ã€‚</p><h2 id="åŒä¸€åŒºåŸŸå†…çš„æ•°æ®ä¼ è¾“è´¹ç”¨è®¡ç®—"><a href="#åŒä¸€åŒºåŸŸå†…çš„æ•°æ®ä¼ è¾“è´¹ç”¨è®¡ç®—" class="headerlink" title="åŒä¸€åŒºåŸŸå†…çš„æ•°æ®ä¼ è¾“è´¹ç”¨è®¡ç®—"></a><strong>åŒä¸€åŒºåŸŸå†…çš„æ•°æ®ä¼ è¾“è´¹ç”¨è®¡ç®—</strong></h2><h2 id="S3"><a href="#S3" class="headerlink" title="S3"></a><strong>S3</strong></h2><p>S3 bucketä¹‹é—´åœ¨åŒä¸€åŒºåŸŸè¿›è¡Œæ•°æ®ä¼ è¾“ä¸æ”¶è´¹ã€‚</p><p>S3å’Œå…¶ä»–AWSæœåŠ¡åœ¨åŒä¸€åŒºåŸŸè¿›è¡Œæ•°æ®ä¼ è¾“ä¸æ”¶è´¹ã€‚æ¯”å¦‚EC2å’ŒS3ä¹‹é—´ä¼ è¾“æ•°æ®æ˜¯å…è´¹çš„ã€‚</p><h2 id="EC2"><a href="#EC2" class="headerlink" title="EC2"></a><strong>EC2</strong></h2><ul><li><p>Amazon EC2ï¼ŒAmazon RDSï¼ŒAmazon Redshiftï¼ŒAmazon DynamoDB Acceleratorï¼ˆDAXï¼‰ï¼ŒAmazon ElastiCach å’Œ Elastic Network Interfacesè¿›è¡Œè·¨å¯ç”¨åŒºæˆ–ä½¿ç”¨VPCå¯¹ç­‰è¿æ¥ä¼ è¾“æ•°æ®ï¼Œä¸Šä¸‹è¡Œéƒ½éœ€è¦æ”¶è´¹ï¼Œ$0.01&#x2F;GB<br>æ¯”å¦‚åœ¨å¯ç”¨åŒºAä¸­æœ‰1å°EC2 EC2-Aï¼Œåœ¨å¯ç”¨åŒºBä¸­æœ‰1å°EC EC2-Bã€‚å½“EC2-Aå‘EC2-Bä¼ è¾“1Gæ•°æ®ï¼ŒEC2-Aéœ€è¦æ”¯ä»˜ $0.01 ä¸Šè¡Œæ•°æ®ä¼ è¾“è´¹ç”¨ï¼ŒEC2-Béœ€è¦æ”¯ä»˜ $0.01 ä¸‹è¡Œæ•°æ®ä¼ è¾“è´¹ç”¨ã€‚æ€»å…±éœ€è¦ $0.02 æ•°æ®ä¼ è¾“è´¹ç”¨ã€‚</p></li><li><p>åŒä¸€ä¸ªåŒºåŸŸå†…ï¼Œä½¿ç”¨å…¬ç½‘IPv4æˆ–è€…å¼¹æ€§IPv4åœ°å€ä¼ è¾“æ•°æ®ï¼Œä¸Šä¸‹è¡Œéƒ½éœ€è¦æ”¶è´¹ï¼Œ$0.01&#x2F;GBã€‚<br>æ¯”å¦‚åœ¨å¯ç”¨åŒºAä¸­æœ‰ä¸¤å°EC2 EC2-Aå’ŒEC2-Bï¼Œå®ƒä»¬ä¹‹é—´ä½¿ç”¨å…¬ç½‘IPä¼ è¾“æ•°æ®æ˜¯éœ€è¦æ”¶è´¹çš„ï¼Œå‡å¦‚EC2-Aå‘EC2-Bå‘é€1GBçš„æ•°æ®ï¼ŒEC2-Aéœ€è¦æ”¯ä»˜ $0.01 ä¸Šè¡Œæ•°æ®ä¼ è¾“è´¹ç”¨ï¼ŒEC2-Béœ€è¦æ”¯ä»˜ $0.01 ä¸‹è¡Œæ•°æ®ä¼ è¾“è´¹ç”¨ã€‚æ€»å…±éœ€è¦ $0.02 æ•°æ®ä¼ è¾“è´¹ç”¨ã€‚</p></li></ul><p>Q: è·¨å¯ç”¨åŒºä½¿ç”¨Public IPä¼ è¾“æ•°æ®å¦‚ä½•æ”¶è´¹ï¼Ÿ<br>è·¨åŒºåŸŸä½¿ç”¨Public IPæˆ–è€…EIPä¼ è¾“æ•°æ®åªä¼šæ”¶ä¸€æ¬¡è´¹ç”¨ã€‚<br>æ¯”å¦‚åœ¨å¯ç”¨åŒºAä¸­æœ‰1å°EC2 EC2-Aï¼Œåœ¨å¯ç”¨åŒºBä¸­æœ‰1å°EC EC2-Bã€‚å½“EC2-Aé€šè¿‡EIPå‘EC2-Bä¼ è¾“1Gæ•°æ®ï¼ŒEC2-Aéœ€è¦æ”¯ä»˜ $0.01 ä¸Šè¡Œæ•°æ®ä¼ è¾“è´¹ç”¨ï¼ŒEC2-Béœ€è¦æ”¯ä»˜ $0.01 ä¸‹è¡Œæ•°æ®ä¼ è¾“è´¹ç”¨ã€‚æ€»å…±éœ€è¦ $0.02 æ•°æ®ä¼ è¾“è´¹ç”¨ã€‚</p><ul><li><p>åŒä¸€ä¸ªåŒºåŸŸå†…ï¼Œä½¿ç”¨IPv6è·¨VPCä¼ è¾“æ•°æ®ï¼Œä¸Šä¸‹è¡Œéƒ½éœ€è¦æ”¶è´¹ï¼Œ$0.01&#x2F;GBã€‚</p></li><li><p>åŒä¸€ä¸ªå¯ç”¨åŒºå†…Amazon EC2, Amazon RDS, Amazon Redshift, Amazon ElastiCache instances å’Œ Elastic Network Interfaces ä¹‹é—´ä¼ è¾“æ•°æ®å…è´¹ã€‚å¦‚æœä½¿ç”¨VPCå¯¹ç­‰è¿æ¥ï¼Œåˆ™éœ€è¦æŒ‰ç…§VPCå¯¹ç­‰è¿æ¥çš„è´¹ç‡æ”¶è´¹ã€‚</p></li></ul><p>æ¯”å¦‚åœ¨å¯ç”¨åŒºAä¸­æœ‰ä¸¤å°EC2 EC2-Aå’ŒEC2-Bï¼Œå®ƒä»¬ä¹‹é—´ä½¿ç”¨ç§æœ‰IPä¼ è¾“æ•°æ®æ˜¯å…è´¹çš„ã€‚</p><ul><li><p>åœ¨åŒä¸€åŒºåŸŸä¸­å†… Amazon S3ã€Amazon Glacierã€Amazon DynamoDBã€Amazon SESã€Amazon SQSã€Amazon Kinesisã€Amazon ECRã€Amazon SNSã€Amazon SimpleDB å’Œ Amazon EC2 å®ä¾‹ä¹‹é—´ä¼ è¾“æ•°æ®æ˜¯å…è´¹çš„ã€‚é€šè¿‡PrivateLinkç»ˆç«¯èŠ‚ç‚¹è®¿é—®çš„AWSæœåŠ¡å°†äº§ç”Ÿæ ‡å‡†PrivateLinkè´¹ç”¨ã€‚</p></li><li><p>ä½¿ç”¨ç§æœ‰ IP åœ°å€ä» Amazon Classic Elastic Load Balancer å’Œ Amazon Application Elastic Load Balancerä¸EC2 å®ä¾‹ä¹‹é—´ä¼ è¾“æ•°æ®æ˜¯å…è´¹çš„ã€‚</p></li></ul><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a><strong>æ€»ç»“</strong></h2><p><strong>EC2</strong><br><img src="https://github.com/JohnnySXY/JohnnySXY.github.io/blob/master/2023/04/20/AWS%E6%95%B0%E6%8D%AE%E4%BC%A0%E8%BE%93%E8%B4%B9%E7%94%A8%E6%80%8E%E4%B9%88%E7%AE%97%EF%BC%9F/ec2.png?raw=true"></p><p><strong>S3</strong><br><img src="https://github.com/JohnnySXY/JohnnySXY.github.io/blob/master/2023/04/20/AWS%E6%95%B0%E6%8D%AE%E4%BC%A0%E8%BE%93%E8%B4%B9%E7%94%A8%E6%80%8E%E4%B9%88%E7%AE%97%EF%BC%9F/s3.png?raw=true"></p>]]></content>
    
    
    <categories>
      
      <category>CLOUD</category>
      
    </categories>
    
    
    <tags>
      
      <tag>AWS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å…³äºå¦‚ä½•åœ¨hexoåšå®¢ä¸Šå‘å¸ƒå’Œåˆ é™¤åšæ–‡</title>
    <link href="/2023/04/20/Hexo-Release-OR-Delete-Article/"/>
    <url>/2023/04/20/Hexo-Release-OR-Delete-Article/</url>
    
    <content type="html"><![CDATA[<p><span style="color: #519D9E; ">å…³äºå¦‚ä½•åœ¨hexoåšå®¢ä¸Šå‘å¸ƒå’Œåˆ é™¤åšæ–‡</span></p><h2 id="åˆ›å»ºæ–‡ç« "><a href="#åˆ›å»ºæ–‡ç« " class="headerlink" title="åˆ›å»ºæ–‡ç« "></a><strong>åˆ›å»ºæ–‡ç« </strong></h2><p>è¿›å…¥åšå®¢ç›®å½•ï¼Œåœ¨ &#x2F;source&#x2F;_posts æ–‡ä»¶å¤¹ä¸‹ç›´æ¥å»ºç«‹ä¸€ä¸ª.mdæ–‡ä»¶</p><figure class="highlight">  <figcaption>This is a code block</figcaption>  <pre><code class="language-shell">  hexo new â€œè¿™é‡Œå¡«å…¥æ–‡ç« çš„æ ‡é¢˜â€  </code></pre></figure><p>.mdæ–‡ä»¶æ³¨æ„ä½¿ç”¨å¸¦æœ‰makedownè¯­æ³•çš„ç¼–è¾‘å™¨æ‰“å¼€ï¼Œå¯¹æ–‡ç« è¿›è¡Œç¼–è¾‘ï¼Œä½ å¯ä»¥åœ¨Hexo-&gt;Source-&gt;_postç›®å½•ä¸‹çœ‹åˆ°ä½ æ–°åˆ›å»ºçš„é‚£ä¸ªæ–‡ç« ï¼Œè¿˜æœ‰ä¸€ä¸ªé…å¥—çš„æ–‡ä»¶å¤¹ï¼Œé‡Œé¢æ”¾è¿™è¾¹åšæ–‡çš„å›¾ç‰‡èµ„æº</p><p>æ–‡ç« æ ‡é¢˜ï¼Œæ—¥æœŸï¼Œæ ‡ç­¾ï¼Œåˆ†ç±»</p><figure class="highlight">  <figcaption>This is a code block</figcaption>  <pre><code class="language-shell">  title: æ–‡ç« æ ‡é¢˜  date: 2015-11-13 15:40:25  tags: æ ‡ç­¾  categories: åˆ†ç±»  </code></pre></figure><p>æ–‡ç« æ’å…¥å›¾ç‰‡éœ€è¦ç”¨åˆ°ä¸€ä¸ªHexoçš„æ’ä»¶ï¼Œé¦–å…ˆcdåˆ°hexoçš„æ ¹ç›®å½•ä¸‹</p><figure class="highlight">  <figcaption>This is a code block</figcaption>  <pre><code class="language-shell">  npm install https://github.com/CodeFalling/hexo-asset-image â€“save  </code></pre></figure><p>ç„¶åæŠŠå›¾ç‰‡æ”¾å…¥å¯¹åº”æ–‡ç« çš„é…å¥—æ–‡ä»¶å¤¹ä¸‹</p><p>å¦‚æœè¦è¿›è¡Œä»£ç ä¹¦å†™ï¼Œä»£ç æ ·å¼å¯è‡ªè¡Œä¸‹è½½</p><h2 id="å‘å¸ƒæ–°å»ºæ–‡ç« "><a href="#å‘å¸ƒæ–°å»ºæ–‡ç« " class="headerlink" title="å‘å¸ƒæ–°å»ºæ–‡ç« "></a><strong>å‘å¸ƒæ–°å»ºæ–‡ç« </strong></h2><p>æ–‡ç« å†™å¥½åï¼Œç›´æ¥åœ¨git bashä¸­æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å³å¯ç›´æ¥å‘å¸ƒæ–‡ç« </p><figure class="highlight">  <figcaption>This is a code block</figcaption>  <pre><code class="language-shell">  hexo d -g  </code></pre></figure><p>å¦‚æœå‘å¸ƒçš„æ—¶å€™å‡ºç°é”™è¯¯</p><p><code>ERROR Deployer not found: git</code></p><p>æ‰§è¡Œ</p><figure class="highlight">  <figcaption>This is a code block</figcaption>  <pre><code class="language-shell">  npm install hexo-deployer-git â€“save  </code></pre></figure><h2 id="åˆ é™¤æ–‡ç« "><a href="#åˆ é™¤æ–‡ç« " class="headerlink" title="åˆ é™¤æ–‡ç« "></a><strong>åˆ é™¤æ–‡ç« </strong></h2><p>åˆ é™¤æ–‡ç« çš„è¿‡ç¨‹ä¸€æ ·ä¹Ÿå¾ˆç®€å•ï¼Œå…ˆåˆ é™¤æœ¬åœ°æ–‡ä»¶ï¼Œç„¶åé€šè¿‡ç”Ÿæˆå’Œéƒ¨ç½²å‘½ä»¤è¿›è€Œå°†è¿œç¨‹ä»“åº“ä¸­çš„æ–‡ä»¶ä¹Ÿä¸€å¹¶åˆ é™¤ã€‚å…·ä½“æ¥è¯´ï¼Œä»¥æœ€å¼€å§‹é»˜è®¤å½¢æˆçš„helloworld.mdè¿™ç¯‡æ–‡ç« ä¸ºä¾‹ã€‚</p><p>é¦–å…ˆè¿›å…¥åˆ°source &#x2F; _post æ–‡ä»¶å¤¹ä¸­ï¼Œæ‰¾åˆ°helloworld.mdæ–‡ä»¶ï¼Œåœ¨æœ¬åœ°ç›´æ¥æ‰§è¡Œåˆ é™¤ã€‚ç„¶åä¾æ¬¡æ‰§è¡Œ</p><figure class="highlight">  <figcaption>This is a code block</figcaption>  <pre><code class="language-shell">  hexo d -g  </code></pre></figure><p>å†å»ä¸»é¡µæŸ¥çœ‹ä½ å°±ä¼šå‘ç°ä½ çš„åšå®¢ä¸Šé¢å·²ç»ç©ºç©ºå¦‚ä¹Ÿäº†ï¼Œè¿™å°±æ˜¯å¦‚ä½•åˆ é™¤æ–‡ç« çš„æ–¹æ³•ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Hexo</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å‘½ä»¤</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CentosæŸ¥çœ‹CPUæ ¸æ•°å‘½ä»¤</title>
    <link href="/2023/04/20/Centos-CPU-Check-Info/"/>
    <url>/2023/04/20/Centos-CPU-Check-Info/</url>
    
    <content type="html"><![CDATA[<h1 id="æ€»æ ¸æ•°-x3D-ç‰©ç†CPUä¸ªæ•°-X-æ¯é¢—ç‰©ç†CPUçš„æ ¸æ•°"><a href="#æ€»æ ¸æ•°-x3D-ç‰©ç†CPUä¸ªæ•°-X-æ¯é¢—ç‰©ç†CPUçš„æ ¸æ•°" class="headerlink" title="æ€»æ ¸æ•° &#x3D; ç‰©ç†CPUä¸ªæ•° X æ¯é¢—ç‰©ç†CPUçš„æ ¸æ•°"></a>æ€»æ ¸æ•° &#x3D; ç‰©ç†CPUä¸ªæ•° X æ¯é¢—ç‰©ç†CPUçš„æ ¸æ•°</h1><h1 id="æ€»é€»è¾‘CPUæ•°-x3D-ç‰©ç†CPUä¸ªæ•°-X-æ¯é¢—ç‰©ç†CPUçš„æ ¸æ•°-X-è¶…çº¿ç¨‹æ•°"><a href="#æ€»é€»è¾‘CPUæ•°-x3D-ç‰©ç†CPUä¸ªæ•°-X-æ¯é¢—ç‰©ç†CPUçš„æ ¸æ•°-X-è¶…çº¿ç¨‹æ•°" class="headerlink" title="æ€»é€»è¾‘CPUæ•° &#x3D; ç‰©ç†CPUä¸ªæ•° X æ¯é¢—ç‰©ç†CPUçš„æ ¸æ•° X è¶…çº¿ç¨‹æ•°"></a>æ€»é€»è¾‘CPUæ•° &#x3D; ç‰©ç†CPUä¸ªæ•° X æ¯é¢—ç‰©ç†CPUçš„æ ¸æ•° X è¶…çº¿ç¨‹æ•°</h1><h1 id="æŸ¥çœ‹ç‰©ç†CPUä¸ªæ•°"><a href="#æŸ¥çœ‹ç‰©ç†CPUä¸ªæ•°" class="headerlink" title="æŸ¥çœ‹ç‰©ç†CPUä¸ªæ•°"></a>æŸ¥çœ‹ç‰©ç†CPUä¸ªæ•°</h1><figure class="highlight">  <figcaption>This is a code block</figcaption>  <pre><code class="language-shell">  cat /proc/cpuinfo| grep "physical id"| sort| uniq| wc -l  </code></pre></figure><h1 id="æŸ¥çœ‹æ¯ä¸ªç‰©ç†CPUä¸­coreçš„ä¸ªæ•°-å³æ ¸æ•°"><a href="#æŸ¥çœ‹æ¯ä¸ªç‰©ç†CPUä¸­coreçš„ä¸ªæ•°-å³æ ¸æ•°" class="headerlink" title="æŸ¥çœ‹æ¯ä¸ªç‰©ç†CPUä¸­coreçš„ä¸ªæ•°(å³æ ¸æ•°)"></a>æŸ¥çœ‹æ¯ä¸ªç‰©ç†CPUä¸­coreçš„ä¸ªæ•°(å³æ ¸æ•°)</h1><figure class="highlight">  <figcaption>This is a code block</figcaption>  <pre><code class="language-shell">  cat /proc/cpuinfo| grep "cpu cores"| uniq  </code></pre></figure><h1 id="æŸ¥çœ‹é€»è¾‘CPUçš„ä¸ªæ•°"><a href="#æŸ¥çœ‹é€»è¾‘CPUçš„ä¸ªæ•°" class="headerlink" title="æŸ¥çœ‹é€»è¾‘CPUçš„ä¸ªæ•°"></a>æŸ¥çœ‹é€»è¾‘CPUçš„ä¸ªæ•°</h1><figure class="highlight">  <figcaption>This is a code block</figcaption>  <pre><code class="language-shell">  cat /proc/cpuinfo| grep "processor"| wc -l  </code></pre></figure>]]></content>
    
    
    <categories>
      
      <category>SYSTEM</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CENTOS</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
